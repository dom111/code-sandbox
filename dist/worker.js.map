{
  "version": 3,
  "sources": ["../js/worker.js"],
  "sourcesContent": ["importScripts('./lib/webperl.js');\n\n// Perl.noMountIdbfs = true;\n\naddEventListener('message', ({ data }) => {\n  // TODO: check 'type' param too...\n  const { code, args, input } = data;\n\n  Perl.output = (content, channel) => {\n    if (channel === 2) {\n      postMessage({\n        type: 'output',\n        error: content,\n      });\n\n      return;\n    }\n\n    postMessage({\n      type: 'output',\n      output: content,\n    });\n  };\n\n  Perl.init(() => {\n    let prefix = '',\n      suffix = '';\n\n    // TODO: look into why this isn't working for everything (-anpF).\n    // Perl.start(args.split(/\\s+/));\n    Perl.start([]);\n\n    Perl.stdin_buf += input;\n\n    // Force flushing output with `$|` - doesn't look like this is needed?\n    // const result = Perl.eval('$|++;\\n' + code);\n\n    const match = args.match(/F(\\S+)?/);\n\n    if (match) {\n      prefix =\n        `@F = split/\\\\Q${match[1] ?? ''.replace(/^\\/|\\/$/g, '')}/,$_;\\n` +\n        prefix;\n    } else if (args.match(/a/)) {\n      prefix = `@F = grep$_,split/\\\\s+/,$_;\\n` + prefix;\n    }\n\n    if (args.match(/p/)) {\n      suffix += ';\\nprint;\\n' + suffix;\n    }\n\n    if (args.match(/l/)) {\n      prefix = '$\\\\=$/;\\nchomp;\\n' + prefix;\n    }\n\n    if (args.match(/[anpF]/)) {\n      prefix = 'while(<STDIN>) {\\n' + prefix;\n      suffix += ';\\n}\\n';\n    }\n\n    const result = Perl.eval([\n      ...[...prefix].map((c) => c.charCodeAt()),\n      ...code,\n      ...[...suffix].map((c) => c.charCodeAt()),\n    ]);\n\n    Perl.end();\n\n    postMessage({\n      type: 'done',\n      result,\n      output: Perl.stdout_buf,\n    });\n  });\n});\n"],
  "mappings": "MAAA,cAAc,oBAId,iBAAiB,UAAW,CAAC,CAAE,UAAW,CAExC,GAAM,CAAE,OAAM,OAAM,SAAU,EAE9B,KAAK,OAAS,CAAC,EAAS,IAAY,CAClC,GAAI,IAAY,EAAG,CACjB,YAAY,CACV,KAAM,SACN,MAAO,IAGT,OAGF,YAAY,CACV,KAAM,SACN,OAAQ,KAIZ,KAAK,KAAK,IAAM,CACd,GAAI,GAAS,GACX,EAAS,GAIX,KAAK,MAAM,IAEX,KAAK,WAAa,EAKlB,GAAM,GAAQ,EAAK,MAAM,WAEzB,AAAI,EACF,EACE,iBAAiB,EAAM,IAAM,GAAG,QAAQ,WAAY;AAAA,EACpD,EACO,EAAK,MAAM,MACpB,GAAS;AAAA,EAAkC,GAGzC,EAAK,MAAM,MACb,IAAU;AAAA;AAAA,EAAgB,GAGxB,EAAK,MAAM,MACb,GAAS;AAAA;AAAA,EAAsB,GAG7B,EAAK,MAAM,WACb,GAAS;AAAA,EAAuB,EAChC,GAAU;AAAA;AAAA,GAGZ,GAAM,GAAS,KAAK,KAAK,CACvB,GAAG,CAAC,GAAG,GAAQ,IAAI,AAAC,GAAM,EAAE,cAC5B,GAAG,EACH,GAAG,CAAC,GAAG,GAAQ,IAAI,AAAC,GAAM,EAAE,gBAG9B,KAAK,MAEL,YAAY,CACV,KAAM,OACN,SACA,OAAQ,KAAK",
  "names": []
}
