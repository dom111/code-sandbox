(()=>{var Zc=Object.create;var Ko=Object.defineProperty;var Vc=Object.getOwnPropertyDescriptor;var Jc=Object.getOwnPropertyNames;var $c=Object.getPrototypeOf,Qc=Object.prototype.hasOwnProperty;var eu=oe=>Ko(oe,"__esModule",{value:!0});var ki=(oe,V)=>()=>(V||oe((V={exports:{}}).exports,V),V.exports);var tu=(oe,V,Q,ve)=>{if(V&&typeof V=="object"||typeof V=="function")for(let $ of Jc(V))!Qc.call(oe,$)&&(Q||$!=="default")&&Ko(oe,$,{get:()=>V[$],enumerable:!(ve=Vc(V,$))||ve.enumerable});return oe},Ei=(oe,V)=>tu(eu(Ko(oe!=null?Zc($c(oe)):{},"default",!V&&oe&&oe.__esModule?{get:()=>oe.default,enumerable:!0}:{value:oe,enumerable:!0})),oe);var Ai=ki((Go,Xo)=>{(function(oe,V){typeof Go=="object"&&typeof Xo!="undefined"?Xo.exports=V():typeof define=="function"&&define.amd?define(V):(oe=oe||self,oe.CodeMirror=V())})(Go,function(){"use strict";var oe=navigator.userAgent,V=navigator.platform,Q=/gecko\/\d/i.test(oe),ve=/MSIE \d/.test(oe),$=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(oe),h=/Edge\/(\d+)/.exec(oe),k=ve||$||h,v=k&&(ve?document.documentMode||6:+(h||$)[1]),y=!h&&/WebKit\//.test(oe),w=y&&/Qt\/\d+\.\d+/.test(oe),m=!h&&/Chrome\//.test(oe),b=/Opera\//.test(oe),S=/Apple Computer/.test(navigator.vendor),u=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(oe),f=/PhantomJS/.test(oe),p=S&&(/Mobile\/\w+/.test(oe)||navigator.maxTouchPoints>2),a=/Android/.test(oe),s=p||a||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(oe),o=p||/Mac/.test(V),c=/\bCrOS\b/.test(oe),d=/win/i.test(V),g=b&&oe.match(/Version\/(\d*\.\d*)/);g&&(g=Number(g[1])),g&&g>=15&&(b=!1,y=!0);var x=o&&(w||b&&(g==null||g<12.11)),T=Q||k&&v>=9;function H(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var P=function(e,t){var i=e.className,r=H(t).exec(i);if(r){var n=i.slice(r.index+r[0].length);e.className=i.slice(0,r.index)+(n?r[1]+n:"")}};function M(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function L(e,t){return M(e).appendChild(t)}function D(e,t,i,r){var n=document.createElement(e);if(i&&(n.className=i),r&&(n.style.cssText=r),typeof t=="string")n.appendChild(document.createTextNode(t));else if(t)for(var l=0;l<t.length;++l)n.appendChild(t[l]);return n}function E(e,t,i,r){var n=D(e,t,i,r);return n.setAttribute("role","presentation"),n}var Y;document.createRange?Y=function(e,t,i,r){var n=document.createRange();return n.setEnd(r||e,i),n.setStart(e,t),n}:Y=function(e,t,i){var r=document.body.createTextRange();try{r.moveToElementText(e.parentNode)}catch{return r}return r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r};function j(e,t){if(t.nodeType==3&&(t=t.parentNode),e.contains)return e.contains(t);do if(t.nodeType==11&&(t=t.host),t==e)return!0;while(t=t.parentNode)}function I(){var e;try{e=document.activeElement}catch{e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}function F(e,t){var i=e.className;H(t).test(i)||(e.className+=(i?" ":"")+t)}function K(e,t){for(var i=e.split(" "),r=0;r<i.length;r++)i[r]&&!H(i[r]).test(t)&&(t+=" "+i[r]);return t}var Z=function(e){e.select()};p?Z=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:k&&(Z=function(e){try{e.select()}catch{}});function ue(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function ae(e,t,i){t||(t={});for(var r in e)e.hasOwnProperty(r)&&(i!==!1||!t.hasOwnProperty(r))&&(t[r]=e[r]);return t}function Ce(e,t,i,r,n){t==null&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var l=r||0,_=n||0;;){var C=e.indexOf("	",l);if(C<0||C>=t)return _+(t-l);_+=C-l,_+=i-_%i,l=C+1}}var we=function(){this.id=null,this.f=null,this.time=0,this.handler=ue(this.onTimeout,this)};we.prototype.onTimeout=function(e){e.id=0,e.time<=+new Date?e.f():setTimeout(e.handler,e.time-+new Date)},we.prototype.set=function(e,t){this.f=t;var i=+new Date+e;(!this.id||i<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,e),this.time=i)};function fe(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}var B=50,N={toString:function(){return"CodeMirror.Pass"}},U={scroll:!1},se={origin:"*mouse"},G={origin:"+move"};function _e(e,t,i){for(var r=0,n=0;;){var l=e.indexOf("	",r);l==-1&&(l=e.length);var _=l-r;if(l==e.length||n+_>=t)return r+Math.min(_,t-n);if(n+=l-r,n+=i-n%i,r=l+1,n>=t)return r}}var Le=[""];function Be(e){for(;Le.length<=e;)Le.push(Ee(Le)+" ");return Le[e]}function Ee(e){return e[e.length-1]}function Ie(e,t){for(var i=[],r=0;r<e.length;r++)i[r]=t(e[r],r);return i}function be(e,t,i){for(var r=0,n=i(t);r<e.length&&i(e[r])<=n;)r++;e.splice(r,0,t)}function qe(){}function _t(e,t){var i;return Object.create?i=Object.create(e):(qe.prototype=e,i=new qe),t&&ae(t,i),i}var Mt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Yt(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Mt.test(e))}function _r(e,t){return t?t.source.indexOf("\\w")>-1&&Yt(e)?!0:t.test(e):Yt(e)}function Zr(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var li=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function Dr(e){return e.charCodeAt(0)>=768&&li.test(e)}function Vr(e,t,i){for(;(i<0?t>0:t<e.length)&&Dr(e.charAt(t));)t+=i;return t}function Ut(e,t,i){for(var r=t>i?-1:1;;){if(t==i)return t;var n=(t+i)/2,l=r<0?Math.ceil(n):Math.floor(n);if(l==t)return e(l)?t:i;e(l)?i=l:t=l+r}}function ci(e,t,i,r){if(!e)return r(t,i,"ltr",0);for(var n=!1,l=0;l<e.length;++l){var _=e[l];(_.from<i&&_.to>t||t==i&&_.to==t)&&(r(Math.max(_.from,t),Math.min(_.to,i),_.level==1?"rtl":"ltr",l),n=!0)}n||r(t,i,"ltr")}var gt=null;function Ne(e,t,i){var r;gt=null;for(var n=0;n<e.length;++n){var l=e[n];if(l.from<t&&l.to>t)return n;l.to==t&&(l.from!=l.to&&i=="before"?r=n:gt=n),l.from==t&&(l.from!=l.to&&i!="before"?r=n:gt=n)}return r??gt}var sr=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function i(R){return R<=247?e.charAt(R):1424<=R&&R<=1524?"R":1536<=R&&R<=1785?t.charAt(R-1536):1774<=R&&R<=2220?"r":8192<=R&&R<=8203?"w":R==8204?"b":"L"}var r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,n=/[stwN]/,l=/[LRr]/,_=/[Lb1n]/,C=/[1n]/;function A(R,W,z){this.level=R,this.from=W,this.to=z}return function(R,W){var z=W=="ltr"?"L":"R";if(R.length==0||W=="ltr"&&!r.test(R))return!1;for(var J=R.length,X=[],ee=0;ee<J;++ee)X.push(i(R.charCodeAt(ee)));for(var ne=0,he=z;ne<J;++ne){var de=X[ne];de=="m"?X[ne]=he:he=de}for(var ye=0,pe=z;ye<J;++ye){var me=X[ye];me=="1"&&pe=="r"?X[ye]="n":l.test(me)&&(pe=me,me=="r"&&(X[ye]="R"))}for(var Ae=1,xe=X[0];Ae<J-1;++Ae){var Re=X[Ae];Re=="+"&&xe=="1"&&X[Ae+1]=="1"?X[Ae]="1":Re==","&&xe==X[Ae+1]&&(xe=="1"||xe=="n")&&(X[Ae]=xe),xe=Re}for(var We=0;We<J;++We){var lt=X[We];if(lt==",")X[We]="N";else if(lt=="%"){var ze=void 0;for(ze=We+1;ze<J&&X[ze]=="%";++ze);for(var Xt=We&&X[We-1]=="!"||ze<J&&X[ze]=="1"?"1":"N",Wt=We;Wt<ze;++Wt)X[Wt]=Xt;We=ze-1}}for(var $e=0,Nt=z;$e<J;++$e){var pt=X[$e];Nt=="L"&&pt=="1"?X[$e]="L":l.test(pt)&&(Nt=pt)}for(var it=0;it<J;++it)if(n.test(X[it])){var Qe=void 0;for(Qe=it+1;Qe<J&&n.test(X[Qe]);++Qe);for(var Xe=(it?X[it-1]:z)=="L",jt=(Qe<J?X[Qe]:z)=="L",Qi=Xe==jt?Xe?"L":"R":z,si=it;si<Qe;++si)X[si]=Qi;it=Qe-1}for(var xt=[],Mr,ct=0;ct<J;)if(_.test(X[ct])){var qo=ct;for(++ct;ct<J&&_.test(X[ct]);++ct);xt.push(new A(0,qo,ct))}else{var Yr=ct,Li=xt.length,xi=W=="rtl"?1:0;for(++ct;ct<J&&X[ct]!="L";++ct);for(var Tt=Yr;Tt<ct;)if(C.test(X[Tt])){Yr<Tt&&(xt.splice(Li,0,new A(1,Yr,Tt)),Li+=xi);var en=Tt;for(++Tt;Tt<ct&&C.test(X[Tt]);++Tt);xt.splice(Li,0,new A(2,en,Tt)),Li+=xi,Yr=Tt}else++Tt;Yr<ct&&xt.splice(Li,0,new A(1,Yr,ct))}return W=="ltr"&&(xt[0].level==1&&(Mr=R.match(/^\s+/))&&(xt[0].from=Mr[0].length,xt.unshift(new A(0,0,Mr[0].length))),Ee(xt).level==1&&(Mr=R.match(/\s+$/))&&(Ee(xt).to-=Mr[0].length,xt.push(new A(0,J-Mr[0].length,J)))),W=="rtl"?xt.reverse():xt}}();function ut(e,t){var i=e.order;return i==null&&(i=e.order=sr(e.text,t)),i}var Zt=[],ke=function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else{var r=e._handlers||(e._handlers={});r[t]=(r[t]||Zt).concat(i)}};function ar(e,t){return e._handlers&&e._handlers[t]||Zt}function et(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i,!1);else if(e.detachEvent)e.detachEvent("on"+t,i);else{var r=e._handlers,n=r&&r[t];if(n){var l=fe(n,i);l>-1&&(r[t]=n.slice(0,l).concat(n.slice(l+1)))}}}function Te(e,t){var i=ar(e,t);if(!!i.length)for(var r=Array.prototype.slice.call(arguments,2),n=0;n<i.length;++n)i[n].apply(null,r)}function je(e,t,i){return typeof t=="string"&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Te(e,i||t.type,e,t),ft(t)||t.codemirrorIgnore}function lr(e){var t=e._handlers&&e._handlers.cursorActivity;if(!!t)for(var i=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),r=0;r<t.length;++r)fe(i,t[r])==-1&&i.push(t[r])}function Ke(e,t){return ar(e,t).length>0}function Rt(e){e.prototype.on=function(t,i){ke(this,t,i)},e.prototype.off=function(t,i){et(this,t,i)}}function Ye(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function cr(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function ft(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==!1}function tr(e){Ye(e),cr(e)}function Vt(e){return e.target||e.srcElement}function Br(e){var t=e.which;return t==null&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),o&&e.ctrlKey&&t==1&&(t=3),t}var gr=function(){if(k&&v<9)return!1;var e=D("div");return"draggable"in e||"dragDrop"in e}(),tt;function Pr(e){if(tt==null){var t=D("span","\u200B");L(e,D("span",[t,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(tt=t.offsetWidth<=1&&t.offsetHeight>2&&!(k&&v<8))}var i=tt?D("span","\u200B"):D("span","\xA0",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}var yr;function Ot(e){if(yr!=null)return yr;var t=L(e,document.createTextNode("A\u062EA")),i=Y(t,0,1).getBoundingClientRect(),r=Y(t,1,2).getBoundingClientRect();return M(e),!i||i.left==i.right?!1:yr=r.right-i.right<3}var mr=`

b`.split(/\n/).length!=3?function(e){for(var t=0,i=[],r=e.length;t<=r;){var n=e.indexOf(`
`,t);n==-1&&(n=e.length);var l=e.slice(t,e.charAt(n-1)=="\r"?n-1:n),_=l.indexOf("\r");_!=-1?(i.push(l.slice(0,_)),t+=_+1):(i.push(l),t=n+1)}return i}:function(e){return e.split(/\r\n?|\n/)},Hr=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch{return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch{}return!t||t.parentElement()!=e?!1:t.compareEndPoints("StartToEnd",t)!=0},Ir=function(){var e=D("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),br=null;function Jt(e){if(br!=null)return br;var t=L(e,D("span","x")),i=t.getBoundingClientRect(),r=Y(t,0,1).getBoundingClientRect();return br=Math.abs(i.left-r.left)>1}var yt={},ht={};function Fr(e,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),yt[e]=t}function qt(e,t){ht[e]=t}function ur(e){if(typeof e=="string"&&ht.hasOwnProperty(e))e=ht[e];else if(e&&typeof e.name=="string"&&ht.hasOwnProperty(e.name)){var t=ht[e.name];typeof t=="string"&&(t={name:t}),e=_t(t,e),e.name=t.name}else{if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return ur("application/xml");if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return ur("application/json")}return typeof e=="string"?{name:e}:e||{name:"null"}}function fr(e,t){t=ur(t);var i=yt[t.name];if(!i)return fr(e,"text/plain");var r=i(e,t);if(kt.hasOwnProperty(t.name)){var n=kt[t.name];for(var l in n)!n.hasOwnProperty(l)||(r.hasOwnProperty(l)&&(r["_"+l]=r[l]),r[l]=n[l])}if(r.name=t.name,t.helperType&&(r.helperType=t.helperType),t.modeProps)for(var _ in t.modeProps)r[_]=t.modeProps[_];return r}var kt={};function Et(e,t){var i=kt.hasOwnProperty(e)?kt[e]:kt[e]={};ae(t,i)}function dt(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var i={};for(var r in t){var n=t[r];n instanceof Array&&(n=n.concat([])),i[r]=n}return i}function Sr(e,t){for(var i;e.innerMode&&(i=e.innerMode(t),!(!i||i.mode==e));)t=i.state,e=i.mode;return i||{mode:e,state:t}}function Cr(e,t,i){return e.startState?e.startState(t,i):!0}var Fe=function(e,t,i){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i};Fe.prototype.eol=function(){return this.pos>=this.string.length},Fe.prototype.sol=function(){return this.pos==this.lineStart},Fe.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Fe.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Fe.prototype.eat=function(e){var t=this.string.charAt(this.pos),i;if(typeof e=="string"?i=t==e:i=t&&(e.test?e.test(t):e(t)),i)return++this.pos,t},Fe.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},Fe.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},Fe.prototype.skipToEnd=function(){this.pos=this.string.length},Fe.prototype.skipTo=function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},Fe.prototype.backUp=function(e){this.pos-=e},Fe.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ce(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ce(this.string,this.lineStart,this.tabSize):0)},Fe.prototype.indentation=function(){return Ce(this.string,null,this.tabSize)-(this.lineStart?Ce(this.string,this.lineStart,this.tabSize):0)},Fe.prototype.match=function(e,t,i){if(typeof e=="string"){var r=function(_){return i?_.toLowerCase():_},n=this.string.substr(this.pos,e.length);if(r(n)==r(e))return t!==!1&&(this.pos+=e.length),!0}else{var l=this.string.slice(this.pos).match(e);return l&&l.index>0?null:(l&&t!==!1&&(this.pos+=l[0].length),l)}},Fe.prototype.current=function(){return this.string.slice(this.start,this.pos)},Fe.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},Fe.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},Fe.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};function Se(e,t){if(t-=e.first,t<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var i=e;!i.lines;)for(var r=0;;++r){var n=i.children[r],l=n.chunkSize();if(t<l){i=n;break}t-=l}return i.lines[t]}function Dt(e,t,i){var r=[],n=t.line;return e.iter(t.line,i.line+1,function(l){var _=l.text;n==i.line&&(_=_.slice(0,i.ch)),n==t.line&&(_=_.slice(t.ch)),r.push(_),++n}),r}function wr(e,t,i){var r=[];return e.iter(t,i,function(n){r.push(n.text)}),r}function nt(e,t){var i=t-e.height;if(i)for(var r=e;r;r=r.parent)r.height+=i}function De(e){if(e.parent==null)return null;for(var t=e.parent,i=fe(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var n=0;r.children[n]!=t;++n)i+=r.children[n].chunkSize();return i+t.first}function Bt(e,t){var i=e.first;e:do{for(var r=0;r<e.children.length;++r){var n=e.children[r],l=n.height;if(t<l){e=n;continue e}t-=l,i+=n.chunkSize()}return i}while(!e.lines);for(var _=0;_<e.lines.length;++_){var C=e.lines[_],A=C.height;if(t<A)break;t-=A}return i+_}function rr(e,t){return t>=e.first&&t<e.first+e.size}function Lr(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function le(e,t,i){if(i===void 0&&(i=null),!(this instanceof le))return new le(e,t,i);this.line=e,this.ch=t,this.sticky=i}function O(e,t){return e.line-t.line||e.ch-t.ch}function q(e,t){return e.sticky==t.sticky&&O(e,t)==0}function ie(e){return le(e.line,e.ch)}function ce(e,t){return O(e,t)<0?t:e}function Me(e,t){return O(e,t)<0?e:t}function Oe(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function ge(e,t){if(t.line<e.first)return le(e.first,0);var i=e.first+e.size-1;return t.line>i?le(i,Se(e,i).text.length):Je(t,Se(e,t.line).text.length)}function Je(e,t){var i=e.ch;return i==null||i>t?le(e.line,t):i<0?le(e.line,0):e}function mt(e,t){for(var i=[],r=0;r<t.length;r++)i[r]=ge(e,t[r]);return i}var xr=function(e,t){this.state=e,this.lookAhead=t},zt=function(e,t,i,r){this.state=t,this.doc=e,this.line=i,this.maxLookAhead=r||0,this.baseTokens=null,this.baseTokenPos=1};zt.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return t!=null&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},zt.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},zt.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},zt.fromSaved=function(e,t,i){return t instanceof xr?new zt(e,dt(e.mode,t.state),i,t.lookAhead):new zt(e,dt(e.mode,t),i)},zt.prototype.save=function(e){var t=e!==!1?dt(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new xr(t,this.maxLookAhead):t};function Ti(e,t,i,r){var n=[e.state.modeGen],l={};Pi(e,t.text,e.doc.mode,i,function(R,W){return n.push(R,W)},l,r);for(var _=i.state,C=function(R){i.baseTokens=n;var W=e.state.overlays[R],z=1,J=0;i.state=!0,Pi(e,t.text,W.mode,i,function(X,ee){for(var ne=z;J<X;){var he=n[z];he>X&&n.splice(z,1,X,n[z+1],he),z+=2,J=Math.min(X,he)}if(!!ee)if(W.opaque)n.splice(ne,z-ne,X,"overlay "+ee),z=ne+2;else for(;ne<z;ne+=2){var de=n[ne+1];n[ne+1]=(de?de+" ":"")+"overlay "+ee}},l),i.state=_,i.baseTokens=null,i.baseTokenPos=1},A=0;A<e.state.overlays.length;++A)C(A);return{styles:n,classes:l.bgClass||l.textClass?l:null}}function Mi(e,t,i){if(!t.styles||t.styles[0]!=e.state.modeGen){var r=Wr(e,De(t)),n=t.text.length>e.options.maxHighlightLength&&dt(e.doc.mode,r.state),l=Ti(e,t,r);n&&(r.state=n),t.stateAfter=r.save(!n),t.styles=l.styles,l.classes?t.styleClasses=l.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return t.styles}function Wr(e,t,i){var r=e.doc,n=e.display;if(!r.mode.startState)return new zt(r,!0,t);var l=tn(e,t,i),_=l>r.first&&Se(r,l-1).stateAfter,C=_?zt.fromSaved(r,_,l):new zt(r,Cr(r.mode),l);return r.iter(l,t,function(A){ui(e,A.text,C);var R=C.line;A.stateAfter=R==t-1||R%5==0||R>=n.viewFrom&&R<n.viewTo?C.save():null,C.nextLine()}),i&&(r.modeFrontier=C.line),C}function ui(e,t,i,r){var n=e.doc.mode,l=new Fe(t,e.options.tabSize,i);for(l.start=l.pos=r||0,t==""&&Ri(n,i.state);!l.eol();)fi(n,l,i.state),l.start=l.pos}function Ri(e,t){if(e.blankLine)return e.blankLine(t);if(!!e.innerMode){var i=Sr(e,t);if(i.mode.blankLine)return i.mode.blankLine(i.state)}}function fi(e,t,i,r){for(var n=0;n<10;n++){r&&(r[0]=Sr(e,i).mode);var l=e.token(t,i);if(t.pos>t.start)return l}throw new Error("Mode "+e.name+" failed to advance stream.")}var Oi=function(e,t,i){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=i};function Di(e,t,i,r){var n=e.doc,l=n.mode,_;t=ge(n,t);var C=Se(n,t.line),A=Wr(e,t.line,i),R=new Fe(C.text,e.options.tabSize,A),W;for(r&&(W=[]);(r||R.pos<t.ch)&&!R.eol();)R.start=R.pos,_=fi(l,R,A.state),r&&W.push(new Oi(R,_,dt(n.mode,A.state)));return r?W:new Oi(R,_,A.state)}function Bi(e,t){if(e)for(;;){var i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);var r=i[1]?"bgClass":"textClass";t[r]==null?t[r]=i[2]:new RegExp("(?:^|\\s)"+i[2]+"(?:$|\\s)").test(t[r])||(t[r]+=" "+i[2])}return e}function Pi(e,t,i,r,n,l,_){var C=i.flattenSpans;C==null&&(C=e.options.flattenSpans);var A=0,R=null,W=new Fe(t,e.options.tabSize,r),z,J=e.options.addModeClass&&[null];for(t==""&&Bi(Ri(i,r.state),l);!W.eol();){if(W.pos>e.options.maxHighlightLength?(C=!1,_&&ui(e,t,r,W.pos),W.pos=t.length,z=null):z=Bi(fi(i,W,r.state,J),l),J){var X=J[0].name;X&&(z="m-"+(z?X+" "+z:X))}if(!C||R!=z){for(;A<W.start;)A=Math.min(W.start,A+5e3),n(A,R);R=z}W.start=W.pos}for(;A<W.pos;){var ee=Math.min(W.pos,A+5e3);n(ee,R),A=ee}}function tn(e,t,i){for(var r,n,l=e.doc,_=i?-1:t-(e.doc.mode.innerMode?1e3:100),C=t;C>_;--C){if(C<=l.first)return l.first;var A=Se(l,C-1),R=A.stateAfter;if(R&&(!i||C+(R instanceof xr?R.lookAhead:0)<=l.modeFrontier))return C;var W=Ce(A.text,null,e.options.tabSize);(n==null||r>W)&&(n=C-1,r=W)}return n}function Tn(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var i=e.first,r=t-1;r>i;r--){var n=Se(e,r).stateAfter;if(n&&(!(n instanceof xr)||r+n.lookAhead<t)){i=r+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,i)}}var Mn=!1,ir=!1;function Rn(){Mn=!0}function io(){ir=!0}function Hi(e,t,i){this.marker=e,this.from=t,this.to=i}function re(e,t){if(e)for(var i=0;i<e.length;++i){var r=e[i];if(r.marker==t)return r}}function te(e,t){for(var i,r=0;r<e.length;++r)e[r]!=t&&(i||(i=[])).push(e[r]);return i}function nr(e,t,i){var r=i&&window.WeakSet&&(i.markedSpans||(i.markedSpans=new WeakSet));r&&r.has(e.markedSpans)?e.markedSpans.push(t):(e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],r&&r.add(e.markedSpans)),t.marker.attachLine(e)}function hi(e,t,i){var r;if(e)for(var n=0;n<e.length;++n){var l=e[n],_=l.marker,C=l.from==null||(_.inclusiveLeft?l.from<=t:l.from<t);if(C||l.from==t&&_.type=="bookmark"&&(!i||!l.marker.insertLeft)){var A=l.to==null||(_.inclusiveRight?l.to>=t:l.to>t);(r||(r=[])).push(new Hi(_,l.from,A?null:l.to))}}return r}function di(e,t,i){var r;if(e)for(var n=0;n<e.length;++n){var l=e[n],_=l.marker,C=l.to==null||(_.inclusiveRight?l.to>=t:l.to>t);if(C||l.from==t&&_.type=="bookmark"&&(!i||l.marker.insertLeft)){var A=l.from==null||(_.inclusiveLeft?l.from<=t:l.from<t);(r||(r=[])).push(new Hi(_,A?null:l.from-t,l.to==null?null:l.to-t))}}return r}function Ze(e,t){if(t.full)return null;var i=rr(e,t.from.line)&&Se(e,t.from.line).markedSpans,r=rr(e,t.to.line)&&Se(e,t.to.line).markedSpans;if(!i&&!r)return null;var n=t.from.ch,l=t.to.ch,_=O(t.from,t.to)==0,C=hi(i,n,_),A=di(r,l,_),R=t.text.length==1,W=Ee(t.text).length+(R?n:0);if(C)for(var z=0;z<C.length;++z){var J=C[z];if(J.to==null){var X=re(A,J.marker);X?R&&(J.to=X.to==null?null:X.to+W):J.to=n}}if(A)for(var ee=0;ee<A.length;++ee){var ne=A[ee];if(ne.to!=null&&(ne.to+=W),ne.from==null){var he=re(C,ne.marker);he||(ne.from=W,R&&(C||(C=[])).push(ne))}else ne.from+=W,R&&(C||(C=[])).push(ne)}C&&(C=$t(C)),A&&A!=C&&(A=$t(A));var de=[C];if(!R){var ye=t.text.length-2,pe;if(ye>0&&C)for(var me=0;me<C.length;++me)C[me].to==null&&(pe||(pe=[])).push(new Hi(C[me].marker,null,null));for(var Ae=0;Ae<ye;++Ae)de.push(pe);de.push(A)}return de}function $t(e){for(var t=0;t<e.length;++t){var i=e[t];i.from!=null&&i.from==i.to&&i.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function or(e,t,i){var r=null;if(e.iter(t.line,i.line+1,function(X){if(X.markedSpans)for(var ee=0;ee<X.markedSpans.length;++ee){var ne=X.markedSpans[ee].marker;ne.readOnly&&(!r||fe(r,ne)==-1)&&(r||(r=[])).push(ne)}}),!r)return null;for(var n=[{from:t,to:i}],l=0;l<r.length;++l)for(var _=r[l],C=_.find(0),A=0;A<n.length;++A){var R=n[A];if(!(O(R.to,C.from)<0||O(R.from,C.to)>0)){var W=[A,1],z=O(R.from,C.from),J=O(R.to,C.to);(z<0||!_.inclusiveLeft&&!z)&&W.push({from:R.from,to:C.from}),(J>0||!_.inclusiveRight&&!J)&&W.push({from:C.to,to:R.to}),n.splice.apply(n,W),A+=W.length-3}}return n}function Jr(e){var t=e.markedSpans;if(!!t){for(var i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null}}function bt(e,t){if(!!t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function Pt(e){return e.inclusiveLeft?-1:0}function kr(e){return e.inclusiveRight?1:0}function Nr(e,t){var i=e.lines.length-t.lines.length;if(i!=0)return i;var r=e.find(),n=t.find(),l=O(r.from,n.from)||Pt(e)-Pt(t);if(l)return-l;var _=O(r.to,n.to)||kr(e)-kr(t);return _||t.id-e.id}function jr(e,t){var i=ir&&e.markedSpans,r;if(i)for(var n=void 0,l=0;l<i.length;++l)n=i[l],n.marker.collapsed&&(t?n.from:n.to)==null&&(!r||Nr(r,n.marker)<0)&&(r=n.marker);return r}function Ur(e){return jr(e,!0)}function St(e){return jr(e,!1)}function Ht(e,t){var i=ir&&e.markedSpans,r;if(i)for(var n=0;n<i.length;++n){var l=i[n];l.marker.collapsed&&(l.from==null||l.from<t)&&(l.to==null||l.to>t)&&(!r||Nr(r,l.marker)<0)&&(r=l.marker)}return r}function Ge(e,t,i,r,n){var l=Se(e,t),_=ir&&l.markedSpans;if(_)for(var C=0;C<_.length;++C){var A=_[C];if(!!A.marker.collapsed){var R=A.marker.find(0),W=O(R.from,i)||Pt(A.marker)-Pt(n),z=O(R.to,r)||kr(A.marker)-kr(n);if(!(W>=0&&z<=0||W<=0&&z>=0)&&(W<=0&&(A.marker.inclusiveRight&&n.inclusiveLeft?O(R.to,i)>=0:O(R.to,i)>0)||W>=0&&(A.marker.inclusiveRight&&n.inclusiveLeft?O(R.from,r)<=0:O(R.from,r)<0)))return!0}}}function rt(e){for(var t;t=Ur(e);)e=t.find(-1,!0).line;return e}function Qt(e){for(var t;t=St(e);)e=t.find(1,!0).line;return e}function qr(e){for(var t,i;t=St(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i}function hr(e,t){var i=Se(e,t),r=rt(i);return i==r?t:De(r)}function pi(e,t){if(t>e.lastLine())return t;var i=Se(e,t),r;if(!Ct(e,i))return t;for(;r=St(i);)i=r.find(1,!0).line;return De(i)+1}function Ct(e,t){var i=ir&&t.markedSpans;if(i){for(var r=void 0,n=0;n<i.length;++n)if(r=i[n],!!r.marker.collapsed){if(r.from==null)return!0;if(!r.marker.widgetNode&&r.from==0&&r.marker.inclusiveLeft&&Er(e,t,r))return!0}}}function Er(e,t,i){if(i.to==null){var r=i.marker.find(1,!0);return Er(e,r.line,re(r.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(var n=void 0,l=0;l<t.markedSpans.length;++l)if(n=t.markedSpans[l],n.marker.collapsed&&!n.marker.widgetNode&&n.from==i.to&&(n.to==null||n.to!=i.from)&&(n.marker.inclusiveLeft||i.marker.inclusiveRight)&&Er(e,t,n))return!0}function wt(e){e=rt(e);for(var t=0,i=e.parent,r=0;r<i.lines.length;++r){var n=i.lines[r];if(n==e)break;t+=n.height}for(var l=i.parent;l;i=l,l=i.parent)for(var _=0;_<l.children.length;++_){var C=l.children[_];if(C==i)break;t+=C.height}return t}function $r(e){if(e.height==0)return 0;for(var t=e.text.length,i,r=e;i=Ur(r);){var n=i.find(0,!0);r=n.from.line,t+=n.from.ch-n.to.ch}for(r=e;i=St(r);){var l=i.find(0,!0);t-=r.text.length-l.from.ch,r=l.to.line,t+=r.text.length-l.to.ch}return t}function vi(e){var t=e.display,i=e.doc;t.maxLine=Se(i,i.first),t.maxLineLength=$r(t.maxLine),t.maxLineChanged=!0,i.iter(function(r){var n=$r(r);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=r)})}var Kt=function(e,t,i){this.text=e,bt(this,t),this.height=i?i(this):1};Kt.prototype.lineNo=function(){return De(this)},Rt(Kt);function zr(e,t,i,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),Jr(e),bt(e,i);var n=r?r(e):1;n!=e.height&&nt(e,n)}function no(e){e.parent=null,Jr(e)}var fl={},hl={};function Jo(e,t){if(!e||/^\s*$/.test(e))return null;var i=t.addModeClass?hl:fl;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function $o(e,t){var i=E("span",null,null,y?"padding-right: .1px":null),r={pre:E("pre",[i],"CodeMirror-line"),content:i,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var n=0;n<=(t.rest?t.rest.length:0);n++){var l=n?t.rest[n-1]:t.line,_=void 0;r.pos=0,r.addToken=pl,Ot(e.display.measure)&&(_=ut(l,e.doc.direction))&&(r.addToken=_l(r.addToken,_)),r.map=[];var C=t!=e.display.externalMeasured&&De(l);gl(l,r,Mi(e,l,C)),l.styleClasses&&(l.styleClasses.bgClass&&(r.bgClass=K(l.styleClasses.bgClass,r.bgClass||"")),l.styleClasses.textClass&&(r.textClass=K(l.styleClasses.textClass,r.textClass||""))),r.map.length==0&&r.map.push(0,0,r.content.appendChild(Pr(e.display.measure))),n==0?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(y){var A=r.content.lastChild;(/\bcm-tab\b/.test(A.className)||A.querySelector&&A.querySelector(".cm-tab"))&&(r.content.className="cm-tab-wrap-hack")}return Te(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=K(r.pre.className,r.textClass||"")),r}function dl(e){var t=D("span","\u2022","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function pl(e,t,i,r,n,l,_){if(!!t){var C=e.splitSpaces?vl(t,e.trailingSpace):t,A=e.cm.state.specialChars,R=!1,W;if(!A.test(t))e.col+=t.length,W=document.createTextNode(C),e.map.push(e.pos,e.pos+t.length,W),k&&v<9&&(R=!0),e.pos+=t.length;else{W=document.createDocumentFragment();for(var z=0;;){A.lastIndex=z;var J=A.exec(t),X=J?J.index-z:t.length-z;if(X){var ee=document.createTextNode(C.slice(z,z+X));k&&v<9?W.appendChild(D("span",[ee])):W.appendChild(ee),e.map.push(e.pos,e.pos+X,ee),e.col+=X,e.pos+=X}if(!J)break;z+=X+1;var ne=void 0;if(J[0]=="	"){var he=e.cm.options.tabSize,de=he-e.col%he;ne=W.appendChild(D("span",Be(de),"cm-tab")),ne.setAttribute("role","presentation"),ne.setAttribute("cm-text","	"),e.col+=de}else J[0]=="\r"||J[0]==`
`?(ne=W.appendChild(D("span",J[0]=="\r"?"\u240D":"\u2424","cm-invalidchar")),ne.setAttribute("cm-text",J[0]),e.col+=1):(ne=e.cm.options.specialCharPlaceholder(J[0]),ne.setAttribute("cm-text",J[0]),k&&v<9?W.appendChild(D("span",[ne])):W.appendChild(ne),e.col+=1);e.map.push(e.pos,e.pos+1,ne),e.pos++}}if(e.trailingSpace=C.charCodeAt(t.length-1)==32,i||r||n||R||l||_){var ye=i||"";r&&(ye+=r),n&&(ye+=n);var pe=D("span",[W],ye,l);if(_)for(var me in _)_.hasOwnProperty(me)&&me!="style"&&me!="class"&&pe.setAttribute(me,_[me]);return e.content.appendChild(pe)}e.content.appendChild(W)}}function vl(e,t){if(e.length>1&&!/  /.test(e))return e;for(var i=t,r="",n=0;n<e.length;n++){var l=e.charAt(n);l==" "&&i&&(n==e.length-1||e.charCodeAt(n+1)==32)&&(l="\xA0"),r+=l,i=l==" "}return r}function _l(e,t){return function(i,r,n,l,_,C,A){n=n?n+" cm-force-border":"cm-force-border";for(var R=i.pos,W=R+r.length;;){for(var z=void 0,J=0;J<t.length&&(z=t[J],!(z.to>R&&z.from<=R));J++);if(z.to>=W)return e(i,r,n,l,_,C,A);e(i,r.slice(0,z.to-R),n,l,null,C,A),l=null,r=r.slice(z.to-R),R=z.to}}}function Qo(e,t,i,r){var n=!r&&i.widgetNode;n&&e.map.push(e.pos,e.pos+t,n),!r&&e.cm.display.input.needsContentAttribute&&(n||(n=e.content.appendChild(document.createElement("span"))),n.setAttribute("cm-marker",i.id)),n&&(e.cm.display.input.setUneditable(n),e.content.appendChild(n)),e.pos+=t,e.trailingSpace=!1}function gl(e,t,i){var r=e.markedSpans,n=e.text,l=0;if(!r){for(var _=1;_<i.length;_+=2)t.addToken(t,n.slice(l,l=i[_]),Jo(i[_+1],t.cm.options));return}for(var C=n.length,A=0,R=1,W="",z,J,X=0,ee,ne,he,de,ye;;){if(X==A){ee=ne=he=J="",ye=null,de=null,X=1/0;for(var pe=[],me=void 0,Ae=0;Ae<r.length;++Ae){var xe=r[Ae],Re=xe.marker;if(Re.type=="bookmark"&&xe.from==A&&Re.widgetNode)pe.push(Re);else if(xe.from<=A&&(xe.to==null||xe.to>A||Re.collapsed&&xe.to==A&&xe.from==A)){if(xe.to!=null&&xe.to!=A&&X>xe.to&&(X=xe.to,ne=""),Re.className&&(ee+=" "+Re.className),Re.css&&(J=(J?J+";":"")+Re.css),Re.startStyle&&xe.from==A&&(he+=" "+Re.startStyle),Re.endStyle&&xe.to==X&&(me||(me=[])).push(Re.endStyle,xe.to),Re.title&&((ye||(ye={})).title=Re.title),Re.attributes)for(var We in Re.attributes)(ye||(ye={}))[We]=Re.attributes[We];Re.collapsed&&(!de||Nr(de.marker,Re)<0)&&(de=xe)}else xe.from>A&&X>xe.from&&(X=xe.from)}if(me)for(var lt=0;lt<me.length;lt+=2)me[lt+1]==X&&(ne+=" "+me[lt]);if(!de||de.from==A)for(var ze=0;ze<pe.length;++ze)Qo(t,0,pe[ze]);if(de&&(de.from||0)==A){if(Qo(t,(de.to==null?C+1:de.to)-A,de.marker,de.from==null),de.to==null)return;de.to==A&&(de=!1)}}if(A>=C)break;for(var Xt=Math.min(C,X);;){if(W){var Wt=A+W.length;if(!de){var $e=Wt>Xt?W.slice(0,Xt-A):W;t.addToken(t,$e,z?z+ee:ee,he,A+$e.length==X?ne:"",J,ye)}if(Wt>=Xt){W=W.slice(Xt-A),A=Xt;break}A=Wt,he=""}W=n.slice(l,l=i[R++]),z=Jo(i[R++],t.cm.options)}}}function es(e,t,i){this.line=t,this.rest=qr(t),this.size=this.rest?De(Ee(this.rest))-i+1:1,this.node=this.text=null,this.hidden=Ct(e,t)}function On(e,t,i){for(var r=[],n,l=t;l<i;l=n){var _=new es(e.doc,Se(e.doc,l),l);n=l+_.size,r.push(_)}return r}var Ii=null;function yl(e){Ii?Ii.ops.push(e):e.ownsGroup=Ii={ops:[e],delayedCallbacks:[]}}function ml(e){var t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i].call(null);for(var r=0;r<e.ops.length;r++){var n=e.ops[r];if(n.cursorActivityHandlers)for(;n.cursorActivityCalled<n.cursorActivityHandlers.length;)n.cursorActivityHandlers[n.cursorActivityCalled++].call(null,n.cm)}}while(i<t.length)}function bl(e,t){var i=e.ownsGroup;if(!!i)try{ml(i)}finally{Ii=null,t(i)}}var rn=null;function ot(e,t){var i=ar(e,t);if(!!i.length){var r=Array.prototype.slice.call(arguments,2),n;Ii?n=Ii.delayedCallbacks:rn?n=rn:(n=rn=[],setTimeout(Sl,0));for(var l=function(C){n.push(function(){return i[C].apply(null,r)})},_=0;_<i.length;++_)l(_)}}function Sl(){var e=rn;rn=null;for(var t=0;t<e.length;++t)e[t]()}function ts(e,t,i,r){for(var n=0;n<t.changes.length;n++){var l=t.changes[n];l=="text"?wl(e,t):l=="gutter"?is(e,t,i,r):l=="class"?oo(e,t):l=="widget"&&Ll(e,t,r)}t.changes=null}function nn(e){return e.node==e.text&&(e.node=D("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),k&&v<8&&(e.node.style.zIndex=2)),e.node}function Cl(e,t){var i=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(i&&(i+=" CodeMirror-linebackground"),t.background)i?t.background.className=i:(t.background.parentNode.removeChild(t.background),t.background=null);else if(i){var r=nn(t);t.background=r.insertBefore(D("div",null,i),r.firstChild),e.display.input.setUneditable(t.background)}}function rs(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):$o(e,t)}function wl(e,t){var i=t.text.className,r=rs(e,t);t.text==t.node&&(t.node=r.pre),t.text.parentNode.replaceChild(r.pre,t.text),t.text=r.pre,r.bgClass!=t.bgClass||r.textClass!=t.textClass?(t.bgClass=r.bgClass,t.textClass=r.textClass,oo(e,t)):i&&(t.text.className=i)}function oo(e,t){Cl(e,t),t.line.wrapClass?nn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function is(e,t,i,r){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var n=nn(t);t.gutterBackground=D("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px; width: "+r.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),n.insertBefore(t.gutterBackground,t.text)}var l=t.line.gutterMarkers;if(e.options.lineNumbers||l){var _=nn(t),C=t.gutter=D("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?r.fixedPos:-r.gutterTotalWidth)+"px");if(C.setAttribute("aria-hidden","true"),e.display.input.setUneditable(C),_.insertBefore(C,t.text),t.line.gutterClass&&(C.className+=" "+t.line.gutterClass),e.options.lineNumbers&&(!l||!l["CodeMirror-linenumbers"])&&(t.lineNumber=C.appendChild(D("div",Lr(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),l)for(var A=0;A<e.display.gutterSpecs.length;++A){var R=e.display.gutterSpecs[A].className,W=l.hasOwnProperty(R)&&l[R];W&&C.appendChild(D("div",[W],"CodeMirror-gutter-elt","left: "+r.gutterLeft[R]+"px; width: "+r.gutterWidth[R]+"px"))}}}function Ll(e,t,i){t.alignable&&(t.alignable=null);for(var r=H("CodeMirror-linewidget"),n=t.node.firstChild,l=void 0;n;n=l)l=n.nextSibling,r.test(n.className)&&t.node.removeChild(n);ns(e,t,i)}function xl(e,t,i,r){var n=rs(e,t);return t.text=t.node=n.pre,n.bgClass&&(t.bgClass=n.bgClass),n.textClass&&(t.textClass=n.textClass),oo(e,t),is(e,t,i,r),ns(e,t,r),t.node}function ns(e,t,i){if(os(e,t.line,t,i,!0),t.rest)for(var r=0;r<t.rest.length;r++)os(e,t.rest[r],t,i,!1)}function os(e,t,i,r,n){if(!!t.widgets)for(var l=nn(i),_=0,C=t.widgets;_<C.length;++_){var A=C[_],R=D("div",[A.node],"CodeMirror-linewidget"+(A.className?" "+A.className:""));A.handleMouseEvents||R.setAttribute("cm-ignore-events","true"),kl(A,R,i,r),e.display.input.setUneditable(R),n&&A.above?l.insertBefore(R,i.gutter||i.text):l.appendChild(R),ot(A,"redraw")}}function kl(e,t,i,r){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);var n=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(n-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=n+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function on(e){if(e.height!=null)return e.height;var t=e.doc.cm;if(!t)return 0;if(!j(document.body,e.node)){var i="position: relative;";e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),L(t.display.measure,D("div",[e.node],null,i))}return e.height=e.node.parentNode.offsetHeight}function Kr(e,t){for(var i=Vt(t);i!=e.wrapper;i=i.parentNode)if(!i||i.nodeType==1&&i.getAttribute("cm-ignore-events")=="true"||i.parentNode==e.sizer&&i!=e.mover)return!0}function Dn(e){return e.lineSpace.offsetTop}function so(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function ss(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=L(e.measure,D("pre","x","CodeMirror-line-like")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,r={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return!isNaN(r.left)&&!isNaN(r.right)&&(e.cachedPaddingH=r),r}function Ar(e){return B-e.display.nativeBarWidth}function _i(e){return e.display.scroller.clientWidth-Ar(e)-e.display.barWidth}function ao(e){return e.display.scroller.clientHeight-Ar(e)-e.display.barHeight}function El(e,t,i){var r=e.options.lineWrapping,n=r&&_i(e);if(!t.measure.heights||r&&t.measure.width!=n){var l=t.measure.heights=[];if(r){t.measure.width=n;for(var _=t.text.firstChild.getClientRects(),C=0;C<_.length-1;C++){var A=_[C],R=_[C+1];Math.abs(A.bottom-R.bottom)>2&&l.push((A.bottom+R.top)/2-i.top)}}l.push(i.bottom-i.top)}}function as(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};if(e.rest){for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r]};for(var n=0;n<e.rest.length;n++)if(De(e.rest[n])>i)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}}function Al(e,t){t=rt(t);var i=De(t),r=e.display.externalMeasured=new es(e.doc,t,i);r.lineN=i;var n=r.built=$o(e,r);return r.text=n.pre,L(e.display.lineMeasure,n.pre),r}function ls(e,t,i,r){return Tr(e,Fi(e,t),i,r)}function lo(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[mi(e,t)];var i=e.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size)return i}function Fi(e,t){var i=De(t),r=lo(e,i);r&&!r.text?r=null:r&&r.changes&&(ts(e,r,i,po(e)),e.curOp.forceUpdate=!0),r||(r=Al(e,t));var n=as(r,t,i);return{line:t,view:r,rect:null,map:n.map,cache:n.cache,before:n.before,hasHeights:!1}}function Tr(e,t,i,r,n){t.before&&(i=-1);var l=i+(r||""),_;return t.cache.hasOwnProperty(l)?_=t.cache[l]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(El(e,t.view,t.rect),t.hasHeights=!0),_=Ml(e,t,i,r),_.bogus||(t.cache[l]=_)),{left:_.left,right:_.right,top:n?_.rtop:_.top,bottom:n?_.rbottom:_.bottom}}var cs={left:0,right:0,top:0,bottom:0};function us(e,t,i){for(var r,n,l,_,C,A,R=0;R<e.length;R+=3)if(C=e[R],A=e[R+1],t<C?(n=0,l=1,_="left"):t<A?(n=t-C,l=n+1):(R==e.length-3||t==A&&e[R+3]>t)&&(l=A-C,n=l-1,t>=A&&(_="right")),n!=null){if(r=e[R+2],C==A&&i==(r.insertLeft?"left":"right")&&(_=i),i=="left"&&n==0)for(;R&&e[R-2]==e[R-3]&&e[R-1].insertLeft;)r=e[(R-=3)+2],_="left";if(i=="right"&&n==A-C)for(;R<e.length-3&&e[R+3]==e[R+4]&&!e[R+5].insertLeft;)r=e[(R+=3)+2],_="right";break}return{node:r,start:n,end:l,collapse:_,coverStart:C,coverEnd:A}}function Tl(e,t){var i=cs;if(t=="left")for(var r=0;r<e.length&&(i=e[r]).left==i.right;r++);else for(var n=e.length-1;n>=0&&(i=e[n]).left==i.right;n--);return i}function Ml(e,t,i,r){var n=us(t.map,i,r),l=n.node,_=n.start,C=n.end,A=n.collapse,R;if(l.nodeType==3){for(var W=0;W<4;W++){for(;_&&Dr(t.line.text.charAt(n.coverStart+_));)--_;for(;n.coverStart+C<n.coverEnd&&Dr(t.line.text.charAt(n.coverStart+C));)++C;if(k&&v<9&&_==0&&C==n.coverEnd-n.coverStart?R=l.parentNode.getBoundingClientRect():R=Tl(Y(l,_,C).getClientRects(),r),R.left||R.right||_==0)break;C=_,_=_-1,A="right"}k&&v<11&&(R=Rl(e.display.measure,R))}else{_>0&&(A=r="right");var z;e.options.lineWrapping&&(z=l.getClientRects()).length>1?R=z[r=="right"?z.length-1:0]:R=l.getBoundingClientRect()}if(k&&v<9&&!_&&(!R||!R.left&&!R.right)){var J=l.parentNode.getClientRects()[0];J?R={left:J.left,right:J.left+Ni(e.display),top:J.top,bottom:J.bottom}:R=cs}for(var X=R.top-t.rect.top,ee=R.bottom-t.rect.top,ne=(X+ee)/2,he=t.view.measure.heights,de=0;de<he.length-1&&!(ne<he[de]);de++);var ye=de?he[de-1]:0,pe=he[de],me={left:(A=="right"?R.right:R.left)-t.rect.left,right:(A=="left"?R.left:R.right)-t.rect.left,top:ye,bottom:pe};return!R.left&&!R.right&&(me.bogus=!0),e.options.singleCursorHeightPerLine||(me.rtop=X,me.rbottom=ee),me}function Rl(e,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!Jt(e))return t;var i=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*r,bottom:t.bottom*r}}function fs(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function hs(e){e.display.externalMeasure=null,M(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)fs(e.display.view[t])}function sn(e){hs(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function ds(){return m&&a?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ps(){return m&&a?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function co(e){var t=0;if(e.widgets)for(var i=0;i<e.widgets.length;++i)e.widgets[i].above&&(t+=on(e.widgets[i]));return t}function Bn(e,t,i,r,n){if(!n){var l=co(t);i.top+=l,i.bottom+=l}if(r=="line")return i;r||(r="local");var _=wt(t);if(r=="local"?_+=Dn(e.display):_-=e.display.viewOffset,r=="page"||r=="window"){var C=e.display.lineSpace.getBoundingClientRect();_+=C.top+(r=="window"?0:ps());var A=C.left+(r=="window"?0:ds());i.left+=A,i.right+=A}return i.top+=_,i.bottom+=_,i}function vs(e,t,i){if(i=="div")return t;var r=t.left,n=t.top;if(i=="page")r-=ds(),n-=ps();else if(i=="local"||!i){var l=e.display.sizer.getBoundingClientRect();r+=l.left,n+=l.top}var _=e.display.lineSpace.getBoundingClientRect();return{left:r-_.left,top:n-_.top}}function Pn(e,t,i,r,n){return r||(r=Se(e.doc,t.line)),Bn(e,r,ls(e,r,t.ch,n),i)}function dr(e,t,i,r,n,l){r=r||Se(e.doc,t.line),n||(n=Fi(e,r));function _(ee,ne){var he=Tr(e,n,ee,ne?"right":"left",l);return ne?he.left=he.right:he.right=he.left,Bn(e,r,he,i)}var C=ut(r,e.doc.direction),A=t.ch,R=t.sticky;if(A>=r.text.length?(A=r.text.length,R="before"):A<=0&&(A=0,R="after"),!C)return _(R=="before"?A-1:A,R=="before");function W(ee,ne,he){var de=C[ne],ye=de.level==1;return _(he?ee-1:ee,ye!=he)}var z=Ne(C,A,R),J=gt,X=W(A,z,R=="before");return J!=null&&(X.other=W(A,J,R!="before")),X}function _s(e,t){var i=0;t=ge(e.doc,t),e.options.lineWrapping||(i=Ni(e.display)*t.ch);var r=Se(e.doc,t.line),n=wt(r)+Dn(e.display);return{left:i,right:i,top:n,bottom:n+r.height}}function uo(e,t,i,r,n){var l=le(e,t,i);return l.xRel=n,r&&(l.outside=r),l}function fo(e,t,i){var r=e.doc;if(i+=e.display.viewOffset,i<0)return uo(r.first,0,null,-1,-1);var n=Bt(r,i),l=r.first+r.size-1;if(n>l)return uo(r.first+r.size-1,Se(r,l).text.length,null,1,1);t<0&&(t=0);for(var _=Se(r,n);;){var C=Ol(e,_,n,t,i),A=Ht(_,C.ch+(C.xRel>0||C.outside>0?1:0));if(!A)return C;var R=A.find(1);if(R.line==n)return R;_=Se(r,n=R.line)}}function gs(e,t,i,r){r-=co(t);var n=t.text.length,l=Ut(function(_){return Tr(e,i,_-1).bottom<=r},n,0);return n=Ut(function(_){return Tr(e,i,_).top>r},l,n),{begin:l,end:n}}function ys(e,t,i,r){i||(i=Fi(e,t));var n=Bn(e,t,Tr(e,i,r),"line").top;return gs(e,t,i,n)}function ho(e,t,i,r){return e.bottom<=i?!1:e.top>i?!0:(r?e.left:e.right)>t}function Ol(e,t,i,r,n){n-=wt(t);var l=Fi(e,t),_=co(t),C=0,A=t.text.length,R=!0,W=ut(t,e.doc.direction);if(W){var z=(e.options.lineWrapping?Bl:Dl)(e,t,i,l,W,r,n);R=z.level!=1,C=R?z.from:z.to-1,A=R?z.to:z.from-1}var J=null,X=null,ee=Ut(function(Ae){var xe=Tr(e,l,Ae);return xe.top+=_,xe.bottom+=_,ho(xe,r,n,!1)?(xe.top<=n&&xe.left<=r&&(J=Ae,X=xe),!0):!1},C,A),ne,he,de=!1;if(X){var ye=r-X.left<X.right-r,pe=ye==R;ee=J+(pe?0:1),he=pe?"after":"before",ne=ye?X.left:X.right}else{!R&&(ee==A||ee==C)&&ee++,he=ee==0?"after":ee==t.text.length?"before":Tr(e,l,ee-(R?1:0)).bottom+_<=n==R?"after":"before";var me=dr(e,le(i,ee,he),"line",t,l);ne=me.left,de=n<me.top?-1:n>=me.bottom?1:0}return ee=Vr(t.text,ee,1),uo(i,ee,he,de,r-ne)}function Dl(e,t,i,r,n,l,_){var C=Ut(function(z){var J=n[z],X=J.level!=1;return ho(dr(e,le(i,X?J.to:J.from,X?"before":"after"),"line",t,r),l,_,!0)},0,n.length-1),A=n[C];if(C>0){var R=A.level!=1,W=dr(e,le(i,R?A.from:A.to,R?"after":"before"),"line",t,r);ho(W,l,_,!0)&&W.top>_&&(A=n[C-1])}return A}function Bl(e,t,i,r,n,l,_){var C=gs(e,t,r,_),A=C.begin,R=C.end;/\s/.test(t.text.charAt(R-1))&&R--;for(var W=null,z=null,J=0;J<n.length;J++){var X=n[J];if(!(X.from>=R||X.to<=A)){var ee=X.level!=1,ne=Tr(e,r,ee?Math.min(R,X.to)-1:Math.max(A,X.from)).right,he=ne<l?l-ne+1e9:ne-l;(!W||z>he)&&(W=X,z=he)}}return W||(W=n[n.length-1]),W.from<A&&(W={from:A,to:W.to,level:W.level}),W.to>R&&(W={from:W.from,to:R,level:W.level}),W}var gi;function Wi(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(gi==null){gi=D("pre",null,"CodeMirror-line-like");for(var t=0;t<49;++t)gi.appendChild(document.createTextNode("x")),gi.appendChild(D("br"));gi.appendChild(document.createTextNode("x"))}L(e.measure,gi);var i=gi.offsetHeight/50;return i>3&&(e.cachedTextHeight=i),M(e.measure),i||1}function Ni(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var t=D("span","xxxxxxxxxx"),i=D("pre",[t],"CodeMirror-line-like");L(e.measure,i);var r=t.getBoundingClientRect(),n=(r.right-r.left)/10;return n>2&&(e.cachedCharWidth=n),n||10}function po(e){for(var t=e.display,i={},r={},n=t.gutters.clientLeft,l=t.gutters.firstChild,_=0;l;l=l.nextSibling,++_){var C=e.display.gutterSpecs[_].className;i[C]=l.offsetLeft+l.clientLeft+n,r[C]=l.clientWidth}return{fixedPos:vo(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function vo(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function ms(e){var t=Wi(e.display),i=e.options.lineWrapping,r=i&&Math.max(5,e.display.scroller.clientWidth/Ni(e.display)-3);return function(n){if(Ct(e.doc,n))return 0;var l=0;if(n.widgets)for(var _=0;_<n.widgets.length;_++)n.widgets[_].height&&(l+=n.widgets[_].height);return i?l+(Math.ceil(n.text.length/r)||1)*t:l+t}}function _o(e){var t=e.doc,i=ms(e);t.iter(function(r){var n=i(r);n!=r.height&&nt(r,n)})}function yi(e,t,i,r){var n=e.display;if(!i&&Vt(t).getAttribute("cm-not-content")=="true")return null;var l,_,C=n.lineSpace.getBoundingClientRect();try{l=t.clientX-C.left,_=t.clientY-C.top}catch{return null}var A=fo(e,l,_),R;if(r&&A.xRel>0&&(R=Se(e.doc,A.line).text).length==A.ch){var W=Ce(R,R.length,e.options.tabSize)-R.length;A=le(A.line,Math.max(0,Math.round((l-ss(e.display).left)/Ni(e.display))-W))}return A}function mi(e,t){if(t>=e.display.viewTo||(t-=e.display.viewFrom,t<0))return null;for(var i=e.display.view,r=0;r<i.length;r++)if(t-=i[r].size,t<0)return r}function It(e,t,i,r){t==null&&(t=e.doc.first),i==null&&(i=e.doc.first+e.doc.size),r||(r=0);var n=e.display;if(r&&i<n.viewTo&&(n.updateLineNumbers==null||n.updateLineNumbers>t)&&(n.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=n.viewTo)ir&&hr(e.doc,t)<n.viewTo&&ei(e);else if(i<=n.viewFrom)ir&&pi(e.doc,i+r)>n.viewFrom?ei(e):(n.viewFrom+=r,n.viewTo+=r);else if(t<=n.viewFrom&&i>=n.viewTo)ei(e);else if(t<=n.viewFrom){var l=Hn(e,i,i+r,1);l?(n.view=n.view.slice(l.index),n.viewFrom=l.lineN,n.viewTo+=r):ei(e)}else if(i>=n.viewTo){var _=Hn(e,t,t,-1);_?(n.view=n.view.slice(0,_.index),n.viewTo=_.lineN):ei(e)}else{var C=Hn(e,t,t,-1),A=Hn(e,i,i+r,1);C&&A?(n.view=n.view.slice(0,C.index).concat(On(e,C.lineN,A.lineN)).concat(n.view.slice(A.index)),n.viewTo+=r):ei(e)}var R=n.externalMeasured;R&&(i<R.lineN?R.lineN+=r:t<R.lineN+R.size&&(n.externalMeasured=null))}function Qr(e,t,i){e.curOp.viewChanged=!0;var r=e.display,n=e.display.externalMeasured;if(n&&t>=n.lineN&&t<n.lineN+n.size&&(r.externalMeasured=null),!(t<r.viewFrom||t>=r.viewTo)){var l=r.view[mi(e,t)];if(l.node!=null){var _=l.changes||(l.changes=[]);fe(_,i)==-1&&_.push(i)}}}function ei(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Hn(e,t,i,r){var n=mi(e,t),l,_=e.display.view;if(!ir||i==e.doc.first+e.doc.size)return{index:n,lineN:i};for(var C=e.display.viewFrom,A=0;A<n;A++)C+=_[A].size;if(C!=t){if(r>0){if(n==_.length-1)return null;l=C+_[n].size-t,n++}else l=C-t;t+=l,i+=l}for(;hr(e.doc,i)!=i;){if(n==(r<0?0:_.length-1))return null;i+=r*_[n-(r<0?1:0)].size,n+=r}return{index:n,lineN:i}}function Pl(e,t,i){var r=e.display,n=r.view;n.length==0||t>=r.viewTo||i<=r.viewFrom?(r.view=On(e,t,i),r.viewFrom=t):(r.viewFrom>t?r.view=On(e,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(mi(e,t))),r.viewFrom=t,r.viewTo<i?r.view=r.view.concat(On(e,r.viewTo,i)):r.viewTo>i&&(r.view=r.view.slice(0,mi(e,i)))),r.viewTo=i}function bs(e){for(var t=e.display.view,i=0,r=0;r<t.length;r++){var n=t[r];!n.hidden&&(!n.node||n.changes)&&++i}return i}function an(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Ss(e,t){t===void 0&&(t=!0);var i=e.doc,r={},n=r.cursors=document.createDocumentFragment(),l=r.selection=document.createDocumentFragment(),_=e.options.$customCursor;_&&(t=!0);for(var C=0;C<i.sel.ranges.length;C++)if(!(!t&&C==i.sel.primIndex)){var A=i.sel.ranges[C];if(!(A.from().line>=e.display.viewTo||A.to().line<e.display.viewFrom)){var R=A.empty();if(_){var W=_(e,A);W&&go(e,W,n)}else(R||e.options.showCursorWhenSelecting)&&go(e,A.head,n);R||Hl(e,A,l)}}return r}function go(e,t,i){var r=dr(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),n=i.appendChild(D("div","\xA0","CodeMirror-cursor"));if(n.style.left=r.left+"px",n.style.top=r.top+"px",n.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",/\bcm-fat-cursor\b/.test(e.getWrapperElement().className)){var l=Pn(e,t,"div",null,null),_=l.right-l.left;n.style.width=(_>0?_:e.defaultCharWidth())+"px"}if(r.other){var C=i.appendChild(D("div","\xA0","CodeMirror-cursor CodeMirror-secondarycursor"));C.style.display="",C.style.left=r.other.left+"px",C.style.top=r.other.top+"px",C.style.height=(r.other.bottom-r.other.top)*.85+"px"}}function In(e,t){return e.top-t.top||e.left-t.left}function Hl(e,t,i){var r=e.display,n=e.doc,l=document.createDocumentFragment(),_=ss(e.display),C=_.left,A=Math.max(r.sizerWidth,_i(e)-r.sizer.offsetLeft)-_.right,R=n.direction=="ltr";function W(pe,me,Ae,xe){me<0&&(me=0),me=Math.round(me),xe=Math.round(xe),l.appendChild(D("div",null,"CodeMirror-selected","position: absolute; left: "+pe+`px;
                             top: `+me+"px; width: "+(Ae??A-pe)+`px;
                             height: `+(xe-me)+"px"))}function z(pe,me,Ae){var xe=Se(n,pe),Re=xe.text.length,We,lt;function ze($e,Nt){return Pn(e,le(pe,$e),"div",xe,Nt)}function Xt($e,Nt,pt){var it=ys(e,xe,null,$e),Qe=Nt=="ltr"==(pt=="after")?"left":"right",Xe=pt=="after"?it.begin:it.end-(/\s/.test(xe.text.charAt(it.end-1))?2:1);return ze(Xe,Qe)[Qe]}var Wt=ut(xe,n.direction);return ci(Wt,me||0,Ae??Re,function($e,Nt,pt,it){var Qe=pt=="ltr",Xe=ze($e,Qe?"left":"right"),jt=ze(Nt-1,Qe?"right":"left"),Qi=me==null&&$e==0,si=Ae==null&&Nt==Re,xt=it==0,Mr=!Wt||it==Wt.length-1;if(jt.top-Xe.top<=3){var ct=(R?Qi:si)&&xt,qo=(R?si:Qi)&&Mr,Yr=ct?C:(Qe?Xe:jt).left,Li=qo?A:(Qe?jt:Xe).right;W(Yr,Xe.top,Li-Yr,Xe.bottom)}else{var xi,Tt,en,zo;Qe?(xi=R&&Qi&&xt?C:Xe.left,Tt=R?A:Xt($e,pt,"before"),en=R?C:Xt(Nt,pt,"after"),zo=R&&si&&Mr?A:jt.right):(xi=R?Xt($e,pt,"before"):C,Tt=!R&&Qi&&xt?A:Xe.right,en=!R&&si&&Mr?C:jt.left,zo=R?Xt(Nt,pt,"after"):A),W(xi,Xe.top,Tt-xi,Xe.bottom),Xe.bottom<jt.top&&W(C,Xe.bottom,null,jt.top),W(en,jt.top,zo-en,jt.bottom)}(!We||In(Xe,We)<0)&&(We=Xe),In(jt,We)<0&&(We=jt),(!lt||In(Xe,lt)<0)&&(lt=Xe),In(jt,lt)<0&&(lt=jt)}),{start:We,end:lt}}var J=t.from(),X=t.to();if(J.line==X.line)z(J.line,J.ch,X.ch);else{var ee=Se(n,J.line),ne=Se(n,X.line),he=rt(ee)==rt(ne),de=z(J.line,J.ch,he?ee.text.length+1:null).end,ye=z(X.line,he?0:null,X.ch).start;he&&(de.top<ye.top-2?(W(de.right,de.top,null,de.bottom),W(C,ye.top,ye.left,ye.bottom)):W(de.right,de.top,ye.left-de.right,de.bottom)),de.bottom<ye.top&&W(C,de.bottom,null,ye.top)}i.appendChild(l)}function yo(e){if(!!e.state.focused){var t=e.display;clearInterval(t.blinker);var i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){e.hasFocus()||ji(e),t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Cs(e){e.hasFocus()||(e.display.input.focus(),e.state.focused||bo(e))}function mo(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,e.state.focused&&ji(e))},100)}function bo(e,t){e.state.delayingBlurEvent&&!e.state.draggingText&&(e.state.delayingBlurEvent=!1),e.options.readOnly!="nocursor"&&(e.state.focused||(Te(e,"focus",e,t),e.state.focused=!0,F(e.display.wrapper,"CodeMirror-focused"),!e.curOp&&e.display.selForContextMenu!=e.doc.sel&&(e.display.input.reset(),y&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),yo(e))}function ji(e,t){e.state.delayingBlurEvent||(e.state.focused&&(Te(e,"blur",e,t),e.state.focused=!1,P(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Fn(e){for(var t=e.display,i=t.lineDiv.offsetTop,r=Math.max(0,t.scroller.getBoundingClientRect().top),n=t.lineDiv.getBoundingClientRect().top,l=0,_=0;_<t.view.length;_++){var C=t.view[_],A=e.options.lineWrapping,R=void 0,W=0;if(!C.hidden){if(n+=C.line.height,k&&v<8){var z=C.node.offsetTop+C.node.offsetHeight;R=z-i,i=z}else{var J=C.node.getBoundingClientRect();R=J.bottom-J.top,!A&&C.text.firstChild&&(W=C.text.firstChild.getBoundingClientRect().right-J.left-1)}var X=C.line.height-R;if((X>.005||X<-.005)&&(n<r&&(l-=X),nt(C.line,R),ws(C.line),C.rest))for(var ee=0;ee<C.rest.length;ee++)ws(C.rest[ee]);if(W>e.display.sizerWidth){var ne=Math.ceil(W/Ni(e.display));ne>e.display.maxLineLength&&(e.display.maxLineLength=ne,e.display.maxLine=C.line,e.display.maxLineChanged=!0)}}}Math.abs(l)>2&&(t.scroller.scrollTop+=l)}function ws(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var i=e.widgets[t],r=i.node.parentNode;r&&(i.height=r.offsetHeight)}}function Wn(e,t,i){var r=i&&i.top!=null?Math.max(0,i.top):e.scroller.scrollTop;r=Math.floor(r-Dn(e));var n=i&&i.bottom!=null?i.bottom:r+e.wrapper.clientHeight,l=Bt(t,r),_=Bt(t,n);if(i&&i.ensure){var C=i.ensure.from.line,A=i.ensure.to.line;C<l?(l=C,_=Bt(t,wt(Se(t,C))+e.wrapper.clientHeight)):Math.min(A,t.lastLine())>=_&&(l=Bt(t,wt(Se(t,A))-e.wrapper.clientHeight),_=A)}return{from:l,to:Math.max(_,l+1)}}function Il(e,t){if(!je(e,"scrollCursorIntoView")){var i=e.display,r=i.sizer.getBoundingClientRect(),n=null;if(t.top+r.top<0?n=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(n=!1),n!=null&&!f){var l=D("div","\u200B",null,`position: absolute;
                         top: `+(t.top-i.viewOffset-Dn(e.display))+`px;
                         height: `+(t.bottom-t.top+Ar(e)+i.barHeight)+`px;
                         left: `+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;");e.display.lineSpace.appendChild(l),l.scrollIntoView(n),e.display.lineSpace.removeChild(l)}}}function Fl(e,t,i,r){r==null&&(r=0);var n;!e.options.lineWrapping&&t==i&&(i=t.sticky=="before"?le(t.line,t.ch+1,"before"):t,t=t.ch?le(t.line,t.sticky=="before"?t.ch-1:t.ch,"after"):t);for(var l=0;l<5;l++){var _=!1,C=dr(e,t),A=!i||i==t?C:dr(e,i);n={left:Math.min(C.left,A.left),top:Math.min(C.top,A.top)-r,right:Math.max(C.left,A.left),bottom:Math.max(C.bottom,A.bottom)+r};var R=So(e,n),W=e.doc.scrollTop,z=e.doc.scrollLeft;if(R.scrollTop!=null&&(cn(e,R.scrollTop),Math.abs(e.doc.scrollTop-W)>1&&(_=!0)),R.scrollLeft!=null&&(bi(e,R.scrollLeft),Math.abs(e.doc.scrollLeft-z)>1&&(_=!0)),!_)break}return n}function Wl(e,t){var i=So(e,t);i.scrollTop!=null&&cn(e,i.scrollTop),i.scrollLeft!=null&&bi(e,i.scrollLeft)}function So(e,t){var i=e.display,r=Wi(e.display);t.top<0&&(t.top=0);var n=e.curOp&&e.curOp.scrollTop!=null?e.curOp.scrollTop:i.scroller.scrollTop,l=ao(e),_={};t.bottom-t.top>l&&(t.bottom=t.top+l);var C=e.doc.height+so(i),A=t.top<r,R=t.bottom>C-r;if(t.top<n)_.scrollTop=A?0:t.top;else if(t.bottom>n+l){var W=Math.min(t.top,(R?C:t.bottom)-l);W!=n&&(_.scrollTop=W)}var z=e.options.fixedGutter?0:i.gutters.offsetWidth,J=e.curOp&&e.curOp.scrollLeft!=null?e.curOp.scrollLeft:i.scroller.scrollLeft-z,X=_i(e)-i.gutters.offsetWidth,ee=t.right-t.left>X;return ee&&(t.right=t.left+X),t.left<10?_.scrollLeft=0:t.left<J?_.scrollLeft=Math.max(0,t.left+z-(ee?0:10)):t.right>X+J-3&&(_.scrollLeft=t.right+(ee?0:10)-X),_}function Co(e,t){t!=null&&(Nn(e),e.curOp.scrollTop=(e.curOp.scrollTop==null?e.doc.scrollTop:e.curOp.scrollTop)+t)}function Ui(e){Nn(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function ln(e,t,i){(t!=null||i!=null)&&Nn(e),t!=null&&(e.curOp.scrollLeft=t),i!=null&&(e.curOp.scrollTop=i)}function Nl(e,t){Nn(e),e.curOp.scrollToPos=t}function Nn(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var i=_s(e,t.from),r=_s(e,t.to);Ls(e,i,r,t.margin)}}function Ls(e,t,i,r){var n=So(e,{left:Math.min(t.left,i.left),top:Math.min(t.top,i.top)-r,right:Math.max(t.right,i.right),bottom:Math.max(t.bottom,i.bottom)+r});ln(e,n.scrollLeft,n.scrollTop)}function cn(e,t){Math.abs(e.doc.scrollTop-t)<2||(Q||Lo(e,{top:t}),xs(e,t,!0),Q&&Lo(e),hn(e,100))}function xs(e,t,i){t=Math.max(0,Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t)),!(e.display.scroller.scrollTop==t&&!i)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function bi(e,t,i,r){t=Math.max(0,Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth)),!((i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!r)&&(e.doc.scrollLeft=t,Ms(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function un(e){var t=e.display,i=t.gutters.offsetWidth,r=Math.round(e.doc.height+so(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:r,scrollHeight:r+Ar(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}var Si=function(e,t,i){this.cm=i;var r=this.vert=D("div",[D("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n=this.horiz=D("div",[D("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");r.tabIndex=n.tabIndex=-1,e(r),e(n),ke(r,"scroll",function(){r.clientHeight&&t(r.scrollTop,"vertical")}),ke(n,"scroll",function(){n.clientWidth&&t(n.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,k&&v<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Si.prototype.update=function(e){var t=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=t?r+"px":"0";var n=e.viewHeight-(t?r:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+n)+"px"}else this.vert.scrollTop=0,this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=i?r+"px":"0",this.horiz.style.left=e.barLeft+"px";var l=e.viewWidth-e.barLeft-(i?r:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+l)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(r==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?r:0,bottom:t?r:0}},Si.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Si.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Si.prototype.zeroWidthHack=function(){var e=o&&!u?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new we,this.disableVert=new we},Si.prototype.enableZeroWidthBar=function(e,t,i){e.style.pointerEvents="auto";function r(){var n=e.getBoundingClientRect(),l=i=="vert"?document.elementFromPoint(n.right-1,(n.top+n.bottom)/2):document.elementFromPoint((n.right+n.left)/2,n.bottom-1);l!=e?e.style.pointerEvents="none":t.set(1e3,r)}t.set(1e3,r)},Si.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};var fn=function(){};fn.prototype.update=function(){return{bottom:0,right:0}},fn.prototype.setScrollLeft=function(){},fn.prototype.setScrollTop=function(){},fn.prototype.clear=function(){};function qi(e,t){t||(t=un(e));var i=e.display.barWidth,r=e.display.barHeight;ks(e,t);for(var n=0;n<4&&i!=e.display.barWidth||r!=e.display.barHeight;n++)i!=e.display.barWidth&&e.options.lineWrapping&&Fn(e),ks(e,un(e)),i=e.display.barWidth,r=e.display.barHeight}function ks(e,t){var i=e.display,r=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=r.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=r.bottom)+"px",i.heightForcer.style.borderBottom=r.bottom+"px solid transparent",r.right&&r.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=r.bottom+"px",i.scrollbarFiller.style.width=r.right+"px"):i.scrollbarFiller.style.display="",r.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=r.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}var Es={native:Si,null:fn};function As(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&P(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new Es[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),ke(t,"mousedown",function(){e.state.focused&&setTimeout(function(){return e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,i){i=="horizontal"?bi(e,t):cn(e,t)},e),e.display.scrollbars.addClass&&F(e.display.wrapper,e.display.scrollbars.addClass)}var jl=0;function Ci(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++jl,markArrays:null},yl(e.curOp)}function wi(e){var t=e.curOp;t&&bl(t,function(i){for(var r=0;r<i.ops.length;r++)i.ops[r].cm.curOp=null;Ul(i)})}function Ul(e){for(var t=e.ops,i=0;i<t.length;i++)ql(t[i]);for(var r=0;r<t.length;r++)zl(t[r]);for(var n=0;n<t.length;n++)Kl(t[n]);for(var l=0;l<t.length;l++)Gl(t[l]);for(var _=0;_<t.length;_++)Xl(t[_])}function ql(e){var t=e.cm,i=t.display;Zl(t),e.updateMaxLine&&vi(t),e.mustUpdate=e.viewChanged||e.forceUpdate||e.scrollTop!=null||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new jn(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function zl(e){e.updatedDisplay=e.mustUpdate&&wo(e.cm,e.update)}function Kl(e){var t=e.cm,i=t.display;e.updatedDisplay&&Fn(t),e.barMeasure=un(t),i.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=ls(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+e.adjustWidthTo+Ar(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+e.adjustWidthTo-_i(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=i.input.prepareSelection())}function Gl(e){var t=e.cm;e.adjustWidthTo!=null&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&bi(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var i=e.focus&&e.focus==I();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,i),(e.updatedDisplay||e.startHeight!=t.doc.height)&&qi(t,e.barMeasure),e.updatedDisplay&&ko(t,e.barMeasure),e.selectionChanged&&yo(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),i&&Cs(e.cm)}function Xl(e){var t=e.cm,i=t.display,r=t.doc;if(e.updatedDisplay&&Ts(t,e.update),i.wheelStartX!=null&&(e.scrollTop!=null||e.scrollLeft!=null||e.scrollToPos)&&(i.wheelStartX=i.wheelStartY=null),e.scrollTop!=null&&xs(t,e.scrollTop,e.forceScroll),e.scrollLeft!=null&&bi(t,e.scrollLeft,!0,!0),e.scrollToPos){var n=Fl(t,ge(r,e.scrollToPos.from),ge(r,e.scrollToPos.to),e.scrollToPos.margin);Il(t,n)}var l=e.maybeHiddenMarkers,_=e.maybeUnhiddenMarkers;if(l)for(var C=0;C<l.length;++C)l[C].lines.length||Te(l[C],"hide");if(_)for(var A=0;A<_.length;++A)_[A].lines.length&&Te(_[A],"unhide");i.wrapper.offsetHeight&&(r.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Te(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Gt(e,t){if(e.curOp)return t();Ci(e);try{return t()}finally{wi(e)}}function st(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Ci(e);try{return t.apply(e,arguments)}finally{wi(e)}}}function At(e){return function(){if(this.curOp)return e.apply(this,arguments);Ci(this);try{return e.apply(this,arguments)}finally{wi(this)}}}function at(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Ci(t);try{return e.apply(this,arguments)}finally{wi(t)}}}function hn(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,ue(Yl,e))}function Yl(e){var t=e.doc;if(!(t.highlightFrontier>=e.display.viewTo)){var i=+new Date+e.options.workTime,r=Wr(e,t.highlightFrontier),n=[];t.iter(r.line,Math.min(t.first+t.size,e.display.viewTo+500),function(l){if(r.line>=e.display.viewFrom){var _=l.styles,C=l.text.length>e.options.maxHighlightLength?dt(t.mode,r.state):null,A=Ti(e,l,r,!0);C&&(r.state=C),l.styles=A.styles;var R=l.styleClasses,W=A.classes;W?l.styleClasses=W:R&&(l.styleClasses=null);for(var z=!_||_.length!=l.styles.length||R!=W&&(!R||!W||R.bgClass!=W.bgClass||R.textClass!=W.textClass),J=0;!z&&J<_.length;++J)z=_[J]!=l.styles[J];z&&n.push(r.line),l.stateAfter=r.save(),r.nextLine()}else l.text.length<=e.options.maxHighlightLength&&ui(e,l.text,r),l.stateAfter=r.line%5==0?r.save():null,r.nextLine();if(+new Date>i)return hn(e,e.options.workDelay),!0}),t.highlightFrontier=r.line,t.modeFrontier=Math.max(t.modeFrontier,r.line),n.length&&Gt(e,function(){for(var l=0;l<n.length;l++)Qr(e,n[l],"text")})}}var jn=function(e,t,i){var r=e.display;this.viewport=t,this.visible=Wn(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=_i(e),this.force=i,this.dims=po(e),this.events=[]};jn.prototype.signal=function(e,t){Ke(e,t)&&this.events.push(arguments)},jn.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Te.apply(null,this.events[e])};function Zl(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Ar(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Ar(e)+"px",t.scrollbarsClipped=!0)}function Vl(e){if(e.hasFocus())return null;var t=I();if(!t||!j(e.display.lineDiv,t))return null;var i={activeElt:t};if(window.getSelection){var r=window.getSelection();r.anchorNode&&r.extend&&j(e.display.lineDiv,r.anchorNode)&&(i.anchorNode=r.anchorNode,i.anchorOffset=r.anchorOffset,i.focusNode=r.focusNode,i.focusOffset=r.focusOffset)}return i}function Jl(e){if(!(!e||!e.activeElt||e.activeElt==I())&&(e.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(e.activeElt.nodeName)&&e.anchorNode&&j(document.body,e.anchorNode)&&j(document.body,e.focusNode))){var t=window.getSelection(),i=document.createRange();i.setEnd(e.anchorNode,e.anchorOffset),i.collapse(!1),t.removeAllRanges(),t.addRange(i),t.extend(e.focusNode,e.focusOffset)}}function wo(e,t){var i=e.display,r=e.doc;if(t.editorIsHidden)return ei(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(i.updateLineNumbers==null||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&bs(e)==0)return!1;Rs(e)&&(ei(e),t.dims=po(e));var n=r.first+r.size,l=Math.max(t.visible.from-e.options.viewportMargin,r.first),_=Math.min(n,t.visible.to+e.options.viewportMargin);i.viewFrom<l&&l-i.viewFrom<20&&(l=Math.max(r.first,i.viewFrom)),i.viewTo>_&&i.viewTo-_<20&&(_=Math.min(n,i.viewTo)),ir&&(l=hr(e.doc,l),_=pi(e.doc,_));var C=l!=i.viewFrom||_!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth;Pl(e,l,_),i.viewOffset=wt(Se(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var A=bs(e);if(!C&&A==0&&!t.force&&i.renderedView==i.view&&(i.updateLineNumbers==null||i.updateLineNumbers>=i.viewTo))return!1;var R=Vl(e);return A>4&&(i.lineDiv.style.display="none"),$l(e,i.updateLineNumbers,t.dims),A>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,Jl(R),M(i.cursorDiv),M(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,C&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,hn(e,400)),i.updateLineNumbers=null,!0}function Ts(e,t){for(var i=t.viewport,r=!0;;r=!1){if(!r||!e.options.lineWrapping||t.oldDisplayWidth==_i(e)){if(i&&i.top!=null&&(i={top:Math.min(e.doc.height+so(e.display)-ao(e),i.top)}),t.visible=Wn(e.display,e.doc,i),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break}else r&&(t.visible=Wn(e.display,e.doc,i));if(!wo(e,t))break;Fn(e);var n=un(e);an(e),qi(e,n),ko(e,n),t.force=!1}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Lo(e,t){var i=new jn(e,t);if(wo(e,i)){Fn(e),Ts(e,i);var r=un(e);an(e),qi(e,r),ko(e,r),i.finish()}}function $l(e,t,i){var r=e.display,n=e.options.lineNumbers,l=r.lineDiv,_=l.firstChild;function C(ee){var ne=ee.nextSibling;return y&&o&&e.display.currentWheelTarget==ee?ee.style.display="none":ee.parentNode.removeChild(ee),ne}for(var A=r.view,R=r.viewFrom,W=0;W<A.length;W++){var z=A[W];if(!z.hidden)if(!z.node||z.node.parentNode!=l){var J=xl(e,z,R,i);l.insertBefore(J,_)}else{for(;_!=z.node;)_=C(_);var X=n&&t!=null&&t<=R&&z.lineNumber;z.changes&&(fe(z.changes,"gutter")>-1&&(X=!1),ts(e,z,R,i)),X&&(M(z.lineNumber),z.lineNumber.appendChild(document.createTextNode(Lr(e.options,R)))),_=z.node.nextSibling}R+=z.size}for(;_;)_=C(_)}function xo(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px",ot(e,"gutterChanged",e)}function ko(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Ar(e)+"px"}function Ms(e){var t=e.display,i=t.view;if(!(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter))){for(var r=vo(t)-t.scroller.scrollLeft+e.doc.scrollLeft,n=t.gutters.offsetWidth,l=r+"px",_=0;_<i.length;_++)if(!i[_].hidden){e.options.fixedGutter&&(i[_].gutter&&(i[_].gutter.style.left=l),i[_].gutterBackground&&(i[_].gutterBackground.style.left=l));var C=i[_].alignable;if(C)for(var A=0;A<C.length;A++)C[A].style.left=l}e.options.fixedGutter&&(t.gutters.style.left=r+n+"px")}}function Rs(e){if(!e.options.lineNumbers)return!1;var t=e.doc,i=Lr(e.options,t.first+t.size-1),r=e.display;if(i.length!=r.lineNumChars){var n=r.measure.appendChild(D("div",[D("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),l=n.firstChild.offsetWidth,_=n.offsetWidth-l;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(l,r.lineGutter.offsetWidth-_)+1,r.lineNumWidth=r.lineNumInnerWidth+_,r.lineNumChars=r.lineNumInnerWidth?i.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",xo(e.display),!0}return!1}function Eo(e,t){for(var i=[],r=!1,n=0;n<e.length;n++){var l=e[n],_=null;if(typeof l!="string"&&(_=l.style,l=l.className),l=="CodeMirror-linenumbers")if(t)r=!0;else continue;i.push({className:l,style:_})}return t&&!r&&i.push({className:"CodeMirror-linenumbers",style:null}),i}function Os(e){var t=e.gutters,i=e.gutterSpecs;M(t),e.lineGutter=null;for(var r=0;r<i.length;++r){var n=i[r],l=n.className,_=n.style,C=t.appendChild(D("div",null,"CodeMirror-gutter "+l));_&&(C.style.cssText=_),l=="CodeMirror-linenumbers"&&(e.lineGutter=C,C.style.width=(e.lineNumWidth||1)+"px")}t.style.display=i.length?"":"none",xo(e)}function dn(e){Os(e.display),It(e),Ms(e)}function Ql(e,t,i,r){var n=this;this.input=i,n.scrollbarFiller=D("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=D("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=E("div",null,"CodeMirror-code"),n.selectionDiv=D("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=D("div",null,"CodeMirror-cursors"),n.measure=D("div",null,"CodeMirror-measure"),n.lineMeasure=D("div",null,"CodeMirror-measure"),n.lineSpace=E("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none");var l=E("div",[n.lineSpace],"CodeMirror-lines");n.mover=D("div",[l],null,"position: relative"),n.sizer=D("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=D("div",null,null,"position: absolute; height: "+B+"px; width: 1px;"),n.gutters=D("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=D("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=D("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),n.wrapper.setAttribute("translate","no"),k&&v<8&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),!y&&!(Q&&s)&&(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,n.gutterSpecs=Eo(r.gutters,r.lineNumbers),Os(n),i.init(n)}var Un=0,Gr=null;k?Gr=-.53:Q?Gr=15:m?Gr=-.7:S&&(Gr=-1/3);function Ds(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return t==null&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),i==null&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:i==null&&(i=e.wheelDelta),{x:t,y:i}}function ec(e){var t=Ds(e);return t.x*=Gr,t.y*=Gr,t}function Bs(e,t){var i=Ds(t),r=i.x,n=i.y,l=Gr;t.deltaMode===0&&(r=t.deltaX,n=t.deltaY,l=1);var _=e.display,C=_.scroller,A=C.scrollWidth>C.clientWidth,R=C.scrollHeight>C.clientHeight;if(!!(r&&A||n&&R)){if(n&&o&&y){e:for(var W=t.target,z=_.view;W!=C;W=W.parentNode)for(var J=0;J<z.length;J++)if(z[J].node==W){e.display.currentWheelTarget=W;break e}}if(r&&!Q&&!b&&l!=null){n&&R&&cn(e,Math.max(0,C.scrollTop+n*l)),bi(e,Math.max(0,C.scrollLeft+r*l)),(!n||n&&R)&&Ye(t),_.wheelStartX=null;return}if(n&&l!=null){var X=n*l,ee=e.doc.scrollTop,ne=ee+_.wrapper.clientHeight;X<0?ee=Math.max(0,ee+X-50):ne=Math.min(e.doc.height,ne+X+50),Lo(e,{top:ee,bottom:ne})}Un<20&&t.deltaMode!==0&&(_.wheelStartX==null?(_.wheelStartX=C.scrollLeft,_.wheelStartY=C.scrollTop,_.wheelDX=r,_.wheelDY=n,setTimeout(function(){if(_.wheelStartX!=null){var he=C.scrollLeft-_.wheelStartX,de=C.scrollTop-_.wheelStartY,ye=de&&_.wheelDY&&de/_.wheelDY||he&&_.wheelDX&&he/_.wheelDX;_.wheelStartX=_.wheelStartY=null,!!ye&&(Gr=(Gr*Un+ye)/(Un+1),++Un)}},200)):(_.wheelDX+=r,_.wheelDY+=n))}}var er=function(e,t){this.ranges=e,this.primIndex=t};er.prototype.primary=function(){return this.ranges[this.primIndex]},er.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var i=this.ranges[t],r=e.ranges[t];if(!q(i.anchor,r.anchor)||!q(i.head,r.head))return!1}return!0},er.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new Pe(ie(this.ranges[t].anchor),ie(this.ranges[t].head));return new er(e,this.primIndex)},er.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},er.prototype.contains=function(e,t){t||(t=e);for(var i=0;i<this.ranges.length;i++){var r=this.ranges[i];if(O(t,r.from())>=0&&O(e,r.to())<=0)return i}return-1};var Pe=function(e,t){this.anchor=e,this.head=t};Pe.prototype.from=function(){return Me(this.anchor,this.head)},Pe.prototype.to=function(){return ce(this.anchor,this.head)},Pe.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch};function pr(e,t,i){var r=e&&e.options.selectionsMayTouch,n=t[i];t.sort(function(J,X){return O(J.from(),X.from())}),i=fe(t,n);for(var l=1;l<t.length;l++){var _=t[l],C=t[l-1],A=O(C.to(),_.from());if(r&&!_.empty()?A>0:A>=0){var R=Me(C.from(),_.from()),W=ce(C.to(),_.to()),z=C.empty()?_.from()==_.head:C.from()==C.head;l<=i&&--i,t.splice(--l,2,new Pe(z?W:R,z?R:W))}}return new er(t,i)}function ti(e,t){return new er([new Pe(e,t||e)],0)}function ri(e){return e.text?le(e.from.line+e.text.length-1,Ee(e.text).length+(e.text.length==1?e.from.ch:0)):e.to}function Ps(e,t){if(O(e,t.from)<0)return e;if(O(e,t.to)<=0)return ri(t);var i=e.line+t.text.length-(t.to.line-t.from.line)-1,r=e.ch;return e.line==t.to.line&&(r+=ri(t).ch-t.to.ch),le(i,r)}function Ao(e,t){for(var i=[],r=0;r<e.sel.ranges.length;r++){var n=e.sel.ranges[r];i.push(new Pe(Ps(n.anchor,t),Ps(n.head,t)))}return pr(e.cm,i,e.sel.primIndex)}function Hs(e,t,i){return e.line==t.line?le(i.line,e.ch-t.ch+i.ch):le(i.line+(e.line-t.line),e.ch)}function tc(e,t,i){for(var r=[],n=le(e.first,0),l=n,_=0;_<t.length;_++){var C=t[_],A=Hs(C.from,n,l),R=Hs(ri(C),n,l);if(n=C.to,l=R,i=="around"){var W=e.sel.ranges[_],z=O(W.head,W.anchor)<0;r[_]=new Pe(z?R:A,z?A:R)}else r[_]=new Pe(A,A)}return new er(r,e.sel.primIndex)}function To(e){e.doc.mode=fr(e.options,e.doc.modeOption),pn(e)}function pn(e){e.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,hn(e,100),e.state.modeGen++,e.curOp&&It(e)}function Is(e,t){return t.from.ch==0&&t.to.ch==0&&Ee(t.text)==""&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Mo(e,t,i,r){function n(ye){return i?i[ye]:null}function l(ye,pe,me){zr(ye,pe,me,r),ot(ye,"change",ye,t)}function _(ye,pe){for(var me=[],Ae=ye;Ae<pe;++Ae)me.push(new Kt(R[Ae],n(Ae),r));return me}var C=t.from,A=t.to,R=t.text,W=Se(e,C.line),z=Se(e,A.line),J=Ee(R),X=n(R.length-1),ee=A.line-C.line;if(t.full)e.insert(0,_(0,R.length)),e.remove(R.length,e.size-R.length);else if(Is(e,t)){var ne=_(0,R.length-1);l(z,z.text,X),ee&&e.remove(C.line,ee),ne.length&&e.insert(C.line,ne)}else if(W==z)if(R.length==1)l(W,W.text.slice(0,C.ch)+J+W.text.slice(A.ch),X);else{var he=_(1,R.length-1);he.push(new Kt(J+W.text.slice(A.ch),X,r)),l(W,W.text.slice(0,C.ch)+R[0],n(0)),e.insert(C.line+1,he)}else if(R.length==1)l(W,W.text.slice(0,C.ch)+R[0]+z.text.slice(A.ch),n(0)),e.remove(C.line+1,ee);else{l(W,W.text.slice(0,C.ch)+R[0],n(0)),l(z,J+z.text.slice(A.ch),X);var de=_(1,R.length-1);ee>1&&e.remove(C.line+1,ee-1),e.insert(C.line+1,de)}ot(e,"change",e,t)}function ii(e,t,i){function r(n,l,_){if(n.linked)for(var C=0;C<n.linked.length;++C){var A=n.linked[C];if(A.doc!=l){var R=_&&A.sharedHist;i&&!R||(t(A.doc,R),r(A.doc,n,R))}}}r(e,null,!0)}function Fs(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,_o(e),To(e),Ws(e),e.options.direction=t.direction,e.options.lineWrapping||vi(e),e.options.mode=t.modeOption,It(e)}function Ws(e){(e.doc.direction=="rtl"?F:P)(e.display.lineDiv,"CodeMirror-rtl")}function rc(e){Gt(e,function(){Ws(e),It(e)})}function qn(e){this.done=[],this.undone=[],this.undoDepth=e?e.undoDepth:1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e?e.maxGeneration:1}function Ro(e,t){var i={from:ie(t.from),to:ri(t),text:Dt(e,t.from,t.to)};return Us(e,i,t.from.line,t.to.line+1),ii(e,function(r){return Us(r,i,t.from.line,t.to.line+1)},!0),i}function Ns(e){for(;e.length;){var t=Ee(e);if(t.ranges)e.pop();else break}}function ic(e,t){if(t)return Ns(e.done),Ee(e.done);if(e.done.length&&!Ee(e.done).ranges)return Ee(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),Ee(e.done)}function js(e,t,i,r){var n=e.history;n.undone.length=0;var l=+new Date,_,C;if((n.lastOp==r||n.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&n.lastModTime>l-(e.cm?e.cm.options.historyEventDelay:500)||t.origin.charAt(0)=="*"))&&(_=ic(n,n.lastOp==r)))C=Ee(_.changes),O(t.from,t.to)==0&&O(t.from,C.to)==0?C.to=ri(t):_.changes.push(Ro(e,t));else{var A=Ee(n.done);for((!A||!A.ranges)&&zn(e.sel,n.done),_={changes:[Ro(e,t)],generation:n.generation},n.done.push(_);n.done.length>n.undoDepth;)n.done.shift(),n.done[0].ranges||n.done.shift()}n.done.push(i),n.generation=++n.maxGeneration,n.lastModTime=n.lastSelTime=l,n.lastOp=n.lastSelOp=r,n.lastOrigin=n.lastSelOrigin=t.origin,C||Te(e,"historyAdded")}function nc(e,t,i,r){var n=t.charAt(0);return n=="*"||n=="+"&&i.ranges.length==r.ranges.length&&i.somethingSelected()==r.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function oc(e,t,i,r){var n=e.history,l=r&&r.origin;i==n.lastSelOp||l&&n.lastSelOrigin==l&&(n.lastModTime==n.lastSelTime&&n.lastOrigin==l||nc(e,l,Ee(n.done),t))?n.done[n.done.length-1]=t:zn(t,n.done),n.lastSelTime=+new Date,n.lastSelOrigin=l,n.lastSelOp=i,r&&r.clearRedo!==!1&&Ns(n.undone)}function zn(e,t){var i=Ee(t);i&&i.ranges&&i.equals(e)||t.push(e)}function Us(e,t,i,r){var n=t["spans_"+e.id],l=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,r),function(_){_.markedSpans&&((n||(n=t["spans_"+e.id]={}))[l]=_.markedSpans),++l})}function sc(e){if(!e)return null;for(var t,i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}function ac(e,t){var i=t["spans_"+e.id];if(!i)return null;for(var r=[],n=0;n<t.text.length;++n)r.push(sc(i[n]));return r}function qs(e,t){var i=ac(e,t),r=Ze(e,t);if(!i)return r;if(!r)return i;for(var n=0;n<i.length;++n){var l=i[n],_=r[n];if(l&&_){e:for(var C=0;C<_.length;++C){for(var A=_[C],R=0;R<l.length;++R)if(l[R].marker==A.marker)continue e;l.push(A)}}else _&&(i[n]=_)}return i}function zi(e,t,i){for(var r=[],n=0;n<e.length;++n){var l=e[n];if(l.ranges){r.push(i?er.prototype.deepCopy.call(l):l);continue}var _=l.changes,C=[];r.push({changes:C});for(var A=0;A<_.length;++A){var R=_[A],W=void 0;if(C.push({from:R.from,to:R.to,text:R.text}),t)for(var z in R)(W=z.match(/^spans_(\d+)$/))&&fe(t,Number(W[1]))>-1&&(Ee(C)[z]=R[z],delete R[z])}}return r}function Oo(e,t,i,r){if(r){var n=e.anchor;if(i){var l=O(t,n)<0;l!=O(i,n)<0?(n=t,t=i):l!=O(t,i)<0&&(t=i)}return new Pe(n,t)}else return new Pe(i||t,t)}function Kn(e,t,i,r,n){n==null&&(n=e.cm&&(e.cm.display.shift||e.extend)),Lt(e,new er([Oo(e.sel.primary(),t,i,n)],0),r)}function zs(e,t,i){for(var r=[],n=e.cm&&(e.cm.display.shift||e.extend),l=0;l<e.sel.ranges.length;l++)r[l]=Oo(e.sel.ranges[l],t[l],null,n);var _=pr(e.cm,r,e.sel.primIndex);Lt(e,_,i)}function Do(e,t,i,r){var n=e.sel.ranges.slice(0);n[t]=i,Lt(e,pr(e.cm,n,e.sel.primIndex),r)}function Ks(e,t,i,r){Lt(e,ti(t,i),r)}function lc(e,t,i){var r={ranges:t.ranges,update:function(n){this.ranges=[];for(var l=0;l<n.length;l++)this.ranges[l]=new Pe(ge(e,n[l].anchor),ge(e,n[l].head))},origin:i&&i.origin};return Te(e,"beforeSelectionChange",e,r),e.cm&&Te(e.cm,"beforeSelectionChange",e.cm,r),r.ranges!=t.ranges?pr(e.cm,r.ranges,r.ranges.length-1):t}function Gs(e,t,i){var r=e.history.done,n=Ee(r);n&&n.ranges?(r[r.length-1]=t,Gn(e,t,i)):Lt(e,t,i)}function Lt(e,t,i){Gn(e,t,i),oc(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function Gn(e,t,i){(Ke(e,"beforeSelectionChange")||e.cm&&Ke(e.cm,"beforeSelectionChange"))&&(t=lc(e,t,i));var r=i&&i.bias||(O(t.primary().head,e.sel.primary().head)<0?-1:1);Xs(e,Zs(e,t,r,!0)),!(i&&i.scroll===!1)&&e.cm&&e.cm.getOption("readOnly")!="nocursor"&&Ui(e.cm)}function Xs(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,lr(e.cm)),ot(e,"cursorActivity",e))}function Ys(e){Xs(e,Zs(e,e.sel,null,!1))}function Zs(e,t,i,r){for(var n,l=0;l<t.ranges.length;l++){var _=t.ranges[l],C=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[l],A=Xn(e,_.anchor,C&&C.anchor,i,r),R=Xn(e,_.head,C&&C.head,i,r);(n||A!=_.anchor||R!=_.head)&&(n||(n=t.ranges.slice(0,l)),n[l]=new Pe(A,R))}return n?pr(e.cm,n,t.primIndex):t}function Ki(e,t,i,r,n){var l=Se(e,t.line);if(l.markedSpans)for(var _=0;_<l.markedSpans.length;++_){var C=l.markedSpans[_],A=C.marker,R="selectLeft"in A?!A.selectLeft:A.inclusiveLeft,W="selectRight"in A?!A.selectRight:A.inclusiveRight;if((C.from==null||(R?C.from<=t.ch:C.from<t.ch))&&(C.to==null||(W?C.to>=t.ch:C.to>t.ch))){if(n&&(Te(A,"beforeCursorEnter"),A.explicitlyCleared))if(l.markedSpans){--_;continue}else break;if(!A.atomic)continue;if(i){var z=A.find(r<0?1:-1),J=void 0;if((r<0?W:R)&&(z=Vs(e,z,-r,z&&z.line==t.line?l:null)),z&&z.line==t.line&&(J=O(z,i))&&(r<0?J<0:J>0))return Ki(e,z,t,r,n)}var X=A.find(r<0?-1:1);return(r<0?R:W)&&(X=Vs(e,X,r,X.line==t.line?l:null)),X?Ki(e,X,t,r,n):null}}return t}function Xn(e,t,i,r,n){var l=r||1,_=Ki(e,t,i,l,n)||!n&&Ki(e,t,i,l,!0)||Ki(e,t,i,-l,n)||!n&&Ki(e,t,i,-l,!0);return _||(e.cantEdit=!0,le(e.first,0))}function Vs(e,t,i,r){return i<0&&t.ch==0?t.line>e.first?ge(e,le(t.line-1)):null:i>0&&t.ch==(r||Se(e,t.line)).text.length?t.line<e.first+e.size-1?le(t.line+1,0):null:new le(t.line,t.ch+i)}function Js(e){e.setSelection(le(e.firstLine(),0),le(e.lastLine()),U)}function $s(e,t,i){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return r.canceled=!0}};return i&&(r.update=function(n,l,_,C){n&&(r.from=ge(e,n)),l&&(r.to=ge(e,l)),_&&(r.text=_),C!==void 0&&(r.origin=C)}),Te(e,"beforeChange",e,r),e.cm&&Te(e.cm,"beforeChange",e.cm,r),r.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:r.from,to:r.to,text:r.text,origin:r.origin}}function Gi(e,t,i){if(e.cm){if(!e.cm.curOp)return st(e.cm,Gi)(e,t,i);if(e.cm.state.suppressEdits)return}if(!((Ke(e,"beforeChange")||e.cm&&Ke(e.cm,"beforeChange"))&&(t=$s(e,t,!0),!t))){var r=Mn&&!i&&or(e,t.from,t.to);if(r)for(var n=r.length-1;n>=0;--n)Qs(e,{from:r[n].from,to:r[n].to,text:n?[""]:t.text,origin:t.origin});else Qs(e,t)}}function Qs(e,t){if(!(t.text.length==1&&t.text[0]==""&&O(t.from,t.to)==0)){var i=Ao(e,t);js(e,t,i,e.cm?e.cm.curOp.id:NaN),vn(e,t,i,Ze(e,t));var r=[];ii(e,function(n,l){!l&&fe(r,n.history)==-1&&(ia(n.history,t),r.push(n.history)),vn(n,t,null,Ze(n,t))})}}function Yn(e,t,i){var r=e.cm&&e.cm.state.suppressEdits;if(!(r&&!i)){for(var n=e.history,l,_=e.sel,C=t=="undo"?n.done:n.undone,A=t=="undo"?n.undone:n.done,R=0;R<C.length&&(l=C[R],!(i?l.ranges&&!l.equals(e.sel):!l.ranges));R++);if(R!=C.length){for(n.lastOrigin=n.lastSelOrigin=null;;)if(l=C.pop(),l.ranges){if(zn(l,A),i&&!l.equals(e.sel)){Lt(e,l,{clearRedo:!1});return}_=l}else if(r){C.push(l);return}else break;var W=[];zn(_,A),A.push({changes:W,generation:n.generation}),n.generation=l.generation||++n.maxGeneration;for(var z=Ke(e,"beforeChange")||e.cm&&Ke(e.cm,"beforeChange"),J=function(ne){var he=l.changes[ne];if(he.origin=t,z&&!$s(e,he,!1))return C.length=0,{};W.push(Ro(e,he));var de=ne?Ao(e,he):Ee(C);vn(e,he,de,qs(e,he)),!ne&&e.cm&&e.cm.scrollIntoView({from:he.from,to:ri(he)});var ye=[];ii(e,function(pe,me){!me&&fe(ye,pe.history)==-1&&(ia(pe.history,he),ye.push(pe.history)),vn(pe,he,null,qs(pe,he))})},X=l.changes.length-1;X>=0;--X){var ee=J(X);if(ee)return ee.v}}}}function ea(e,t){if(t!=0&&(e.first+=t,e.sel=new er(Ie(e.sel.ranges,function(n){return new Pe(le(n.anchor.line+t,n.anchor.ch),le(n.head.line+t,n.head.ch))}),e.sel.primIndex),e.cm)){It(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,r=i.viewFrom;r<i.viewTo;r++)Qr(e.cm,r,"gutter")}}function vn(e,t,i,r){if(e.cm&&!e.cm.curOp)return st(e.cm,vn)(e,t,i,r);if(t.to.line<e.first){ea(e,t.text.length-1-(t.to.line-t.from.line));return}if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var n=t.text.length-1-(e.first-t.from.line);ea(e,n),t={from:le(e.first,0),to:le(t.to.line+n,t.to.ch),text:[Ee(t.text)],origin:t.origin}}var l=e.lastLine();t.to.line>l&&(t={from:t.from,to:le(l,Se(e,l).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Dt(e,t.from,t.to),i||(i=Ao(e,t)),e.cm?cc(e.cm,t,r):Mo(e,t,r),Gn(e,i,U),e.cantEdit&&Xn(e,le(e.firstLine(),0))&&(e.cantEdit=!1)}}function cc(e,t,i){var r=e.doc,n=e.display,l=t.from,_=t.to,C=!1,A=l.line;e.options.lineWrapping||(A=De(rt(Se(r,l.line))),r.iter(A,_.line+1,function(X){if(X==n.maxLine)return C=!0,!0})),r.sel.contains(t.from,t.to)>-1&&lr(e),Mo(r,t,i,ms(e)),e.options.lineWrapping||(r.iter(A,l.line+t.text.length,function(X){var ee=$r(X);ee>n.maxLineLength&&(n.maxLine=X,n.maxLineLength=ee,n.maxLineChanged=!0,C=!1)}),C&&(e.curOp.updateMaxLine=!0)),Tn(r,l.line),hn(e,400);var R=t.text.length-(_.line-l.line)-1;t.full?It(e):l.line==_.line&&t.text.length==1&&!Is(e.doc,t)?Qr(e,l.line,"text"):It(e,l.line,_.line+1,R);var W=Ke(e,"changes"),z=Ke(e,"change");if(z||W){var J={from:l,to:_,text:t.text,removed:t.removed,origin:t.origin};z&&ot(e,"change",e,J),W&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(J)}e.display.selForContextMenu=null}function Xi(e,t,i,r,n){var l;r||(r=i),O(r,i)<0&&(l=[r,i],i=l[0],r=l[1]),typeof t=="string"&&(t=e.splitLines(t)),Gi(e,{from:i,to:r,text:t,origin:n})}function ta(e,t,i,r){i<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function ra(e,t,i,r){for(var n=0;n<e.length;++n){var l=e[n],_=!0;if(l.ranges){l.copied||(l=e[n]=l.deepCopy(),l.copied=!0);for(var C=0;C<l.ranges.length;C++)ta(l.ranges[C].anchor,t,i,r),ta(l.ranges[C].head,t,i,r);continue}for(var A=0;A<l.changes.length;++A){var R=l.changes[A];if(i<R.from.line)R.from=le(R.from.line+r,R.from.ch),R.to=le(R.to.line+r,R.to.ch);else if(t<=R.to.line){_=!1;break}}_||(e.splice(0,n+1),n=0)}}function ia(e,t){var i=t.from.line,r=t.to.line,n=t.text.length-(r-i)-1;ra(e.done,i,r,n),ra(e.undone,i,r,n)}function _n(e,t,i,r){var n=t,l=t;return typeof t=="number"?l=Se(e,Oe(e,t)):n=De(t),n==null?null:(r(l,n)&&e.cm&&Qr(e.cm,n,i),l)}function gn(e){this.lines=e,this.parent=null;for(var t=0,i=0;i<e.length;++i)e[i].parent=this,t+=e[i].height;this.height=t}gn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i=e,r=e+t;i<r;++i){var n=this.lines[i];this.height-=n.height,no(n),ot(n,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0;r<t.length;++r)t[r].parent=this},iterN:function(e,t,i){for(var r=e+t;e<r;++e)if(i(this.lines[e]))return!0}};function yn(e){this.children=e;for(var t=0,i=0,r=0;r<e.length;++r){var n=e[r];t+=n.chunkSize(),i+=n.height,n.parent=this}this.size=t,this.height=i,this.parent=null}yn.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var r=this.children[i],n=r.chunkSize();if(e<n){var l=Math.min(t,n-e),_=r.height;if(r.removeInner(e,l),this.height-=_-r.height,n==l&&(this.children.splice(i--,1),r.parent=null),(t-=l)==0)break;e=0}else e-=n}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof gn))){var C=[];this.collapse(C),this.children=[new gn(C)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){this.size+=t.length,this.height+=i;for(var r=0;r<this.children.length;++r){var n=this.children[r],l=n.chunkSize();if(e<=l){if(n.insertInner(e,t,i),n.lines&&n.lines.length>50){for(var _=n.lines.length%25+25,C=_;C<n.lines.length;){var A=new gn(n.lines.slice(C,C+=25));n.height-=A.height,this.children.splice(++r,0,A),A.parent=this}n.lines=n.lines.slice(0,_),this.maybeSpill()}break}e-=l}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),i=new yn(t);if(e.parent){e.size-=i.size,e.height-=i.height;var n=fe(e.parent.children,e);e.parent.children.splice(n+1,0,i)}else{var r=new yn(e.children);r.parent=e,e.children=[r,i],e=r}i.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var r=0;r<this.children.length;++r){var n=this.children[r],l=n.chunkSize();if(e<l){var _=Math.min(t,l-e);if(n.iterN(e,_,i))return!0;if((t-=_)==0)break;e=0}else e-=l}}};var mn=function(e,t,i){if(i)for(var r in i)i.hasOwnProperty(r)&&(this[r]=i[r]);this.doc=e,this.node=t};mn.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,i=this.line,r=De(i);if(!(r==null||!t)){for(var n=0;n<t.length;++n)t[n]==this&&t.splice(n--,1);t.length||(i.widgets=null);var l=on(this);nt(i,Math.max(0,i.height-l)),e&&(Gt(e,function(){na(e,i,-l),Qr(e,r,"widget")}),ot(e,"lineWidgetCleared",e,this,r))}},mn.prototype.changed=function(){var e=this,t=this.height,i=this.doc.cm,r=this.line;this.height=null;var n=on(this)-t;!n||(Ct(this.doc,r)||nt(r,r.height+n),i&&Gt(i,function(){i.curOp.forceUpdate=!0,na(i,r,n),ot(i,"lineWidgetChanged",i,e,De(r))}))},Rt(mn);function na(e,t,i){wt(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Co(e,i)}function uc(e,t,i,r){var n=new mn(e,i,r),l=e.cm;return l&&n.noHScroll&&(l.display.alignWidgets=!0),_n(e,t,"widget",function(_){var C=_.widgets||(_.widgets=[]);if(n.insertAt==null?C.push(n):C.splice(Math.min(C.length,Math.max(0,n.insertAt)),0,n),n.line=_,l&&!Ct(e,_)){var A=wt(_)<e.scrollTop;nt(_,_.height+on(n)),A&&Co(l,n.height),l.curOp.forceUpdate=!0}return!0}),l&&ot(l,"lineWidgetAdded",l,n,typeof t=="number"?t:De(t)),n}var oa=0,ni=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++oa};ni.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Ci(e),Ke(this,"clear")){var i=this.find();i&&ot(this,"clear",i.from,i.to)}for(var r=null,n=null,l=0;l<this.lines.length;++l){var _=this.lines[l],C=re(_.markedSpans,this);e&&!this.collapsed?Qr(e,De(_),"text"):e&&(C.to!=null&&(n=De(_)),C.from!=null&&(r=De(_))),_.markedSpans=te(_.markedSpans,C),C.from==null&&this.collapsed&&!Ct(this.doc,_)&&e&&nt(_,Wi(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var A=0;A<this.lines.length;++A){var R=rt(this.lines[A]),W=$r(R);W>e.display.maxLineLength&&(e.display.maxLine=R,e.display.maxLineLength=W,e.display.maxLineChanged=!0)}r!=null&&e&&this.collapsed&&It(e,r,n+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Ys(e.doc)),e&&ot(e,"markerCleared",e,this,r,n),t&&wi(e),this.parent&&this.parent.clear()}},ni.prototype.find=function(e,t){e==null&&this.type=="bookmark"&&(e=1);for(var i,r,n=0;n<this.lines.length;++n){var l=this.lines[n],_=re(l.markedSpans,this);if(_.from!=null&&(i=le(t?l:De(l),_.from),e==-1))return i;if(_.to!=null&&(r=le(t?l:De(l),_.to),e==1))return r}return i&&{from:i,to:r}},ni.prototype.changed=function(){var e=this,t=this.find(-1,!0),i=this,r=this.doc.cm;!t||!r||Gt(r,function(){var n=t.line,l=De(t.line),_=lo(r,l);if(_&&(fs(_),r.curOp.selectionChanged=r.curOp.forceUpdate=!0),r.curOp.updateMaxLine=!0,!Ct(i.doc,n)&&i.height!=null){var C=i.height;i.height=null;var A=on(i)-C;A&&nt(n,n.height+A)}ot(r,"markerChanged",r,e)})},ni.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||fe(t.maybeHiddenMarkers,this)==-1)&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ni.prototype.detachLine=function(e){if(this.lines.splice(fe(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},Rt(ni);function Yi(e,t,i,r,n){if(r&&r.shared)return fc(e,t,i,r,n);if(e.cm&&!e.cm.curOp)return st(e.cm,Yi)(e,t,i,r,n);var l=new ni(e,n),_=O(t,i);if(r&&ae(r,l,!1),_>0||_==0&&l.clearWhenEmpty!==!1)return l;if(l.replacedWith&&(l.collapsed=!0,l.widgetNode=E("span",[l.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||l.widgetNode.setAttribute("cm-ignore-events","true"),r.insertLeft&&(l.widgetNode.insertLeft=!0)),l.collapsed){if(Ge(e,t.line,t,i,l)||t.line!=i.line&&Ge(e,i.line,t,i,l))throw new Error("Inserting collapsed marker partially overlapping an existing one");io()}l.addToHistory&&js(e,{from:t,to:i,origin:"markText"},e.sel,NaN);var C=t.line,A=e.cm,R;if(e.iter(C,i.line+1,function(z){A&&l.collapsed&&!A.options.lineWrapping&&rt(z)==A.display.maxLine&&(R=!0),l.collapsed&&C!=t.line&&nt(z,0),nr(z,new Hi(l,C==t.line?t.ch:null,C==i.line?i.ch:null),e.cm&&e.cm.curOp),++C}),l.collapsed&&e.iter(t.line,i.line+1,function(z){Ct(e,z)&&nt(z,0)}),l.clearOnEnter&&ke(l,"beforeCursorEnter",function(){return l.clear()}),l.readOnly&&(Rn(),(e.history.done.length||e.history.undone.length)&&e.clearHistory()),l.collapsed&&(l.id=++oa,l.atomic=!0),A){if(R&&(A.curOp.updateMaxLine=!0),l.collapsed)It(A,t.line,i.line+1);else if(l.className||l.startStyle||l.endStyle||l.css||l.attributes||l.title)for(var W=t.line;W<=i.line;W++)Qr(A,W,"text");l.atomic&&Ys(A.doc),ot(A,"markerAdded",A,l)}return l}var bn=function(e,t){this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=this};bn.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();ot(this,"clear")}},bn.prototype.find=function(e,t){return this.primary.find(e,t)},Rt(bn);function fc(e,t,i,r,n){r=ae(r),r.shared=!1;var l=[Yi(e,t,i,r,n)],_=l[0],C=r.widgetNode;return ii(e,function(A){C&&(r.widgetNode=C.cloneNode(!0)),l.push(Yi(A,ge(A,t),ge(A,i),r,n));for(var R=0;R<A.linked.length;++R)if(A.linked[R].isParent)return;_=Ee(l)}),new bn(l,_)}function sa(e){return e.findMarks(le(e.first,0),e.clipPos(le(e.lastLine())),function(t){return t.parent})}function hc(e,t){for(var i=0;i<t.length;i++){var r=t[i],n=r.find(),l=e.clipPos(n.from),_=e.clipPos(n.to);if(O(l,_)){var C=Yi(e,l,_,r.primary,r.primary.type);r.markers.push(C),C.parent=r}}}function dc(e){for(var t=function(r){var n=e[r],l=[n.primary.doc];ii(n.primary.doc,function(A){return l.push(A)});for(var _=0;_<n.markers.length;_++){var C=n.markers[_];fe(l,C.doc)==-1&&(C.parent=null,n.markers.splice(_--,1))}},i=0;i<e.length;i++)t(i)}var pc=0,Ft=function(e,t,i,r,n){if(!(this instanceof Ft))return new Ft(e,t,i,r,n);i==null&&(i=0),yn.call(this,[new gn([new Kt("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=i;var l=le(i,0);this.sel=ti(l),this.history=new qn(null),this.id=++pc,this.modeOption=t,this.lineSep=r,this.direction=n=="rtl"?"rtl":"ltr",this.extend=!1,typeof e=="string"&&(e=this.splitLines(e)),Mo(this,{from:l,to:l,text:e}),Lt(this,ti(l),U)};Ft.prototype=_t(yn.prototype,{constructor:Ft,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,r=0;r<t.length;++r)i+=t[r].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=wr(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:at(function(e){var t=le(this.first,0),i=this.first+this.size-1;Gi(this,{from:t,to:le(i,Se(this,i).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&ln(this.cm,0,0),Lt(this,ti(t),U)}),replaceRange:function(e,t,i,r){t=ge(this,t),i=i?ge(this,i):t,Xi(this,e,t,i,r)},getRange:function(e,t,i){var r=Dt(this,ge(this,e),ge(this,t));return i===!1?r:i===""?r.join(""):r.join(i||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(rr(this,e))return Se(this,e)},getLineNumber:function(e){return De(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=Se(this,e)),rt(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return ge(this,e)},getCursor:function(e){var t=this.sel.primary(),i;return e==null||e=="head"?i=t.head:e=="anchor"?i=t.anchor:e=="end"||e=="to"||e===!1?i=t.to():i=t.from(),i},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:at(function(e,t,i){Ks(this,ge(this,typeof e=="number"?le(e,t||0):e),null,i)}),setSelection:at(function(e,t,i){Ks(this,ge(this,e),ge(this,t||e),i)}),extendSelection:at(function(e,t,i){Kn(this,ge(this,e),t&&ge(this,t),i)}),extendSelections:at(function(e,t){zs(this,mt(this,e),t)}),extendSelectionsBy:at(function(e,t){var i=Ie(this.sel.ranges,e);zs(this,mt(this,i),t)}),setSelections:at(function(e,t,i){if(!!e.length){for(var r=[],n=0;n<e.length;n++)r[n]=new Pe(ge(this,e[n].anchor),ge(this,e[n].head||e[n].anchor));t==null&&(t=Math.min(e.length-1,this.sel.primIndex)),Lt(this,pr(this.cm,r,t),i)}}),addSelection:at(function(e,t,i){var r=this.sel.ranges.slice(0);r.push(new Pe(ge(this,e),ge(this,t||e))),Lt(this,pr(this.cm,r,r.length-1),i)}),getSelection:function(e){for(var t=this.sel.ranges,i,r=0;r<t.length;r++){var n=Dt(this,t[r].from(),t[r].to());i=i?i.concat(n):n}return e===!1?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],i=this.sel.ranges,r=0;r<i.length;r++){var n=Dt(this,i[r].from(),i[r].to());e!==!1&&(n=n.join(e||this.lineSeparator())),t[r]=n}return t},replaceSelection:function(e,t,i){for(var r=[],n=0;n<this.sel.ranges.length;n++)r[n]=e;this.replaceSelections(r,t,i||"+input")},replaceSelections:at(function(e,t,i){for(var r=[],n=this.sel,l=0;l<n.ranges.length;l++){var _=n.ranges[l];r[l]={from:_.from(),to:_.to(),text:this.splitLines(e[l]),origin:i}}for(var C=t&&t!="end"&&tc(this,r,t),A=r.length-1;A>=0;A--)Gi(this,r[A]);C?Gs(this,C):this.cm&&Ui(this.cm)}),undo:at(function(){Yn(this,"undo")}),redo:at(function(){Yn(this,"redo")}),undoSelection:at(function(){Yn(this,"undo",!0)}),redoSelection:at(function(){Yn(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,i=0,r=0;r<e.done.length;r++)e.done[r].ranges||++t;for(var n=0;n<e.undone.length;n++)e.undone[n].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){var e=this;this.history=new qn(this.history),ii(this,function(t){return t.history=e.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:zi(this.history.done),undone:zi(this.history.undone)}},setHistory:function(e){var t=this.history=new qn(this.history);t.done=zi(e.done.slice(0),null,!0),t.undone=zi(e.undone.slice(0),null,!0)},setGutterMarker:at(function(e,t,i){return _n(this,e,"gutter",function(r){var n=r.gutterMarkers||(r.gutterMarkers={});return n[t]=i,!i&&Zr(n)&&(r.gutterMarkers=null),!0})}),clearGutter:at(function(e){var t=this;this.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&_n(t,i,"gutter",function(){return i.gutterMarkers[e]=null,Zr(i.gutterMarkers)&&(i.gutterMarkers=null),!0})})}),lineInfo:function(e){var t;if(typeof e=="number"){if(!rr(this,e)||(t=e,e=Se(this,e),!e))return null}else if(t=De(e),t==null)return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:at(function(e,t,i){return _n(this,e,t=="gutter"?"gutter":"class",function(r){var n=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass";if(!r[n])r[n]=i;else{if(H(i).test(r[n]))return!1;r[n]+=" "+i}return!0})}),removeLineClass:at(function(e,t,i){return _n(this,e,t=="gutter"?"gutter":"class",function(r){var n=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass",l=r[n];if(l)if(i==null)r[n]=null;else{var _=l.match(H(i));if(!_)return!1;var C=_.index+_[0].length;r[n]=l.slice(0,_.index)+(!_.index||C==l.length?"":" ")+l.slice(C)||null}else return!1;return!0})}),addLineWidget:at(function(e,t,i){return uc(this,e,t,i)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return Yi(this,ge(this,e),ge(this,t),i,i&&i.type||"range")},setBookmark:function(e,t){var i={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=ge(this,e),Yi(this,e,e,i,"bookmark")},findMarksAt:function(e){e=ge(this,e);var t=[],i=Se(this,e.line).markedSpans;if(i)for(var r=0;r<i.length;++r){var n=i[r];(n.from==null||n.from<=e.ch)&&(n.to==null||n.to>=e.ch)&&t.push(n.marker.parent||n.marker)}return t},findMarks:function(e,t,i){e=ge(this,e),t=ge(this,t);var r=[],n=e.line;return this.iter(e.line,t.line+1,function(l){var _=l.markedSpans;if(_)for(var C=0;C<_.length;C++){var A=_[C];!(A.to!=null&&n==e.line&&e.ch>=A.to||A.from==null&&n!=e.line||A.from!=null&&n==t.line&&A.from>=t.ch)&&(!i||i(A.marker))&&r.push(A.marker.parent||A.marker)}++n}),r},getAllMarks:function(){var e=[];return this.iter(function(t){var i=t.markedSpans;if(i)for(var r=0;r<i.length;++r)i[r].from!=null&&e.push(i[r].marker)}),e},posFromIndex:function(e){var t,i=this.first,r=this.lineSeparator().length;return this.iter(function(n){var l=n.text.length+r;if(l>e)return t=e,!0;e-=l,++i}),ge(this,le(i,t))},indexFromPos:function(e){e=ge(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var i=this.lineSeparator().length;return this.iter(this.first,e.line,function(r){t+=r.text.length+i}),t},copy:function(e){var t=new Ft(wr(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,i=this.first+this.size;e.from!=null&&e.from>t&&(t=e.from),e.to!=null&&e.to<i&&(i=e.to);var r=new Ft(wr(this,t,i),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],hc(r,sa(this)),r},unlinkDoc:function(e){if(e instanceof Ue&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){var i=this.linked[t];if(i.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),dc(sa(this));break}}if(e.history==this.history){var r=[e.id];ii(e,function(n){return r.push(n.id)},!0),e.history=new qn(null),e.history.done=zi(this.history.done,r),e.history.undone=zi(this.history.undone,r)}},iterLinkedDocs:function(e){ii(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):mr(e)},lineSeparator:function(){return this.lineSep||`
`},setDirection:at(function(e){e!="rtl"&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(t){return t.order=null}),this.cm&&rc(this.cm))})}),Ft.prototype.eachLine=Ft.prototype.iter;var aa=0;function vc(e){var t=this;if(la(t),!(je(t,e)||Kr(t.display,e))){Ye(e),k&&(aa=+new Date);var i=yi(t,e,!0),r=e.dataTransfer.files;if(!(!i||t.isReadOnly()))if(r&&r.length&&window.FileReader&&window.File)for(var n=r.length,l=Array(n),_=0,C=function(){++_==n&&st(t,function(){i=ge(t.doc,i);var X={from:i,to:i,text:t.doc.splitLines(l.filter(function(ee){return ee!=null}).join(t.doc.lineSeparator())),origin:"paste"};Gi(t.doc,X),Gs(t.doc,ti(ge(t.doc,i),ge(t.doc,ri(X))))})()},A=function(X,ee){if(t.options.allowDropFileTypes&&fe(t.options.allowDropFileTypes,X.type)==-1){C();return}var ne=new FileReader;ne.onerror=function(){return C()},ne.onload=function(){var he=ne.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(he)){C();return}l[ee]=he,C()},ne.readAsText(X)},R=0;R<r.length;R++)A(r[R],R);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1){t.state.draggingText(e),setTimeout(function(){return t.display.input.focus()},20);return}try{var W=e.dataTransfer.getData("Text");if(W){var z;if(t.state.draggingText&&!t.state.draggingText.copy&&(z=t.listSelections()),Gn(t.doc,ti(i,i)),z)for(var J=0;J<z.length;++J)Xi(t.doc,"",z[J].anchor,z[J].head,"drag");t.replaceSelection(W,"around","paste"),t.display.input.focus()}}catch{}}}}function _c(e,t){if(k&&(!e.state.draggingText||+new Date-aa<100)){tr(t);return}if(!(je(e,t)||Kr(e.display,t))&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!S)){var i=D("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",b&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),b&&i.parentNode.removeChild(i)}}function gc(e,t){var i=yi(e,t);if(!!i){var r=document.createDocumentFragment();go(e,i,r),e.display.dragCursor||(e.display.dragCursor=D("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),L(e.display.dragCursor,r)}}function la(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function ca(e){if(!!document.getElementsByClassName){for(var t=document.getElementsByClassName("CodeMirror"),i=[],r=0;r<t.length;r++){var n=t[r].CodeMirror;n&&i.push(n)}i.length&&i[0].operation(function(){for(var l=0;l<i.length;l++)e(i[l])})}}var ua=!1;function yc(){ua||(mc(),ua=!0)}function mc(){var e;ke(window,"resize",function(){e==null&&(e=setTimeout(function(){e=null,ca(bc)},100))}),ke(window,"blur",function(){return ca(ji)})}function bc(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var oi={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Sn=0;Sn<10;Sn++)oi[Sn+48]=oi[Sn+96]=String(Sn);for(var Zn=65;Zn<=90;Zn++)oi[Zn]=String.fromCharCode(Zn);for(var Cn=1;Cn<=12;Cn++)oi[Cn+111]=oi[Cn+63235]="F"+Cn;var Xr={};Xr.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Xr.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Xr.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Xr.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Xr.default=o?Xr.macDefault:Xr.pcDefault;function Sc(e){var t=e.split(/-(?!$)/);e=t[t.length-1];for(var i,r,n,l,_=0;_<t.length-1;_++){var C=t[_];if(/^(cmd|meta|m)$/i.test(C))l=!0;else if(/^a(lt)?$/i.test(C))i=!0;else if(/^(c|ctrl|control)$/i.test(C))r=!0;else if(/^s(hift)?$/i.test(C))n=!0;else throw new Error("Unrecognized modifier name: "+C)}return i&&(e="Alt-"+e),r&&(e="Ctrl-"+e),l&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function Cc(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if(r=="..."){delete e[i];continue}for(var n=Ie(i.split(" "),Sc),l=0;l<n.length;l++){var _=void 0,C=void 0;l==n.length-1?(C=n.join(" "),_=r):(C=n.slice(0,l+1).join(" "),_="...");var A=t[C];if(!A)t[C]=_;else if(A!=_)throw new Error("Inconsistent bindings for "+C)}delete e[i]}for(var R in t)e[R]=t[R];return e}function Zi(e,t,i,r){t=Vn(t);var n=t.call?t.call(e,r):t[e];if(n===!1)return"nothing";if(n==="...")return"multi";if(n!=null&&i(n))return"handled";if(t.fallthrough){if(Object.prototype.toString.call(t.fallthrough)!="[object Array]")return Zi(e,t.fallthrough,i,r);for(var l=0;l<t.fallthrough.length;l++){var _=Zi(e,t.fallthrough[l],i,r);if(_)return _}}}function fa(e){var t=typeof e=="string"?e:oi[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"}function ha(e,t,i){var r=e;return t.altKey&&r!="Alt"&&(e="Alt-"+e),(x?t.metaKey:t.ctrlKey)&&r!="Ctrl"&&(e="Ctrl-"+e),(x?t.ctrlKey:t.metaKey)&&r!="Mod"&&(e="Cmd-"+e),!i&&t.shiftKey&&r!="Shift"&&(e="Shift-"+e),e}function da(e,t){if(b&&e.keyCode==34&&e.char)return!1;var i=oi[e.keyCode];return i==null||e.altGraphKey?!1:(e.keyCode==3&&e.code&&(i=e.code),ha(i,e,t))}function Vn(e){return typeof e=="string"?Xr[e]:e}function Vi(e,t){for(var i=e.doc.sel.ranges,r=[],n=0;n<i.length;n++){for(var l=t(i[n]);r.length&&O(l.from,Ee(r).to)<=0;){var _=r.pop();if(O(_.from,l.from)<0){l.from=_.from;break}}r.push(l)}Gt(e,function(){for(var C=r.length-1;C>=0;C--)Xi(e.doc,"",r[C].from,r[C].to,"+delete");Ui(e)})}function Bo(e,t,i){var r=Vr(e.text,t+i,i);return r<0||r>e.text.length?null:r}function Po(e,t,i){var r=Bo(e,t.ch,i);return r==null?null:new le(t.line,r,i<0?"after":"before")}function Ho(e,t,i,r,n){if(e){t.doc.direction=="rtl"&&(n=-n);var l=ut(i,t.doc.direction);if(l){var _=n<0?Ee(l):l[0],C=n<0==(_.level==1),A=C?"after":"before",R;if(_.level>0||t.doc.direction=="rtl"){var W=Fi(t,i);R=n<0?i.text.length-1:0;var z=Tr(t,W,R).top;R=Ut(function(J){return Tr(t,W,J).top==z},n<0==(_.level==1)?_.from:_.to-1,R),A=="before"&&(R=Bo(i,R,1))}else R=n<0?_.to:_.from;return new le(r,R,A)}}return new le(r,n<0?i.text.length:0,n<0?"before":"after")}function wc(e,t,i,r){var n=ut(t,e.doc.direction);if(!n)return Po(t,i,r);i.ch>=t.text.length?(i.ch=t.text.length,i.sticky="before"):i.ch<=0&&(i.ch=0,i.sticky="after");var l=Ne(n,i.ch,i.sticky),_=n[l];if(e.doc.direction=="ltr"&&_.level%2==0&&(r>0?_.to>i.ch:_.from<i.ch))return Po(t,i,r);var C=function(de,ye){return Bo(t,de instanceof le?de.ch:de,ye)},A,R=function(de){return e.options.lineWrapping?(A=A||Fi(e,t),ys(e,t,A,de)):{begin:0,end:t.text.length}},W=R(i.sticky=="before"?C(i,-1):i.ch);if(e.doc.direction=="rtl"||_.level==1){var z=_.level==1==r<0,J=C(i,z?1:-1);if(J!=null&&(z?J<=_.to&&J<=W.end:J>=_.from&&J>=W.begin)){var X=z?"before":"after";return new le(i.line,J,X)}}var ee=function(de,ye,pe){for(var me=function(We,lt){return lt?new le(i.line,C(We,1),"before"):new le(i.line,We,"after")};de>=0&&de<n.length;de+=ye){var Ae=n[de],xe=ye>0==(Ae.level!=1),Re=xe?pe.begin:C(pe.end,-1);if(Ae.from<=Re&&Re<Ae.to||(Re=xe?Ae.from:C(Ae.to,-1),pe.begin<=Re&&Re<pe.end))return me(Re,xe)}},ne=ee(l+r,r,W);if(ne)return ne;var he=r>0?W.end:C(W.begin,-1);return he!=null&&!(r>0&&he==t.text.length)&&(ne=ee(r>0?0:n.length-1,r,R(he)),ne)?ne:null}var wn={selectAll:Js,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),U)},killLine:function(e){return Vi(e,function(t){if(t.empty()){var i=Se(e.doc,t.head.line).text.length;return t.head.ch==i&&t.head.line<e.lastLine()?{from:t.head,to:le(t.head.line+1,0)}:{from:t.head,to:le(t.head.line,i)}}else return{from:t.from(),to:t.to()}})},deleteLine:function(e){return Vi(e,function(t){return{from:le(t.from().line,0),to:ge(e.doc,le(t.to().line+1,0))}})},delLineLeft:function(e){return Vi(e,function(t){return{from:le(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(e){return Vi(e,function(t){var i=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:i},"div");return{from:r,to:t.from()}})},delWrappedLineRight:function(e){return Vi(e,function(t){var i=e.charCoords(t.head,"div").top+5,r=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:r}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(le(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(le(e.lastLine()))},goLineStart:function(e){return e.extendSelectionsBy(function(t){return pa(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){return e.extendSelectionsBy(function(t){return va(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){return e.extendSelectionsBy(function(t){return Lc(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){return e.extendSelectionsBy(function(t){var i=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},G)},goLineLeft:function(e){return e.extendSelectionsBy(function(t){var i=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},G)},goLineLeftSmart:function(e){return e.extendSelectionsBy(function(t){var i=e.cursorCoords(t.head,"div").top+5,r=e.coordsChar({left:0,top:i},"div");return r.ch<e.getLine(r.line).search(/\S/)?va(e,t.head):r},G)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"codepoint")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],i=e.listSelections(),r=e.options.tabSize,n=0;n<i.length;n++){var l=i[n].from(),_=Ce(e.getLine(l.line),l.ch,r);t.push(Be(r-_%r))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){return Gt(e,function(){for(var t=e.listSelections(),i=[],r=0;r<t.length;r++)if(!!t[r].empty()){var n=t[r].head,l=Se(e.doc,n.line).text;if(l){if(n.ch==l.length&&(n=new le(n.line,n.ch-1)),n.ch>0)n=new le(n.line,n.ch+1),e.replaceRange(l.charAt(n.ch-1)+l.charAt(n.ch-2),le(n.line,n.ch-2),n,"+transpose");else if(n.line>e.doc.first){var _=Se(e.doc,n.line-1).text;_&&(n=new le(n.line,1),e.replaceRange(l.charAt(0)+e.doc.lineSeparator()+_.charAt(_.length-1),le(n.line-1,_.length-1),n,"+transpose"))}}i.push(new Pe(n,n))}e.setSelections(i)})},newlineAndIndent:function(e){return Gt(e,function(){for(var t=e.listSelections(),i=t.length-1;i>=0;i--)e.replaceRange(e.doc.lineSeparator(),t[i].anchor,t[i].head,"+input");t=e.listSelections();for(var r=0;r<t.length;r++)e.indentLine(t[r].from().line,null,!0);Ui(e)})},openLine:function(e){return e.replaceSelection(`
`,"start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function pa(e,t){var i=Se(e.doc,t),r=rt(i);return r!=i&&(t=De(r)),Ho(!0,e,r,t,1)}function Lc(e,t){var i=Se(e.doc,t),r=Qt(i);return r!=i&&(t=De(r)),Ho(!0,e,i,t,-1)}function va(e,t){var i=pa(e,t.line),r=Se(e.doc,i.line),n=ut(r,e.doc.direction);if(!n||n[0].level==0){var l=Math.max(i.ch,r.text.search(/\S/)),_=t.line==i.line&&t.ch<=l&&t.ch;return le(i.line,_?0:l,i.sticky)}return i}function Jn(e,t,i){if(typeof t=="string"&&(t=wn[t],!t))return!1;e.display.input.ensurePolled();var r=e.display.shift,n=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),n=t(e)!=N}finally{e.display.shift=r,e.state.suppressEdits=!1}return n}function xc(e,t,i){for(var r=0;r<e.state.keyMaps.length;r++){var n=Zi(t,e.state.keyMaps[r],i,e);if(n)return n}return e.options.extraKeys&&Zi(t,e.options.extraKeys,i,e)||Zi(t,e.options.keyMap,i,e)}var kc=new we;function Ln(e,t,i,r){var n=e.state.keySeq;if(n){if(fa(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:kc.set(50,function(){e.state.keySeq==n&&(e.state.keySeq=null,e.display.input.reset())}),_a(e,n+" "+t,i,r))return!0}return _a(e,t,i,r)}function _a(e,t,i,r){var n=xc(e,t,r);return n=="multi"&&(e.state.keySeq=t),n=="handled"&&ot(e,"keyHandled",e,t,i),(n=="handled"||n=="multi")&&(Ye(i),yo(e)),!!n}function ga(e,t){var i=da(t,!0);return i?t.shiftKey&&!e.state.keySeq?Ln(e,"Shift-"+i,t,function(r){return Jn(e,r,!0)})||Ln(e,i,t,function(r){if(typeof r=="string"?/^go[A-Z]/.test(r):r.motion)return Jn(e,r)}):Ln(e,i,t,function(r){return Jn(e,r)}):!1}function Ec(e,t,i){return Ln(e,"'"+i+"'",t,function(r){return Jn(e,r,!0)})}var Io=null;function ya(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField())&&(t.curOp.focus=I(),!je(t,e))){k&&v<11&&e.keyCode==27&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=i==16||e.shiftKey;var r=ga(t,e);b&&(Io=r?i:null,!r&&i==88&&!Ir&&(o?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),Q&&!o&&!r&&i==46&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),i==18&&!/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)&&Ac(t)}}function Ac(e){var t=e.display.lineDiv;F(t,"CodeMirror-crosshair");function i(r){(r.keyCode==18||!r.altKey)&&(P(t,"CodeMirror-crosshair"),et(document,"keyup",i),et(document,"mouseover",i))}ke(document,"keyup",i),ke(document,"mouseover",i)}function ma(e){e.keyCode==16&&(this.doc.sel.shift=!1),je(this,e)}function ba(e){var t=this;if(!(e.target&&e.target!=t.display.input.getField())&&!(Kr(t.display,e)||je(t,e)||e.ctrlKey&&!e.altKey||o&&e.metaKey)){var i=e.keyCode,r=e.charCode;if(b&&i==Io){Io=null,Ye(e);return}if(!(b&&(!e.which||e.which<10)&&ga(t,e))){var n=String.fromCharCode(r??i);n!="\b"&&(Ec(t,e,n)||t.display.input.onKeyPress(e))}}}var Tc=400,Fo=function(e,t,i){this.time=e,this.pos=t,this.button=i};Fo.prototype.compare=function(e,t,i){return this.time+Tc>e&&O(t,this.pos)==0&&i==this.button};var xn,kn;function Mc(e,t){var i=+new Date;return kn&&kn.compare(i,e,t)?(xn=kn=null,"triple"):xn&&xn.compare(i,e,t)?(kn=new Fo(i,e,t),xn=null,"double"):(xn=new Fo(i,e,t),kn=null,"single")}function Sa(e){var t=this,i=t.display;if(!(je(t,e)||i.activeTouch&&i.input.supportsTouch())){if(i.input.ensurePolled(),i.shift=e.shiftKey,Kr(i,e)){y||(i.scroller.draggable=!1,setTimeout(function(){return i.scroller.draggable=!0},100));return}if(!Wo(t,e)){var r=yi(t,e),n=Br(e),l=r?Mc(r,n):"single";window.focus(),n==1&&t.state.selectingText&&t.state.selectingText(e),!(r&&Rc(t,n,r,l,e))&&(n==1?r?Dc(t,r,l,e):Vt(e)==i.scroller&&Ye(e):n==2?(r&&Kn(t.doc,r),setTimeout(function(){return i.input.focus()},20)):n==3&&(T?t.display.input.onContextMenu(e):mo(t)))}}}function Rc(e,t,i,r,n){var l="Click";return r=="double"?l="Double"+l:r=="triple"&&(l="Triple"+l),l=(t==1?"Left":t==2?"Middle":"Right")+l,Ln(e,ha(l,n),n,function(_){if(typeof _=="string"&&(_=wn[_]),!_)return!1;var C=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),C=_(e,i)!=N}finally{e.state.suppressEdits=!1}return C})}function Oc(e,t,i){var r=e.getOption("configureMouse"),n=r?r(e,t,i):{};if(n.unit==null){var l=c?i.shiftKey&&i.metaKey:i.altKey;n.unit=l?"rectangle":t=="single"?"char":t=="double"?"word":"line"}return(n.extend==null||e.doc.extend)&&(n.extend=e.doc.extend||i.shiftKey),n.addNew==null&&(n.addNew=o?i.metaKey:i.ctrlKey),n.moveOnDrag==null&&(n.moveOnDrag=!(o?i.altKey:i.ctrlKey)),n}function Dc(e,t,i,r){k?setTimeout(ue(Cs,e),0):e.curOp.focus=I();var n=Oc(e,i,r),l=e.doc.sel,_;e.options.dragDrop&&gr&&!e.isReadOnly()&&i=="single"&&(_=l.contains(t))>-1&&(O((_=l.ranges[_]).from(),t)<0||t.xRel>0)&&(O(_.to(),t)>0||t.xRel<0)?Bc(e,r,t,n):Pc(e,r,t,n)}function Bc(e,t,i,r){var n=e.display,l=!1,_=st(e,function(R){y&&(n.scroller.draggable=!1),e.state.draggingText=!1,e.state.delayingBlurEvent&&(e.hasFocus()?e.state.delayingBlurEvent=!1:mo(e)),et(n.wrapper.ownerDocument,"mouseup",_),et(n.wrapper.ownerDocument,"mousemove",C),et(n.scroller,"dragstart",A),et(n.scroller,"drop",_),l||(Ye(R),r.addNew||Kn(e.doc,i,null,null,r.extend),y&&!S||k&&v==9?setTimeout(function(){n.wrapper.ownerDocument.body.focus({preventScroll:!0}),n.input.focus()},20):n.input.focus())}),C=function(R){l=l||Math.abs(t.clientX-R.clientX)+Math.abs(t.clientY-R.clientY)>=10},A=function(){return l=!0};y&&(n.scroller.draggable=!0),e.state.draggingText=_,_.copy=!r.moveOnDrag,ke(n.wrapper.ownerDocument,"mouseup",_),ke(n.wrapper.ownerDocument,"mousemove",C),ke(n.scroller,"dragstart",A),ke(n.scroller,"drop",_),e.state.delayingBlurEvent=!0,setTimeout(function(){return n.input.focus()},20),n.scroller.dragDrop&&n.scroller.dragDrop()}function Ca(e,t,i){if(i=="char")return new Pe(t,t);if(i=="word")return e.findWordAt(t);if(i=="line")return new Pe(le(t.line,0),ge(e.doc,le(t.line+1,0)));var r=i(e,t);return new Pe(r.from,r.to)}function Pc(e,t,i,r){k&&mo(e);var n=e.display,l=e.doc;Ye(t);var _,C,A=l.sel,R=A.ranges;if(r.addNew&&!r.extend?(C=l.sel.contains(i),C>-1?_=R[C]:_=new Pe(i,i)):(_=l.sel.primary(),C=l.sel.primIndex),r.unit=="rectangle")r.addNew||(_=new Pe(i,i)),i=yi(e,t,!0,!0),C=-1;else{var W=Ca(e,i,r.unit);r.extend?_=Oo(_,W.anchor,W.head,r.extend):_=W}r.addNew?C==-1?(C=R.length,Lt(l,pr(e,R.concat([_]),C),{scroll:!1,origin:"*mouse"})):R.length>1&&R[C].empty()&&r.unit=="char"&&!r.extend?(Lt(l,pr(e,R.slice(0,C).concat(R.slice(C+1)),0),{scroll:!1,origin:"*mouse"}),A=l.sel):Do(l,C,_,se):(C=0,Lt(l,new er([_],0),se),A=l.sel);var z=i;function J(pe){if(O(z,pe)!=0)if(z=pe,r.unit=="rectangle"){for(var me=[],Ae=e.options.tabSize,xe=Ce(Se(l,i.line).text,i.ch,Ae),Re=Ce(Se(l,pe.line).text,pe.ch,Ae),We=Math.min(xe,Re),lt=Math.max(xe,Re),ze=Math.min(i.line,pe.line),Xt=Math.min(e.lastLine(),Math.max(i.line,pe.line));ze<=Xt;ze++){var Wt=Se(l,ze).text,$e=_e(Wt,We,Ae);We==lt?me.push(new Pe(le(ze,$e),le(ze,$e))):Wt.length>$e&&me.push(new Pe(le(ze,$e),le(ze,_e(Wt,lt,Ae))))}me.length||me.push(new Pe(i,i)),Lt(l,pr(e,A.ranges.slice(0,C).concat(me),C),{origin:"*mouse",scroll:!1}),e.scrollIntoView(pe)}else{var Nt=_,pt=Ca(e,pe,r.unit),it=Nt.anchor,Qe;O(pt.anchor,it)>0?(Qe=pt.head,it=Me(Nt.from(),pt.anchor)):(Qe=pt.anchor,it=ce(Nt.to(),pt.head));var Xe=A.ranges.slice(0);Xe[C]=Hc(e,new Pe(ge(l,it),Qe)),Lt(l,pr(e,Xe,C),se)}}var X=n.wrapper.getBoundingClientRect(),ee=0;function ne(pe){var me=++ee,Ae=yi(e,pe,!0,r.unit=="rectangle");if(!!Ae)if(O(Ae,z)!=0){e.curOp.focus=I(),J(Ae);var xe=Wn(n,l);(Ae.line>=xe.to||Ae.line<xe.from)&&setTimeout(st(e,function(){ee==me&&ne(pe)}),150)}else{var Re=pe.clientY<X.top?-20:pe.clientY>X.bottom?20:0;Re&&setTimeout(st(e,function(){ee==me&&(n.scroller.scrollTop+=Re,ne(pe))}),50)}}function he(pe){e.state.selectingText=!1,ee=1/0,pe&&(Ye(pe),n.input.focus()),et(n.wrapper.ownerDocument,"mousemove",de),et(n.wrapper.ownerDocument,"mouseup",ye),l.history.lastSelOrigin=null}var de=st(e,function(pe){pe.buttons===0||!Br(pe)?he(pe):ne(pe)}),ye=st(e,he);e.state.selectingText=ye,ke(n.wrapper.ownerDocument,"mousemove",de),ke(n.wrapper.ownerDocument,"mouseup",ye)}function Hc(e,t){var i=t.anchor,r=t.head,n=Se(e.doc,i.line);if(O(i,r)==0&&i.sticky==r.sticky)return t;var l=ut(n);if(!l)return t;var _=Ne(l,i.ch,i.sticky),C=l[_];if(C.from!=i.ch&&C.to!=i.ch)return t;var A=_+(C.from==i.ch==(C.level!=1)?0:1);if(A==0||A==l.length)return t;var R;if(r.line!=i.line)R=(r.line-i.line)*(e.doc.direction=="ltr"?1:-1)>0;else{var W=Ne(l,r.ch,r.sticky),z=W-_||(r.ch-i.ch)*(C.level==1?-1:1);W==A-1||W==A?R=z<0:R=z>0}var J=l[A+(R?-1:0)],X=R==(J.level==1),ee=X?J.from:J.to,ne=X?"after":"before";return i.ch==ee&&i.sticky==ne?t:new Pe(new le(i.line,ee,ne),r)}function wa(e,t,i,r){var n,l;if(t.touches)n=t.touches[0].clientX,l=t.touches[0].clientY;else try{n=t.clientX,l=t.clientY}catch{return!1}if(n>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;r&&Ye(t);var _=e.display,C=_.lineDiv.getBoundingClientRect();if(l>C.bottom||!Ke(e,i))return ft(t);l-=C.top-_.viewOffset;for(var A=0;A<e.display.gutterSpecs.length;++A){var R=_.gutters.childNodes[A];if(R&&R.getBoundingClientRect().right>=n){var W=Bt(e.doc,l),z=e.display.gutterSpecs[A];return Te(e,i,e,W,z.className,t),ft(t)}}}function Wo(e,t){return wa(e,t,"gutterClick",!0)}function La(e,t){Kr(e.display,t)||Ic(e,t)||je(e,t,"contextmenu")||T||e.display.input.onContextMenu(t)}function Ic(e,t){return Ke(e,"gutterContextMenu")?wa(e,t,"gutterContextMenu",!1):!1}function xa(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),sn(e)}var Ji={toString:function(){return"CodeMirror.Init"}},ka={},$n={};function Fc(e){var t=e.optionHandlers;function i(r,n,l,_){e.defaults[r]=n,l&&(t[r]=_?function(C,A,R){R!=Ji&&l(C,A,R)}:l)}e.defineOption=i,e.Init=Ji,i("value","",function(r,n){return r.setValue(n)},!0),i("mode",null,function(r,n){r.doc.modeOption=n,To(r)},!0),i("indentUnit",2,To,!0),i("indentWithTabs",!1),i("smartIndent",!0),i("tabSize",4,function(r){pn(r),sn(r),It(r)},!0),i("lineSeparator",null,function(r,n){if(r.doc.lineSep=n,!!n){var l=[],_=r.doc.first;r.doc.iter(function(A){for(var R=0;;){var W=A.text.indexOf(n,R);if(W==-1)break;R=W+n.length,l.push(le(_,W))}_++});for(var C=l.length-1;C>=0;C--)Xi(r.doc,n,l[C],le(l[C].line,l[C].ch+n.length))}}),i("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(r,n,l){r.state.specialChars=new RegExp(n.source+(n.test("	")?"":"|	"),"g"),l!=Ji&&r.refresh()}),i("specialCharPlaceholder",dl,function(r){return r.refresh()},!0),i("electricChars",!0),i("inputStyle",s?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),i("spellcheck",!1,function(r,n){return r.getInputField().spellcheck=n},!0),i("autocorrect",!1,function(r,n){return r.getInputField().autocorrect=n},!0),i("autocapitalize",!1,function(r,n){return r.getInputField().autocapitalize=n},!0),i("rtlMoveVisually",!d),i("wholeLineUpdateBefore",!0),i("theme","default",function(r){xa(r),dn(r)},!0),i("keyMap","default",function(r,n,l){var _=Vn(n),C=l!=Ji&&Vn(l);C&&C.detach&&C.detach(r,_),_.attach&&_.attach(r,C||null)}),i("extraKeys",null),i("configureMouse",null),i("lineWrapping",!1,Nc,!0),i("gutters",[],function(r,n){r.display.gutterSpecs=Eo(n,r.options.lineNumbers),dn(r)},!0),i("fixedGutter",!0,function(r,n){r.display.gutters.style.left=n?vo(r.display)+"px":"0",r.refresh()},!0),i("coverGutterNextToScrollbar",!1,function(r){return qi(r)},!0),i("scrollbarStyle","native",function(r){As(r),qi(r),r.display.scrollbars.setScrollTop(r.doc.scrollTop),r.display.scrollbars.setScrollLeft(r.doc.scrollLeft)},!0),i("lineNumbers",!1,function(r,n){r.display.gutterSpecs=Eo(r.options.gutters,n),dn(r)},!0),i("firstLineNumber",1,dn,!0),i("lineNumberFormatter",function(r){return r},dn,!0),i("showCursorWhenSelecting",!1,an,!0),i("resetSelectionOnContextMenu",!0),i("lineWiseCopyCut",!0),i("pasteLinesPerSelection",!0),i("selectionsMayTouch",!1),i("readOnly",!1,function(r,n){n=="nocursor"&&(ji(r),r.display.input.blur()),r.display.input.readOnlyChanged(n)}),i("screenReaderLabel",null,function(r,n){n=n===""?null:n,r.display.input.screenReaderLabelChanged(n)}),i("disableInput",!1,function(r,n){n||r.display.input.reset()},!0),i("dragDrop",!0,Wc),i("allowDropFileTypes",null),i("cursorBlinkRate",530),i("cursorScrollMargin",0),i("cursorHeight",1,an,!0),i("singleCursorHeightPerLine",!0,an,!0),i("workTime",100),i("workDelay",100),i("flattenSpans",!0,pn,!0),i("addModeClass",!1,pn,!0),i("pollInterval",100),i("undoDepth",200,function(r,n){return r.doc.history.undoDepth=n}),i("historyEventDelay",1250),i("viewportMargin",10,function(r){return r.refresh()},!0),i("maxHighlightLength",1e4,pn,!0),i("moveInputWithCursor",!0,function(r,n){n||r.display.input.resetPosition()}),i("tabindex",null,function(r,n){return r.display.input.getField().tabIndex=n||""}),i("autofocus",null),i("direction","ltr",function(r,n){return r.doc.setDirection(n)},!0),i("phrases",null)}function Wc(e,t,i){var r=i&&i!=Ji;if(!t!=!r){var n=e.display.dragFunctions,l=t?ke:et;l(e.display.scroller,"dragstart",n.start),l(e.display.scroller,"dragenter",n.enter),l(e.display.scroller,"dragover",n.over),l(e.display.scroller,"dragleave",n.leave),l(e.display.scroller,"drop",n.drop)}}function Nc(e){e.options.lineWrapping?(F(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(P(e.display.wrapper,"CodeMirror-wrap"),vi(e)),_o(e),It(e),sn(e),setTimeout(function(){return qi(e)},100)}function Ue(e,t){var i=this;if(!(this instanceof Ue))return new Ue(e,t);this.options=t=t?ae(t):{},ae(ka,t,!1);var r=t.value;typeof r=="string"?r=new Ft(r,t.mode,null,t.lineSeparator,t.direction):t.mode&&(r.modeOption=t.mode),this.doc=r;var n=new Ue.inputStyles[t.inputStyle](this),l=this.display=new Ql(e,r,n,t);l.wrapper.CodeMirror=this,xa(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),As(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new we,keySeq:null,specialChars:null},t.autofocus&&!s&&l.input.focus(),k&&v<11&&setTimeout(function(){return i.display.input.reset(!0)},20),jc(this),yc(),Ci(this),this.curOp.forceUpdate=!0,Fs(this,r),t.autofocus&&!s||this.hasFocus()?setTimeout(function(){i.hasFocus()&&!i.state.focused&&bo(i)},20):ji(this);for(var _ in $n)$n.hasOwnProperty(_)&&$n[_](this,t[_],Ji);Rs(this),t.finishInit&&t.finishInit(this);for(var C=0;C<No.length;++C)No[C](this);wi(this),y&&t.lineWrapping&&getComputedStyle(l.lineDiv).textRendering=="optimizelegibility"&&(l.lineDiv.style.textRendering="auto")}Ue.defaults=ka,Ue.optionHandlers=$n;function jc(e){var t=e.display;ke(t.scroller,"mousedown",st(e,Sa)),k&&v<11?ke(t.scroller,"dblclick",st(e,function(A){if(!je(e,A)){var R=yi(e,A);if(!(!R||Wo(e,A)||Kr(e.display,A))){Ye(A);var W=e.findWordAt(R);Kn(e.doc,W.anchor,W.head)}}})):ke(t.scroller,"dblclick",function(A){return je(e,A)||Ye(A)}),ke(t.scroller,"contextmenu",function(A){return La(e,A)}),ke(t.input.getField(),"contextmenu",function(A){t.scroller.contains(A.target)||La(e,A)});var i,r={end:0};function n(){t.activeTouch&&(i=setTimeout(function(){return t.activeTouch=null},1e3),r=t.activeTouch,r.end=+new Date)}function l(A){if(A.touches.length!=1)return!1;var R=A.touches[0];return R.radiusX<=1&&R.radiusY<=1}function _(A,R){if(R.left==null)return!0;var W=R.left-A.left,z=R.top-A.top;return W*W+z*z>20*20}ke(t.scroller,"touchstart",function(A){if(!je(e,A)&&!l(A)&&!Wo(e,A)){t.input.ensurePolled(),clearTimeout(i);var R=+new Date;t.activeTouch={start:R,moved:!1,prev:R-r.end<=300?r:null},A.touches.length==1&&(t.activeTouch.left=A.touches[0].pageX,t.activeTouch.top=A.touches[0].pageY)}}),ke(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),ke(t.scroller,"touchend",function(A){var R=t.activeTouch;if(R&&!Kr(t,A)&&R.left!=null&&!R.moved&&new Date-R.start<300){var W=e.coordsChar(t.activeTouch,"page"),z;!R.prev||_(R,R.prev)?z=new Pe(W,W):!R.prev.prev||_(R,R.prev.prev)?z=e.findWordAt(W):z=new Pe(le(W.line,0),ge(e.doc,le(W.line+1,0))),e.setSelection(z.anchor,z.head),e.focus(),Ye(A)}n()}),ke(t.scroller,"touchcancel",n),ke(t.scroller,"scroll",function(){t.scroller.clientHeight&&(cn(e,t.scroller.scrollTop),bi(e,t.scroller.scrollLeft,!0),Te(e,"scroll",e))}),ke(t.scroller,"mousewheel",function(A){return Bs(e,A)}),ke(t.scroller,"DOMMouseScroll",function(A){return Bs(e,A)}),ke(t.wrapper,"scroll",function(){return t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={enter:function(A){je(e,A)||tr(A)},over:function(A){je(e,A)||(gc(e,A),tr(A))},start:function(A){return _c(e,A)},drop:st(e,vc),leave:function(A){je(e,A)||la(e)}};var C=t.input.getField();ke(C,"keyup",function(A){return ma.call(e,A)}),ke(C,"keydown",st(e,ya)),ke(C,"keypress",st(e,ba)),ke(C,"focus",function(A){return bo(e,A)}),ke(C,"blur",function(A){return ji(e,A)})}var No=[];Ue.defineInitHook=function(e){return No.push(e)};function En(e,t,i,r){var n=e.doc,l;i==null&&(i="add"),i=="smart"&&(n.mode.indent?l=Wr(e,t).state:i="prev");var _=e.options.tabSize,C=Se(n,t),A=Ce(C.text,null,_);C.stateAfter&&(C.stateAfter=null);var R=C.text.match(/^\s*/)[0],W;if(!r&&!/\S/.test(C.text))W=0,i="not";else if(i=="smart"&&(W=n.mode.indent(l,C.text.slice(R.length),C.text),W==N||W>150)){if(!r)return;i="prev"}i=="prev"?t>n.first?W=Ce(Se(n,t-1).text,null,_):W=0:i=="add"?W=A+e.options.indentUnit:i=="subtract"?W=A-e.options.indentUnit:typeof i=="number"&&(W=A+i),W=Math.max(0,W);var z="",J=0;if(e.options.indentWithTabs)for(var X=Math.floor(W/_);X;--X)J+=_,z+="	";if(J<W&&(z+=Be(W-J)),z!=R)return Xi(n,z,le(t,0),le(t,R.length),"+input"),C.stateAfter=null,!0;for(var ee=0;ee<n.sel.ranges.length;ee++){var ne=n.sel.ranges[ee];if(ne.head.line==t&&ne.head.ch<R.length){var he=le(t,R.length);Do(n,ee,new Pe(he,he));break}}}var vr=null;function Qn(e){vr=e}function jo(e,t,i,r,n){var l=e.doc;e.display.shift=!1,r||(r=l.sel);var _=+new Date-200,C=n=="paste"||e.state.pasteIncoming>_,A=mr(t),R=null;if(C&&r.ranges.length>1)if(vr&&vr.text.join(`
`)==t){if(r.ranges.length%vr.text.length==0){R=[];for(var W=0;W<vr.text.length;W++)R.push(l.splitLines(vr.text[W]))}}else A.length==r.ranges.length&&e.options.pasteLinesPerSelection&&(R=Ie(A,function(de){return[de]}));for(var z=e.curOp.updateInput,J=r.ranges.length-1;J>=0;J--){var X=r.ranges[J],ee=X.from(),ne=X.to();X.empty()&&(i&&i>0?ee=le(ee.line,ee.ch-i):e.state.overwrite&&!C?ne=le(ne.line,Math.min(Se(l,ne.line).text.length,ne.ch+Ee(A).length)):C&&vr&&vr.lineWise&&vr.text.join(`
`)==A.join(`
`)&&(ee=ne=le(ee.line,0)));var he={from:ee,to:ne,text:R?R[J%R.length]:A,origin:n||(C?"paste":e.state.cutIncoming>_?"cut":"+input")};Gi(e.doc,he),ot(e,"inputRead",e,he)}t&&!C&&Aa(e,t),Ui(e),e.curOp.updateInput<2&&(e.curOp.updateInput=z),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function Ea(e,t){var i=e.clipboardData&&e.clipboardData.getData("Text");if(i)return e.preventDefault(),!t.isReadOnly()&&!t.options.disableInput&&Gt(t,function(){return jo(t,i,0,null,"paste")}),!0}function Aa(e,t){if(!(!e.options.electricChars||!e.options.smartIndent))for(var i=e.doc.sel,r=i.ranges.length-1;r>=0;r--){var n=i.ranges[r];if(!(n.head.ch>100||r&&i.ranges[r-1].head.line==n.head.line)){var l=e.getModeAt(n.head),_=!1;if(l.electricChars){for(var C=0;C<l.electricChars.length;C++)if(t.indexOf(l.electricChars.charAt(C))>-1){_=En(e,n.head.line,"smart");break}}else l.electricInput&&l.electricInput.test(Se(e.doc,n.head.line).text.slice(0,n.head.ch))&&(_=En(e,n.head.line,"smart"));_&&ot(e,"electricInput",e,n.head.line)}}}function Ta(e){for(var t=[],i=[],r=0;r<e.doc.sel.ranges.length;r++){var n=e.doc.sel.ranges[r].head.line,l={anchor:le(n,0),head:le(n+1,0)};i.push(l),t.push(e.getRange(l.anchor,l.head))}return{text:t,ranges:i}}function Ma(e,t,i,r){e.setAttribute("autocorrect",i?"":"off"),e.setAttribute("autocapitalize",r?"":"off"),e.setAttribute("spellcheck",!!t)}function Ra(){var e=D("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; min-height: 1em; outline: none"),t=D("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return y?e.style.width="1000px":e.setAttribute("wrap","off"),p&&(e.style.border="1px solid black"),Ma(e),t}function Uc(e){var t=e.optionHandlers,i=e.helpers={};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(r,n){var l=this.options,_=l[r];l[r]==n&&r!="mode"||(l[r]=n,t.hasOwnProperty(r)&&st(this,t[r])(this,n,_),Te(this,"optionChange",this,r))},getOption:function(r){return this.options[r]},getDoc:function(){return this.doc},addKeyMap:function(r,n){this.state.keyMaps[n?"push":"unshift"](Vn(r))},removeKeyMap:function(r){for(var n=this.state.keyMaps,l=0;l<n.length;++l)if(n[l]==r||n[l].name==r)return n.splice(l,1),!0},addOverlay:At(function(r,n){var l=r.token?r:e.getMode(this.options,r);if(l.startState)throw new Error("Overlays may not be stateful.");be(this.state.overlays,{mode:l,modeSpec:r,opaque:n&&n.opaque,priority:n&&n.priority||0},function(_){return _.priority}),this.state.modeGen++,It(this)}),removeOverlay:At(function(r){for(var n=this.state.overlays,l=0;l<n.length;++l){var _=n[l].modeSpec;if(_==r||typeof r=="string"&&_.name==r){n.splice(l,1),this.state.modeGen++,It(this);return}}}),indentLine:At(function(r,n,l){typeof n!="string"&&typeof n!="number"&&(n==null?n=this.options.smartIndent?"smart":"prev":n=n?"add":"subtract"),rr(this.doc,r)&&En(this,r,n,l)}),indentSelection:At(function(r){for(var n=this.doc.sel.ranges,l=-1,_=0;_<n.length;_++){var C=n[_];if(C.empty())C.head.line>l&&(En(this,C.head.line,r,!0),l=C.head.line,_==this.doc.sel.primIndex&&Ui(this));else{var A=C.from(),R=C.to(),W=Math.max(l,A.line);l=Math.min(this.lastLine(),R.line-(R.ch?0:1))+1;for(var z=W;z<l;++z)En(this,z,r);var J=this.doc.sel.ranges;A.ch==0&&n.length==J.length&&J[_].from().ch>0&&Do(this.doc,_,new Pe(A,J[_].to()),U)}}}),getTokenAt:function(r,n){return Di(this,r,n)},getLineTokens:function(r,n){return Di(this,le(r),n,!0)},getTokenTypeAt:function(r){r=ge(this.doc,r);var n=Mi(this,Se(this.doc,r.line)),l=0,_=(n.length-1)/2,C=r.ch,A;if(C==0)A=n[2];else for(;;){var R=l+_>>1;if((R?n[R*2-1]:0)>=C)_=R;else if(n[R*2+1]<C)l=R+1;else{A=n[R*2+2];break}}var W=A?A.indexOf("overlay "):-1;return W<0?A:W==0?null:A.slice(0,W-1)},getModeAt:function(r){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(r).state).mode:n},getHelper:function(r,n){return this.getHelpers(r,n)[0]},getHelpers:function(r,n){var l=[];if(!i.hasOwnProperty(n))return l;var _=i[n],C=this.getModeAt(r);if(typeof C[n]=="string")_[C[n]]&&l.push(_[C[n]]);else if(C[n])for(var A=0;A<C[n].length;A++){var R=_[C[n][A]];R&&l.push(R)}else C.helperType&&_[C.helperType]?l.push(_[C.helperType]):_[C.name]&&l.push(_[C.name]);for(var W=0;W<_._global.length;W++){var z=_._global[W];z.pred(C,this)&&fe(l,z.val)==-1&&l.push(z.val)}return l},getStateAfter:function(r,n){var l=this.doc;return r=Oe(l,r??l.first+l.size-1),Wr(this,r+1,n).state},cursorCoords:function(r,n){var l,_=this.doc.sel.primary();return r==null?l=_.head:typeof r=="object"?l=ge(this.doc,r):l=r?_.from():_.to(),dr(this,l,n||"page")},charCoords:function(r,n){return Pn(this,ge(this.doc,r),n||"page")},coordsChar:function(r,n){return r=vs(this,r,n||"page"),fo(this,r.left,r.top)},lineAtHeight:function(r,n){return r=vs(this,{top:r,left:0},n||"page").top,Bt(this.doc,r+this.display.viewOffset)},heightAtLine:function(r,n,l){var _=!1,C;if(typeof r=="number"){var A=this.doc.first+this.doc.size-1;r<this.doc.first?r=this.doc.first:r>A&&(r=A,_=!0),C=Se(this.doc,r)}else C=r;return Bn(this,C,{top:0,left:0},n||"page",l||_).top+(_?this.doc.height-wt(C):0)},defaultTextHeight:function(){return Wi(this.display)},defaultCharWidth:function(){return Ni(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(r,n,l,_,C){var A=this.display;r=dr(this,ge(this.doc,r));var R=r.bottom,W=r.left;if(n.style.position="absolute",n.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(n),A.sizer.appendChild(n),_=="over")R=r.top;else if(_=="above"||_=="near"){var z=Math.max(A.wrapper.clientHeight,this.doc.height),J=Math.max(A.sizer.clientWidth,A.lineSpace.clientWidth);(_=="above"||r.bottom+n.offsetHeight>z)&&r.top>n.offsetHeight?R=r.top-n.offsetHeight:r.bottom+n.offsetHeight<=z&&(R=r.bottom),W+n.offsetWidth>J&&(W=J-n.offsetWidth)}n.style.top=R+"px",n.style.left=n.style.right="",C=="right"?(W=A.sizer.clientWidth-n.offsetWidth,n.style.right="0px"):(C=="left"?W=0:C=="middle"&&(W=(A.sizer.clientWidth-n.offsetWidth)/2),n.style.left=W+"px"),l&&Wl(this,{left:W,top:R,right:W+n.offsetWidth,bottom:R+n.offsetHeight})},triggerOnKeyDown:At(ya),triggerOnKeyPress:At(ba),triggerOnKeyUp:ma,triggerOnMouseDown:At(Sa),execCommand:function(r){if(wn.hasOwnProperty(r))return wn[r].call(null,this)},triggerElectric:At(function(r){Aa(this,r)}),findPosH:function(r,n,l,_){var C=1;n<0&&(C=-1,n=-n);for(var A=ge(this.doc,r),R=0;R<n&&(A=Uo(this.doc,A,C,l,_),!A.hitSide);++R);return A},moveH:At(function(r,n){var l=this;this.extendSelectionsBy(function(_){return l.display.shift||l.doc.extend||_.empty()?Uo(l.doc,_.head,r,n,l.options.rtlMoveVisually):r<0?_.from():_.to()},G)}),deleteH:At(function(r,n){var l=this.doc.sel,_=this.doc;l.somethingSelected()?_.replaceSelection("",null,"+delete"):Vi(this,function(C){var A=Uo(_,C.head,r,n,!1);return r<0?{from:A,to:C.head}:{from:C.head,to:A}})}),findPosV:function(r,n,l,_){var C=1,A=_;n<0&&(C=-1,n=-n);for(var R=ge(this.doc,r),W=0;W<n;++W){var z=dr(this,R,"div");if(A==null?A=z.left:z.left=A,R=Oa(this,z,C,l),R.hitSide)break}return R},moveV:At(function(r,n){var l=this,_=this.doc,C=[],A=!this.display.shift&&!_.extend&&_.sel.somethingSelected();if(_.extendSelectionsBy(function(W){if(A)return r<0?W.from():W.to();var z=dr(l,W.head,"div");W.goalColumn!=null&&(z.left=W.goalColumn),C.push(z.left);var J=Oa(l,z,r,n);return n=="page"&&W==_.sel.primary()&&Co(l,Pn(l,J,"div").top-z.top),J},G),C.length)for(var R=0;R<_.sel.ranges.length;R++)_.sel.ranges[R].goalColumn=C[R]}),findWordAt:function(r){var n=this.doc,l=Se(n,r.line).text,_=r.ch,C=r.ch;if(l){var A=this.getHelper(r,"wordChars");(r.sticky=="before"||C==l.length)&&_?--_:++C;for(var R=l.charAt(_),W=_r(R,A)?function(z){return _r(z,A)}:/\s/.test(R)?function(z){return/\s/.test(z)}:function(z){return!/\s/.test(z)&&!_r(z)};_>0&&W(l.charAt(_-1));)--_;for(;C<l.length&&W(l.charAt(C));)++C}return new Pe(le(r.line,_),le(r.line,C))},toggleOverwrite:function(r){r!=null&&r==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?F(this.display.cursorDiv,"CodeMirror-overwrite"):P(this.display.cursorDiv,"CodeMirror-overwrite"),Te(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==I()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:At(function(r,n){ln(this,r,n)}),getScrollInfo:function(){var r=this.display.scroller;return{left:r.scrollLeft,top:r.scrollTop,height:r.scrollHeight-Ar(this)-this.display.barHeight,width:r.scrollWidth-Ar(this)-this.display.barWidth,clientHeight:ao(this),clientWidth:_i(this)}},scrollIntoView:At(function(r,n){r==null?(r={from:this.doc.sel.primary().head,to:null},n==null&&(n=this.options.cursorScrollMargin)):typeof r=="number"?r={from:le(r,0),to:null}:r.from==null&&(r={from:r,to:null}),r.to||(r.to=r.from),r.margin=n||0,r.from.line!=null?Nl(this,r):Ls(this,r.from,r.to,r.margin)}),setSize:At(function(r,n){var l=this,_=function(A){return typeof A=="number"||/^\d+$/.test(String(A))?A+"px":A};r!=null&&(this.display.wrapper.style.width=_(r)),n!=null&&(this.display.wrapper.style.height=_(n)),this.options.lineWrapping&&hs(this);var C=this.display.viewFrom;this.doc.iter(C,this.display.viewTo,function(A){if(A.widgets){for(var R=0;R<A.widgets.length;R++)if(A.widgets[R].noHScroll){Qr(l,C,"widget");break}}++C}),this.curOp.forceUpdate=!0,Te(this,"refresh",this)}),operation:function(r){return Gt(this,r)},startOperation:function(){return Ci(this)},endOperation:function(){return wi(this)},refresh:At(function(){var r=this.display.cachedTextHeight;It(this),this.curOp.forceUpdate=!0,sn(this),ln(this,this.doc.scrollLeft,this.doc.scrollTop),xo(this.display),(r==null||Math.abs(r-Wi(this.display))>.5||this.options.lineWrapping)&&_o(this),Te(this,"refresh",this)}),swapDoc:At(function(r){var n=this.doc;return n.cm=null,this.state.selectingText&&this.state.selectingText(),Fs(this,r),sn(this),this.display.input.reset(),ln(this,r.scrollLeft,r.scrollTop),this.curOp.forceScroll=!0,ot(this,"swapDoc",this,n),n}),phrase:function(r){var n=this.options.phrases;return n&&Object.prototype.hasOwnProperty.call(n,r)?n[r]:r},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Rt(e),e.registerHelper=function(r,n,l){i.hasOwnProperty(r)||(i[r]=e[r]={_global:[]}),i[r][n]=l},e.registerGlobalHelper=function(r,n,l,_){e.registerHelper(r,n,_),i[r]._global.push({pred:l,val:_})}}function Uo(e,t,i,r,n){var l=t,_=i,C=Se(e,t.line),A=n&&e.direction=="rtl"?-i:i;function R(){var ye=t.line+A;return ye<e.first||ye>=e.first+e.size?!1:(t=new le(ye,t.ch,t.sticky),C=Se(e,ye))}function W(ye){var pe;if(r=="codepoint"){var me=C.text.charCodeAt(t.ch+(i>0?0:-1));if(isNaN(me))pe=null;else{var Ae=i>0?me>=55296&&me<56320:me>=56320&&me<57343;pe=new le(t.line,Math.max(0,Math.min(C.text.length,t.ch+i*(Ae?2:1))),-i)}}else n?pe=wc(e.cm,C,t,i):pe=Po(C,t,i);if(pe==null)if(!ye&&R())t=Ho(n,e.cm,C,t.line,A);else return!1;else t=pe;return!0}if(r=="char"||r=="codepoint")W();else if(r=="column")W(!0);else if(r=="word"||r=="group")for(var z=null,J=r=="group",X=e.cm&&e.cm.getHelper(t,"wordChars"),ee=!0;!(i<0&&!W(!ee));ee=!1){var ne=C.text.charAt(t.ch)||`
`,he=_r(ne,X)?"w":J&&ne==`
`?"n":!J||/\s/.test(ne)?null:"p";if(J&&!ee&&!he&&(he="s"),z&&z!=he){i<0&&(i=1,W(),t.sticky="after");break}if(he&&(z=he),i>0&&!W(!ee))break}var de=Xn(e,t,l,_,!0);return q(l,de)&&(de.hitSide=!0),de}function Oa(e,t,i,r){var n=e.doc,l=t.left,_;if(r=="page"){var C=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),A=Math.max(C-.5*Wi(e.display),3);_=(i>0?t.bottom:t.top)+i*A}else r=="line"&&(_=i>0?t.bottom+3:t.top-3);for(var R;R=fo(e,l,_),!!R.outside;){if(i<0?_<=0:_>=n.height){R.hitSide=!0;break}_+=i*5}return R}var He=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new we,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};He.prototype.init=function(e){var t=this,i=this,r=i.cm,n=i.div=e.lineDiv;n.contentEditable=!0,Ma(n,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize);function l(C){for(var A=C.target;A;A=A.parentNode){if(A==n)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(A.className))break}return!1}ke(n,"paste",function(C){!l(C)||je(r,C)||Ea(C,r)||v<=11&&setTimeout(st(r,function(){return t.updateFromDOM()}),20)}),ke(n,"compositionstart",function(C){t.composing={data:C.data,done:!1}}),ke(n,"compositionupdate",function(C){t.composing||(t.composing={data:C.data,done:!1})}),ke(n,"compositionend",function(C){t.composing&&(C.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),ke(n,"touchstart",function(){return i.forceCompositionEnd()}),ke(n,"input",function(){t.composing||t.readFromDOMSoon()});function _(C){if(!(!l(C)||je(r,C))){if(r.somethingSelected())Qn({lineWise:!1,text:r.getSelections()}),C.type=="cut"&&r.replaceSelection("",null,"cut");else if(r.options.lineWiseCopyCut){var A=Ta(r);Qn({lineWise:!0,text:A.text}),C.type=="cut"&&r.operation(function(){r.setSelections(A.ranges,0,U),r.replaceSelection("",null,"cut")})}else return;if(C.clipboardData){C.clipboardData.clearData();var R=vr.text.join(`
`);if(C.clipboardData.setData("Text",R),C.clipboardData.getData("Text")==R){C.preventDefault();return}}var W=Ra(),z=W.firstChild;r.display.lineSpace.insertBefore(W,r.display.lineSpace.firstChild),z.value=vr.text.join(`
`);var J=I();Z(z),setTimeout(function(){r.display.lineSpace.removeChild(W),J.focus(),J==n&&i.showPrimarySelection()},50)}}ke(n,"copy",_),ke(n,"cut",_)},He.prototype.screenReaderLabelChanged=function(e){e?this.div.setAttribute("aria-label",e):this.div.removeAttribute("aria-label")},He.prototype.prepareSelection=function(){var e=Ss(this.cm,!1);return e.focus=I()==this.div,e},He.prototype.showSelection=function(e,t){!e||!this.cm.display.view.length||((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},He.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},He.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,i=t.doc.sel.primary(),r=i.from(),n=i.to();if(t.display.viewTo==t.display.viewFrom||r.line>=t.display.viewTo||n.line<t.display.viewFrom){e.removeAllRanges();return}var l=eo(t,e.anchorNode,e.anchorOffset),_=eo(t,e.focusNode,e.focusOffset);if(!(l&&!l.bad&&_&&!_.bad&&O(Me(l,_),r)==0&&O(ce(l,_),n)==0)){var C=t.display.view,A=r.line>=t.display.viewFrom&&Da(t,r)||{node:C[0].measure.map[2],offset:0},R=n.line<t.display.viewTo&&Da(t,n);if(!R){var W=C[C.length-1].measure,z=W.maps?W.maps[W.maps.length-1]:W.map;R={node:z[z.length-1],offset:z[z.length-2]-z[z.length-3]}}if(!A||!R){e.removeAllRanges();return}var J=e.rangeCount&&e.getRangeAt(0),X;try{X=Y(A.node,A.offset,R.offset,R.node)}catch{}X&&(!Q&&t.state.focused?(e.collapse(A.node,A.offset),X.collapsed||(e.removeAllRanges(),e.addRange(X))):(e.removeAllRanges(),e.addRange(X)),J&&e.anchorNode==null?e.addRange(J):Q&&this.startGracePeriod()),this.rememberSelection()}},He.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},He.prototype.showMultipleSelections=function(e){L(this.cm.display.cursorDiv,e.cursors),L(this.cm.display.selectionDiv,e.selection)},He.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},He.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return j(this.div,t)},He.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&((!this.selectionInEditor()||I()!=this.div)&&this.showSelection(this.prepareSelection(),!0),this.div.focus())},He.prototype.blur=function(){this.div.blur()},He.prototype.getField=function(){return this.div},He.prototype.supportsTouch=function(){return!0},He.prototype.receivedFocus=function(){var e=this,t=this;this.selectionInEditor()?setTimeout(function(){return e.pollSelection()},20):Gt(this.cm,function(){return t.cm.curOp.selectionChanged=!0});function i(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,i))}this.polling.set(this.cm.options.pollInterval,i)},He.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},He.prototype.pollSelection=function(){if(!(this.readDOMTimeout!=null||this.gracePeriod||!this.selectionChanged())){var e=this.getSelection(),t=this.cm;if(a&&m&&this.cm.display.gutterSpecs.length&&qc(e.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus();return}if(!this.composing){this.rememberSelection();var i=eo(t,e.anchorNode,e.anchorOffset),r=eo(t,e.focusNode,e.focusOffset);i&&r&&Gt(t,function(){Lt(t.doc,ti(i,r),U),(i.bad||r.bad)&&(t.curOp.selectionChanged=!0)})}}},He.prototype.pollContent=function(){this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e=this.cm,t=e.display,i=e.doc.sel.primary(),r=i.from(),n=i.to();if(r.ch==0&&r.line>e.firstLine()&&(r=le(r.line-1,Se(e.doc,r.line-1).length)),n.ch==Se(e.doc,n.line).text.length&&n.line<e.lastLine()&&(n=le(n.line+1,0)),r.line<t.viewFrom||n.line>t.viewTo-1)return!1;var l,_,C;r.line==t.viewFrom||(l=mi(e,r.line))==0?(_=De(t.view[0].line),C=t.view[0].node):(_=De(t.view[l].line),C=t.view[l-1].node.nextSibling);var A=mi(e,n.line),R,W;if(A==t.view.length-1?(R=t.viewTo-1,W=t.lineDiv.lastChild):(R=De(t.view[A+1].line)-1,W=t.view[A+1].node.previousSibling),!C)return!1;for(var z=e.doc.splitLines(zc(e,C,W,_,R)),J=Dt(e.doc,le(_,0),le(R,Se(e.doc,R).text.length));z.length>1&&J.length>1;)if(Ee(z)==Ee(J))z.pop(),J.pop(),R--;else if(z[0]==J[0])z.shift(),J.shift(),_++;else break;for(var X=0,ee=0,ne=z[0],he=J[0],de=Math.min(ne.length,he.length);X<de&&ne.charCodeAt(X)==he.charCodeAt(X);)++X;for(var ye=Ee(z),pe=Ee(J),me=Math.min(ye.length-(z.length==1?X:0),pe.length-(J.length==1?X:0));ee<me&&ye.charCodeAt(ye.length-ee-1)==pe.charCodeAt(pe.length-ee-1);)++ee;if(z.length==1&&J.length==1&&_==r.line)for(;X&&X>r.ch&&ye.charCodeAt(ye.length-ee-1)==pe.charCodeAt(pe.length-ee-1);)X--,ee++;z[z.length-1]=ye.slice(0,ye.length-ee).replace(/^\u200b+/,""),z[0]=z[0].slice(X).replace(/\u200b+$/,"");var Ae=le(_,X),xe=le(R,J.length?Ee(J).length-ee:0);if(z.length>1||z[0]||O(Ae,xe))return Xi(e.doc,z,Ae,xe,"+input"),!0},He.prototype.ensurePolled=function(){this.forceCompositionEnd()},He.prototype.reset=function(){this.forceCompositionEnd()},He.prototype.forceCompositionEnd=function(){!this.composing||(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},He.prototype.readFromDOMSoon=function(){var e=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing)if(e.composing.done)e.composing=null;else return;e.updateFromDOM()},80))},He.prototype.updateFromDOM=function(){var e=this;(this.cm.isReadOnly()||!this.pollContent())&&Gt(this.cm,function(){return It(e.cm)})},He.prototype.setUneditable=function(e){e.contentEditable="false"},He.prototype.onKeyPress=function(e){e.charCode==0||this.composing||(e.preventDefault(),this.cm.isReadOnly()||st(this.cm,jo)(this.cm,String.fromCharCode(e.charCode==null?e.keyCode:e.charCode),0))},He.prototype.readOnlyChanged=function(e){this.div.contentEditable=String(e!="nocursor")},He.prototype.onContextMenu=function(){},He.prototype.resetPosition=function(){},He.prototype.needsContentAttribute=!0;function Da(e,t){var i=lo(e,t.line);if(!i||i.hidden)return null;var r=Se(e.doc,t.line),n=as(i,r,t.line),l=ut(r,e.doc.direction),_="left";if(l){var C=Ne(l,t.ch);_=C%2?"right":"left"}var A=us(n.map,t.ch,_);return A.offset=A.collapse=="right"?A.end:A.start,A}function qc(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function $i(e,t){return t&&(e.bad=!0),e}function zc(e,t,i,r,n){var l="",_=!1,C=e.doc.lineSeparator(),A=!1;function R(X){return function(ee){return ee.id==X}}function W(){_&&(l+=C,A&&(l+=C),_=A=!1)}function z(X){X&&(W(),l+=X)}function J(X){if(X.nodeType==1){var ee=X.getAttribute("cm-text");if(ee){z(ee);return}var ne=X.getAttribute("cm-marker"),he;if(ne){var de=e.findMarks(le(r,0),le(n+1,0),R(+ne));de.length&&(he=de[0].find(0))&&z(Dt(e.doc,he.from,he.to).join(C));return}if(X.getAttribute("contenteditable")=="false")return;var ye=/^(pre|div|p|li|table|br)$/i.test(X.nodeName);if(!/^br$/i.test(X.nodeName)&&X.textContent.length==0)return;ye&&W();for(var pe=0;pe<X.childNodes.length;pe++)J(X.childNodes[pe]);/^(pre|p)$/i.test(X.nodeName)&&(A=!0),ye&&(_=!0)}else X.nodeType==3&&z(X.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "))}for(;J(t),t!=i;)t=t.nextSibling,A=!1;return l}function eo(e,t,i){var r;if(t==e.display.lineDiv){if(r=e.display.lineDiv.childNodes[i],!r)return $i(e.clipPos(le(e.display.viewTo-1)),!0);t=null,i=0}else for(r=t;;r=r.parentNode){if(!r||r==e.display.lineDiv)return null;if(r.parentNode&&r.parentNode==e.display.lineDiv)break}for(var n=0;n<e.display.view.length;n++){var l=e.display.view[n];if(l.node==r)return Kc(l,t,i)}}function Kc(e,t,i){var r=e.text.firstChild,n=!1;if(!t||!j(r,t))return $i(le(De(e.line),0),!0);if(t==r&&(n=!0,t=r.childNodes[i],i=0,!t)){var l=e.rest?Ee(e.rest):e.line;return $i(le(De(l),l.text.length),n)}var _=t.nodeType==3?t:null,C=t;for(!_&&t.childNodes.length==1&&t.firstChild.nodeType==3&&(_=t.firstChild,i&&(i=_.nodeValue.length));C.parentNode!=r;)C=C.parentNode;var A=e.measure,R=A.maps;function W(he,de,ye){for(var pe=-1;pe<(R?R.length:0);pe++)for(var me=pe<0?A.map:R[pe],Ae=0;Ae<me.length;Ae+=3){var xe=me[Ae+2];if(xe==he||xe==de){var Re=De(pe<0?e.line:e.rest[pe]),We=me[Ae]+ye;return(ye<0||xe!=he)&&(We=me[Ae+(ye?1:0)]),le(Re,We)}}}var z=W(_,C,i);if(z)return $i(z,n);for(var J=C.nextSibling,X=_?_.nodeValue.length-i:0;J;J=J.nextSibling){if(z=W(J,J.firstChild,0),z)return $i(le(z.line,z.ch-X),n);X+=J.textContent.length}for(var ee=C.previousSibling,ne=i;ee;ee=ee.previousSibling){if(z=W(ee,ee.firstChild,-1),z)return $i(le(z.line,z.ch+ne),n);ne+=ee.textContent.length}}var Ve=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new we,this.hasSelection=!1,this.composing=null};Ve.prototype.init=function(e){var t=this,i=this,r=this.cm;this.createField(e);var n=this.textarea;e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),p&&(n.style.width="0px"),ke(n,"input",function(){k&&v>=9&&t.hasSelection&&(t.hasSelection=null),i.poll()}),ke(n,"paste",function(_){je(r,_)||Ea(_,r)||(r.state.pasteIncoming=+new Date,i.fastPoll())});function l(_){if(!je(r,_)){if(r.somethingSelected())Qn({lineWise:!1,text:r.getSelections()});else if(r.options.lineWiseCopyCut){var C=Ta(r);Qn({lineWise:!0,text:C.text}),_.type=="cut"?r.setSelections(C.ranges,null,U):(i.prevInput="",n.value=C.text.join(`
`),Z(n))}else return;_.type=="cut"&&(r.state.cutIncoming=+new Date)}}ke(n,"cut",l),ke(n,"copy",l),ke(e.scroller,"paste",function(_){if(!(Kr(e,_)||je(r,_))){if(!n.dispatchEvent){r.state.pasteIncoming=+new Date,i.focus();return}var C=new Event("paste");C.clipboardData=_.clipboardData,n.dispatchEvent(C)}}),ke(e.lineSpace,"selectstart",function(_){Kr(e,_)||Ye(_)}),ke(n,"compositionstart",function(){var _=r.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:_,range:r.markText(_,r.getCursor("to"),{className:"CodeMirror-composing"})}}),ke(n,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},Ve.prototype.createField=function(e){this.wrapper=Ra(),this.textarea=this.wrapper.firstChild},Ve.prototype.screenReaderLabelChanged=function(e){e?this.textarea.setAttribute("aria-label",e):this.textarea.removeAttribute("aria-label")},Ve.prototype.prepareSelection=function(){var e=this.cm,t=e.display,i=e.doc,r=Ss(e);if(e.options.moveInputWithCursor){var n=dr(e,i.sel.primary().head,"div"),l=t.wrapper.getBoundingClientRect(),_=t.lineDiv.getBoundingClientRect();r.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,n.top+_.top-l.top)),r.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,n.left+_.left-l.left))}return r},Ve.prototype.showSelection=function(e){var t=this.cm,i=t.display;L(i.cursorDiv,e.cursors),L(i.selectionDiv,e.selection),e.teTop!=null&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},Ve.prototype.reset=function(e){if(!(this.contextMenuPending||this.composing)){var t=this.cm;if(t.somethingSelected()){this.prevInput="";var i=t.getSelection();this.textarea.value=i,t.state.focused&&Z(this.textarea),k&&v>=9&&(this.hasSelection=i)}else e||(this.prevInput=this.textarea.value="",k&&v>=9&&(this.hasSelection=null))}},Ve.prototype.getField=function(){return this.textarea},Ve.prototype.supportsTouch=function(){return!1},Ve.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!s||I()!=this.textarea))try{this.textarea.focus()}catch{}},Ve.prototype.blur=function(){this.textarea.blur()},Ve.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Ve.prototype.receivedFocus=function(){this.slowPoll()},Ve.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},Ve.prototype.fastPoll=function(){var e=!1,t=this;t.pollingFast=!0;function i(){var r=t.poll();!r&&!e?(e=!0,t.polling.set(60,i)):(t.pollingFast=!1,t.slowPoll())}t.polling.set(20,i)},Ve.prototype.poll=function(){var e=this,t=this.cm,i=this.textarea,r=this.prevInput;if(this.contextMenuPending||!t.state.focused||Hr(i)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var n=i.value;if(n==r&&!t.somethingSelected())return!1;if(k&&v>=9&&this.hasSelection===n||o&&/[\uf700-\uf7ff]/.test(n))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var l=n.charCodeAt(0);if(l==8203&&!r&&(r="\u200B"),l==8666)return this.reset(),this.cm.execCommand("undo")}for(var _=0,C=Math.min(r.length,n.length);_<C&&r.charCodeAt(_)==n.charCodeAt(_);)++_;return Gt(t,function(){jo(t,n.slice(_),r.length-_,null,e.composing?"*compose":null),n.length>1e3||n.indexOf(`
`)>-1?i.value=e.prevInput="":e.prevInput=n,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Ve.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Ve.prototype.onKeyPress=function(){k&&v>=9&&(this.hasSelection=null),this.fastPoll()},Ve.prototype.onContextMenu=function(e){var t=this,i=t.cm,r=i.display,n=t.textarea;t.contextMenuPending&&t.contextMenuPending();var l=yi(i,e),_=r.scroller.scrollTop;if(!l||b)return;var C=i.options.resetSelectionOnContextMenu;C&&i.doc.sel.contains(l)==-1&&st(i,Lt)(i.doc,ti(l),U);var A=n.style.cssText,R=t.wrapper.style.cssText,W=t.wrapper.offsetParent.getBoundingClientRect();t.wrapper.style.cssText="position: static",n.style.cssText=`position: absolute; width: 30px; height: 30px;
      top: `+(e.clientY-W.top-5)+"px; left: "+(e.clientX-W.left-5)+`px;
      z-index: 1000; background: `+(k?"rgba(255, 255, 255, .05)":"transparent")+`;
      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`;var z;y&&(z=window.scrollY),r.input.focus(),y&&window.scrollTo(null,z),r.input.reset(),i.somethingSelected()||(n.value=t.prevInput=" "),t.contextMenuPending=X,r.selForContextMenu=i.doc.sel,clearTimeout(r.detectingSelectAll);function J(){if(n.selectionStart!=null){var ne=i.somethingSelected(),he="\u200B"+(ne?n.value:"");n.value="\u21DA",n.value=he,t.prevInput=ne?"":"\u200B",n.selectionStart=1,n.selectionEnd=he.length,r.selForContextMenu=i.doc.sel}}function X(){if(t.contextMenuPending==X&&(t.contextMenuPending=!1,t.wrapper.style.cssText=R,n.style.cssText=A,k&&v<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=_),n.selectionStart!=null)){(!k||k&&v<9)&&J();var ne=0,he=function(){r.selForContextMenu==i.doc.sel&&n.selectionStart==0&&n.selectionEnd>0&&t.prevInput=="\u200B"?st(i,Js)(i):ne++<10?r.detectingSelectAll=setTimeout(he,500):(r.selForContextMenu=null,r.input.reset())};r.detectingSelectAll=setTimeout(he,200)}}if(k&&v>=9&&J(),T){tr(e);var ee=function(){et(window,"mouseup",ee),setTimeout(X,20)};ke(window,"mouseup",ee)}else setTimeout(X,50)},Ve.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled=e=="nocursor",this.textarea.readOnly=!!e},Ve.prototype.setUneditable=function(){},Ve.prototype.needsContentAttribute=!1;function Gc(e,t){if(t=t?ae(t):{},t.value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),t.autofocus==null){var i=I();t.autofocus=i==e||e.getAttribute("autofocus")!=null&&i==document.body}function r(){e.value=C.getValue()}var n;if(e.form&&(ke(e.form,"submit",r),!t.leaveSubmitMethodAlone)){var l=e.form;n=l.submit;try{var _=l.submit=function(){r(),l.submit=n,l.submit(),l.submit=_}}catch{}}t.finishInit=function(A){A.save=r,A.getTextArea=function(){return e},A.toTextArea=function(){A.toTextArea=isNaN,r(),e.parentNode.removeChild(A.getWrapperElement()),e.style.display="",e.form&&(et(e.form,"submit",r),!t.leaveSubmitMethodAlone&&typeof e.form.submit=="function"&&(e.form.submit=n))}},e.style.display="none";var C=Ue(function(A){return e.parentNode.insertBefore(A,e.nextSibling)},t);return C}function Xc(e){e.off=et,e.on=ke,e.wheelEventPixels=ec,e.Doc=Ft,e.splitLines=mr,e.countColumn=Ce,e.findColumn=_e,e.isWordChar=Yt,e.Pass=N,e.signal=Te,e.Line=Kt,e.changeEnd=ri,e.scrollbarModel=Es,e.Pos=le,e.cmpPos=O,e.modes=yt,e.mimeModes=ht,e.resolveMode=ur,e.getMode=fr,e.modeExtensions=kt,e.extendMode=Et,e.copyState=dt,e.startState=Cr,e.innerMode=Sr,e.commands=wn,e.keyMap=Xr,e.keyName=da,e.isModifierKey=fa,e.lookupKey=Zi,e.normalizeKeyMap=Cc,e.StringStream=Fe,e.SharedTextMarker=bn,e.TextMarker=ni,e.LineWidget=mn,e.e_preventDefault=Ye,e.e_stopPropagation=cr,e.e_stop=tr,e.addClass=F,e.contains=j,e.rmClass=P,e.keyNames=oi}Fc(Ue),Uc(Ue);var Yc="iter insert remove copy getEditor constructor".split(" ");for(var to in Ft.prototype)Ft.prototype.hasOwnProperty(to)&&fe(Yc,to)<0&&(Ue.prototype[to]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ft.prototype[to]));return Rt(Ft),Ue.inputStyles={textarea:Ve,contenteditable:He},Ue.defineMode=function(e){!Ue.defaults.mode&&e!="null"&&(Ue.defaults.mode=e),Fr.apply(this,arguments)},Ue.defineMIME=qt,Ue.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),Ue.defineMIME("text/plain","null"),Ue.defineExtension=function(e,t){Ue.prototype[e]=t},Ue.defineDocExtension=function(e,t){Ft.prototype[e]=t},Ue.fromTextArea=Gc,Xc(Ue),Ue.version="5.65.0",Ue})});var Na=ki((Fa,Wa)=>{(function(oe){typeof Fa=="object"&&typeof Wa=="object"?oe(Ai()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],oe):oe(CodeMirror)})(function(oe){"use strict";oe.defineMode("javascript",function(V,Q){var ve=V.indentUnit,$=Q.statementIndent,h=Q.jsonld,k=Q.json||h,v=Q.trackScope!==!1,y=Q.typescript,w=Q.wordCharacters||/[\w$\xa1-\uffff]/,m=function(){function O(Je){return{type:Je,style:"keyword"}}var q=O("keyword a"),ie=O("keyword b"),ce=O("keyword c"),Me=O("keyword d"),Oe=O("operator"),ge={type:"atom",style:"atom"};return{if:O("if"),while:q,with:q,else:ie,do:ie,try:ie,finally:ie,return:Me,break:Me,continue:Me,new:O("new"),delete:ce,void:ce,throw:ce,debugger:O("debugger"),var:O("var"),const:O("var"),let:O("var"),function:O("function"),catch:O("catch"),for:O("for"),switch:O("switch"),case:O("case"),default:O("default"),in:Oe,typeof:Oe,instanceof:Oe,true:ge,false:ge,null:ge,undefined:ge,NaN:ge,Infinity:ge,this:O("this"),class:O("class"),super:O("atom"),yield:ce,export:O("export"),import:O("import"),extends:ce,await:ce}}(),b=/[+\-*&%=<>!?|~^@]/,S=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function u(O){for(var q=!1,ie,ce=!1;(ie=O.next())!=null;){if(!q){if(ie=="/"&&!ce)return;ie=="["?ce=!0:ce&&ie=="]"&&(ce=!1)}q=!q&&ie=="\\"}}var f,p;function a(O,q,ie){return f=O,p=ie,q}function s(O,q){var ie=O.next();if(ie=='"'||ie=="'")return q.tokenize=o(ie),q.tokenize(O,q);if(ie=="."&&O.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return a("number","number");if(ie=="."&&O.match(".."))return a("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(ie))return a(ie);if(ie=="="&&O.eat(">"))return a("=>","operator");if(ie=="0"&&O.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return a("number","number");if(/\d/.test(ie))return O.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),a("number","number");if(ie=="/")return O.eat("*")?(q.tokenize=c,c(O,q)):O.eat("/")?(O.skipToEnd(),a("comment","comment")):le(O,q,1)?(u(O),O.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),a("regexp","string-2")):(O.eat("="),a("operator","operator",O.current()));if(ie=="`")return q.tokenize=d,d(O,q);if(ie=="#"&&O.peek()=="!")return O.skipToEnd(),a("meta","meta");if(ie=="#"&&O.eatWhile(w))return a("variable","property");if(ie=="<"&&O.match("!--")||ie=="-"&&O.match("->")&&!/\S/.test(O.string.slice(0,O.start)))return O.skipToEnd(),a("comment","comment");if(b.test(ie))return(ie!=">"||!q.lexical||q.lexical.type!=">")&&(O.eat("=")?(ie=="!"||ie=="=")&&O.eat("="):/[<>*+\-|&?]/.test(ie)&&(O.eat(ie),ie==">"&&O.eat(ie))),ie=="?"&&O.eat(".")?a("."):a("operator","operator",O.current());if(w.test(ie)){O.eatWhile(w);var ce=O.current();if(q.lastType!="."){if(m.propertyIsEnumerable(ce)){var Me=m[ce];return a(Me.type,Me.style,ce)}if(ce=="async"&&O.match(/^(\s|\/\*([^*]|\*(?!\/))*?\*\/)*[\[\(\w]/,!1))return a("async","keyword",ce)}return a("variable","variable",ce)}}function o(O){return function(q,ie){var ce=!1,Me;if(h&&q.peek()=="@"&&q.match(S))return ie.tokenize=s,a("jsonld-keyword","meta");for(;(Me=q.next())!=null&&!(Me==O&&!ce);)ce=!ce&&Me=="\\";return ce||(ie.tokenize=s),a("string","string")}}function c(O,q){for(var ie=!1,ce;ce=O.next();){if(ce=="/"&&ie){q.tokenize=s;break}ie=ce=="*"}return a("comment","comment")}function d(O,q){for(var ie=!1,ce;(ce=O.next())!=null;){if(!ie&&(ce=="`"||ce=="$"&&O.eat("{"))){q.tokenize=s;break}ie=!ie&&ce=="\\"}return a("quasi","string-2",O.current())}var g="([{}])";function x(O,q){q.fatArrowAt&&(q.fatArrowAt=null);var ie=O.string.indexOf("=>",O.start);if(!(ie<0)){if(y){var ce=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(O.string.slice(O.start,ie));ce&&(ie=ce.index)}for(var Me=0,Oe=!1,ge=ie-1;ge>=0;--ge){var Je=O.string.charAt(ge),mt=g.indexOf(Je);if(mt>=0&&mt<3){if(!Me){++ge;break}if(--Me==0){Je=="("&&(Oe=!0);break}}else if(mt>=3&&mt<6)++Me;else if(w.test(Je))Oe=!0;else if(/["'\/`]/.test(Je))for(;;--ge){if(ge==0)return;var xr=O.string.charAt(ge-1);if(xr==Je&&O.string.charAt(ge-2)!="\\"){ge--;break}}else if(Oe&&!Me){++ge;break}}Oe&&!Me&&(q.fatArrowAt=ge)}}var T={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,import:!0,"jsonld-keyword":!0};function H(O,q,ie,ce,Me,Oe){this.indented=O,this.column=q,this.type=ie,this.prev=Me,this.info=Oe,ce!=null&&(this.align=ce)}function P(O,q){if(!v)return!1;for(var ie=O.localVars;ie;ie=ie.next)if(ie.name==q)return!0;for(var ce=O.context;ce;ce=ce.prev)for(var ie=ce.vars;ie;ie=ie.next)if(ie.name==q)return!0}function M(O,q,ie,ce,Me){var Oe=O.cc;for(L.state=O,L.stream=Me,L.marked=null,L.cc=Oe,L.style=q,O.lexical.hasOwnProperty("align")||(O.lexical.align=!0);;){var ge=Oe.length?Oe.pop():k?G:U;if(ge(ie,ce)){for(;Oe.length&&Oe[Oe.length-1].lex;)Oe.pop()();return L.marked?L.marked:ie=="variable"&&P(O,ce)?"variable-2":q}}}var L={state:null,column:null,marked:null,cc:null};function D(){for(var O=arguments.length-1;O>=0;O--)L.cc.push(arguments[O])}function E(){return D.apply(null,arguments),!0}function Y(O,q){for(var ie=q;ie;ie=ie.next)if(ie.name==O)return!0;return!1}function j(O){var q=L.state;if(L.marked="def",!!v){if(q.context){if(q.lexical.info=="var"&&q.context&&q.context.block){var ie=I(O,q.context);if(ie!=null){q.context=ie;return}}else if(!Y(O,q.localVars)){q.localVars=new Z(O,q.localVars);return}}Q.globalVars&&!Y(O,q.globalVars)&&(q.globalVars=new Z(O,q.globalVars))}}function I(O,q){if(q)if(q.block){var ie=I(O,q.prev);return ie?ie==q.prev?q:new K(ie,q.vars,!0):null}else return Y(O,q.vars)?q:new K(q.prev,new Z(O,q.vars),!1);else return null}function F(O){return O=="public"||O=="private"||O=="protected"||O=="abstract"||O=="readonly"}function K(O,q,ie){this.prev=O,this.vars=q,this.block=ie}function Z(O,q){this.name=O,this.next=q}var ue=new Z("this",new Z("arguments",null));function ae(){L.state.context=new K(L.state.context,L.state.localVars,!1),L.state.localVars=ue}function Ce(){L.state.context=new K(L.state.context,L.state.localVars,!0),L.state.localVars=null}function we(){L.state.localVars=L.state.context.vars,L.state.context=L.state.context.prev}we.lex=!0;function fe(O,q){var ie=function(){var ce=L.state,Me=ce.indented;if(ce.lexical.type=="stat")Me=ce.lexical.indented;else for(var Oe=ce.lexical;Oe&&Oe.type==")"&&Oe.align;Oe=Oe.prev)Me=Oe.indented;ce.lexical=new H(Me,L.stream.column(),O,null,ce.lexical,q)};return ie.lex=!0,ie}function B(){var O=L.state;O.lexical.prev&&(O.lexical.type==")"&&(O.indented=O.lexical.indented),O.lexical=O.lexical.prev)}B.lex=!0;function N(O){function q(ie){return ie==O?E():O==";"||ie=="}"||ie==")"||ie=="]"?D():E(q)}return q}function U(O,q){return O=="var"?E(fe("vardef",q),gr,N(";"),B):O=="keyword a"?E(fe("form"),Le,U,B):O=="keyword b"?E(fe("form"),U,B):O=="keyword d"?L.stream.match(/^\s*$/,!1)?E():E(fe("stat"),Ee,N(";"),B):O=="debugger"?E(N(";")):O=="{"?E(fe("}"),Ce,ut,B,we):O==";"?E():O=="if"?(L.state.lexical.info=="else"&&L.state.cc[L.state.cc.length-1]==B&&L.state.cc.pop()(),E(fe("form"),Le,U,B,Hr)):O=="function"?E(yt):O=="for"?E(fe("form"),Ce,Ir,U,we,B):O=="class"||y&&q=="interface"?(L.marked="keyword",E(fe("form",O=="class"?O:q),fr,B)):O=="variable"?y&&q=="declare"?(L.marked="keyword",E(U)):y&&(q=="module"||q=="enum"||q=="type")&&L.stream.match(/^\s*\w/,!1)?(L.marked="keyword",q=="enum"?E(Bt):q=="type"?E(Fr,N("operator"),Te,N(";")):E(fe("form"),tt,N("{"),fe("}"),ut,B,B)):y&&q=="namespace"?(L.marked="keyword",E(fe("form"),G,U,B)):y&&q=="abstract"?(L.marked="keyword",E(U)):E(fe("stat"),Dr):O=="switch"?E(fe("form"),Le,N("{"),fe("}","switch"),Ce,ut,B,B,we):O=="case"?E(G,N(":")):O=="default"?E(N(":")):O=="catch"?E(fe("form"),ae,se,U,B,we):O=="export"?E(fe("stat"),Sr,B):O=="import"?E(fe("stat"),Fe,B):O=="async"?E(U):q=="@"?E(G,U):D(fe("stat"),G,N(";"),B)}function se(O){if(O=="(")return E(qt,N(")"))}function G(O,q){return Be(O,q,!1)}function _e(O,q){return Be(O,q,!0)}function Le(O){return O!="("?D():E(fe(")"),Ee,N(")"),B)}function Be(O,q,ie){if(L.state.fatArrowAt==L.stream.start){var ce=ie?Yt:Mt;if(O=="(")return E(ae,fe(")"),Ne(qt,")"),B,N("=>"),ce,we);if(O=="variable")return D(ae,tt,N("=>"),ce,we)}var Me=ie?be:Ie;return T.hasOwnProperty(O)?E(Me):O=="function"?E(yt,Me):O=="class"||y&&q=="interface"?(L.marked="keyword",E(fe("form"),ur,B)):O=="keyword c"||O=="async"?E(ie?_e:G):O=="("?E(fe(")"),Ee,N(")"),B,Me):O=="operator"||O=="spread"?E(ie?_e:G):O=="["?E(fe("]"),De,B,Me):O=="{"?sr(Ut,"}",null,Me):O=="quasi"?D(qe,Me):O=="new"?E(_r(ie)):E()}function Ee(O){return O.match(/[;\}\)\],]/)?D():D(G)}function Ie(O,q){return O==","?E(Ee):be(O,q,!1)}function be(O,q,ie){var ce=ie==!1?Ie:be,Me=ie==!1?G:_e;if(O=="=>")return E(ae,ie?Yt:Mt,we);if(O=="operator")return/\+\+|--/.test(q)||y&&q=="!"?E(ce):y&&q=="<"&&L.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?E(fe(">"),Ne(Te,">"),B,ce):q=="?"?E(G,N(":"),Me):E(Me);if(O=="quasi")return D(qe,ce);if(O!=";"){if(O=="(")return sr(_e,")","call",ce);if(O==".")return E(Vr,ce);if(O=="[")return E(fe("]"),Ee,N("]"),B,ce);if(y&&q=="as")return L.marked="keyword",E(Te,ce);if(O=="regexp")return L.state.lastType=L.marked="operator",L.stream.backUp(L.stream.pos-L.stream.start-1),E(Me)}}function qe(O,q){return O!="quasi"?D():q.slice(q.length-2)!="${"?E(qe):E(Ee,_t)}function _t(O){if(O=="}")return L.marked="string-2",L.state.tokenize=d,E(qe)}function Mt(O){return x(L.stream,L.state),D(O=="{"?U:G)}function Yt(O){return x(L.stream,L.state),D(O=="{"?U:_e)}function _r(O){return function(q){return q=="."?E(O?li:Zr):q=="variable"&&y?E(tr,O?be:Ie):D(O?_e:G)}}function Zr(O,q){if(q=="target")return L.marked="keyword",E(Ie)}function li(O,q){if(q=="target")return L.marked="keyword",E(be)}function Dr(O){return O==":"?E(B,U):D(Ie,N(";"),B)}function Vr(O){if(O=="variable")return L.marked="property",E()}function Ut(O,q){if(O=="async")return L.marked="property",E(Ut);if(O=="variable"||L.style=="keyword"){if(L.marked="property",q=="get"||q=="set")return E(ci);var ie;return y&&L.state.fatArrowAt==L.stream.start&&(ie=L.stream.match(/^\s*:\s*/,!1))&&(L.state.fatArrowAt=L.stream.pos+ie[0].length),E(gt)}else{if(O=="number"||O=="string")return L.marked=h?"property":L.style+" property",E(gt);if(O=="jsonld-keyword")return E(gt);if(y&&F(q))return L.marked="keyword",E(Ut);if(O=="[")return E(G,Zt,N("]"),gt);if(O=="spread")return E(_e,gt);if(q=="*")return L.marked="keyword",E(Ut);if(O==":")return D(gt)}}function ci(O){return O!="variable"?D(gt):(L.marked="property",E(yt))}function gt(O){if(O==":")return E(_e);if(O=="(")return D(yt)}function Ne(O,q,ie){function ce(Me,Oe){if(ie?ie.indexOf(Me)>-1:Me==","){var ge=L.state.lexical;return ge.info=="call"&&(ge.pos=(ge.pos||0)+1),E(function(Je,mt){return Je==q||mt==q?D():D(O)},ce)}return Me==q||Oe==q?E():ie&&ie.indexOf(";")>-1?D(O):E(N(q))}return function(Me,Oe){return Me==q||Oe==q?E():D(O,ce)}}function sr(O,q,ie){for(var ce=3;ce<arguments.length;ce++)L.cc.push(arguments[ce]);return E(fe(q,ie),Ne(O,q),B)}function ut(O){return O=="}"?E():D(U,ut)}function Zt(O,q){if(y){if(O==":")return E(Te);if(q=="?")return E(Zt)}}function ke(O,q){if(y&&(O==":"||q=="in"))return E(Te)}function ar(O){if(y&&O==":")return L.stream.match(/^\s*\w+\s+is\b/,!1)?E(G,et,Te):E(Te)}function et(O,q){if(q=="is")return L.marked="keyword",E()}function Te(O,q){if(q=="keyof"||q=="typeof"||q=="infer"||q=="readonly")return L.marked="keyword",E(q=="typeof"?_e:Te);if(O=="variable"||q=="void")return L.marked="type",E(ft);if(q=="|"||q=="&")return E(Te);if(O=="string"||O=="number"||O=="atom")return E(ft);if(O=="[")return E(fe("]"),Ne(Te,"]",","),B,ft);if(O=="{")return E(fe("}"),lr,B,ft);if(O=="(")return E(Ne(cr,")"),je,ft);if(O=="<")return E(Ne(Te,">"),Te);if(O=="quasi")return D(Rt,ft)}function je(O){if(O=="=>")return E(Te)}function lr(O){return O.match(/[\}\)\]]/)?E():O==","||O==";"?E(lr):D(Ke,lr)}function Ke(O,q){if(O=="variable"||L.style=="keyword")return L.marked="property",E(Ke);if(q=="?"||O=="number"||O=="string")return E(Ke);if(O==":")return E(Te);if(O=="[")return E(N("variable"),ke,N("]"),Ke);if(O=="(")return D(ht,Ke);if(!O.match(/[;\}\)\],]/))return E()}function Rt(O,q){return O!="quasi"?D():q.slice(q.length-2)!="${"?E(Rt):E(Te,Ye)}function Ye(O){if(O=="}")return L.marked="string-2",L.state.tokenize=d,E(Rt)}function cr(O,q){return O=="variable"&&L.stream.match(/^\s*[?:]/,!1)||q=="?"?E(cr):O==":"?E(Te):O=="spread"?E(cr):D(Te)}function ft(O,q){if(q=="<")return E(fe(">"),Ne(Te,">"),B,ft);if(q=="|"||O=="."||q=="&")return E(Te);if(O=="[")return E(Te,N("]"),ft);if(q=="extends"||q=="implements")return L.marked="keyword",E(Te);if(q=="?")return E(Te,N(":"),Te)}function tr(O,q){if(q=="<")return E(fe(">"),Ne(Te,">"),B,ft)}function Vt(){return D(Te,Br)}function Br(O,q){if(q=="=")return E(Te)}function gr(O,q){return q=="enum"?(L.marked="keyword",E(Bt)):D(tt,Zt,Ot,mr)}function tt(O,q){if(y&&F(q))return L.marked="keyword",E(tt);if(O=="variable")return j(q),E();if(O=="spread")return E(tt);if(O=="[")return sr(yr,"]");if(O=="{")return sr(Pr,"}")}function Pr(O,q){return O=="variable"&&!L.stream.match(/^\s*:/,!1)?(j(q),E(Ot)):(O=="variable"&&(L.marked="property"),O=="spread"?E(tt):O=="}"?D():O=="["?E(G,N("]"),N(":"),Pr):E(N(":"),tt,Ot))}function yr(){return D(tt,Ot)}function Ot(O,q){if(q=="=")return E(_e)}function mr(O){if(O==",")return E(gr)}function Hr(O,q){if(O=="keyword b"&&q=="else")return E(fe("form","else"),U,B)}function Ir(O,q){if(q=="await")return E(Ir);if(O=="(")return E(fe(")"),br,B)}function br(O){return O=="var"?E(gr,Jt):O=="variable"?E(Jt):D(Jt)}function Jt(O,q){return O==")"?E():O==";"?E(Jt):q=="in"||q=="of"?(L.marked="keyword",E(G,Jt)):D(G,Jt)}function yt(O,q){if(q=="*")return L.marked="keyword",E(yt);if(O=="variable")return j(q),E(yt);if(O=="(")return E(ae,fe(")"),Ne(qt,")"),B,ar,U,we);if(y&&q=="<")return E(fe(">"),Ne(Vt,">"),B,yt)}function ht(O,q){if(q=="*")return L.marked="keyword",E(ht);if(O=="variable")return j(q),E(ht);if(O=="(")return E(ae,fe(")"),Ne(qt,")"),B,ar,we);if(y&&q=="<")return E(fe(">"),Ne(Vt,">"),B,ht)}function Fr(O,q){if(O=="keyword"||O=="variable")return L.marked="type",E(Fr);if(q=="<")return E(fe(">"),Ne(Vt,">"),B)}function qt(O,q){return q=="@"&&E(G,qt),O=="spread"?E(qt):y&&F(q)?(L.marked="keyword",E(qt)):y&&O=="this"?E(Zt,Ot):D(tt,Zt,Ot)}function ur(O,q){return O=="variable"?fr(O,q):kt(O,q)}function fr(O,q){if(O=="variable")return j(q),E(kt)}function kt(O,q){if(q=="<")return E(fe(">"),Ne(Vt,">"),B,kt);if(q=="extends"||q=="implements"||y&&O==",")return q=="implements"&&(L.marked="keyword"),E(y?Te:G,kt);if(O=="{")return E(fe("}"),Et,B)}function Et(O,q){if(O=="async"||O=="variable"&&(q=="static"||q=="get"||q=="set"||y&&F(q))&&L.stream.match(/^\s+[\w$\xa1-\uffff]/,!1))return L.marked="keyword",E(Et);if(O=="variable"||L.style=="keyword")return L.marked="property",E(dt,Et);if(O=="number"||O=="string")return E(dt,Et);if(O=="[")return E(G,Zt,N("]"),dt,Et);if(q=="*")return L.marked="keyword",E(Et);if(y&&O=="(")return D(ht,Et);if(O==";"||O==",")return E(Et);if(O=="}")return E();if(q=="@")return E(G,Et)}function dt(O,q){if(q=="!"||q=="?")return E(dt);if(O==":")return E(Te,Ot);if(q=="=")return E(_e);var ie=L.state.lexical.prev,ce=ie&&ie.info=="interface";return D(ce?ht:yt)}function Sr(O,q){return q=="*"?(L.marked="keyword",E(nt,N(";"))):q=="default"?(L.marked="keyword",E(G,N(";"))):O=="{"?E(Ne(Cr,"}"),nt,N(";")):D(U)}function Cr(O,q){if(q=="as")return L.marked="keyword",E(N("variable"));if(O=="variable")return D(_e,Cr)}function Fe(O){return O=="string"?E():O=="("?D(G):O=="."?D(Ie):D(Se,Dt,nt)}function Se(O,q){return O=="{"?sr(Se,"}"):(O=="variable"&&j(q),q=="*"&&(L.marked="keyword"),E(wr))}function Dt(O){if(O==",")return E(Se,Dt)}function wr(O,q){if(q=="as")return L.marked="keyword",E(Se)}function nt(O,q){if(q=="from")return L.marked="keyword",E(G)}function De(O){return O=="]"?E():D(Ne(_e,"]"))}function Bt(){return D(fe("form"),tt,N("{"),fe("}"),Ne(rr,"}"),B,B)}function rr(){return D(tt,Ot)}function Lr(O,q){return O.lastType=="operator"||O.lastType==","||b.test(q.charAt(0))||/[,.]/.test(q.charAt(0))}function le(O,q,ie){return q.tokenize==s&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(q.lastType)||q.lastType=="quasi"&&/\{\s*$/.test(O.string.slice(0,O.pos-(ie||0)))}return{startState:function(O){var q={tokenize:s,lastType:"sof",cc:[],lexical:new H((O||0)-ve,0,"block",!1),localVars:Q.localVars,context:Q.localVars&&new K(null,null,!1),indented:O||0};return Q.globalVars&&typeof Q.globalVars=="object"&&(q.globalVars=Q.globalVars),q},token:function(O,q){if(O.sol()&&(q.lexical.hasOwnProperty("align")||(q.lexical.align=!1),q.indented=O.indentation(),x(O,q)),q.tokenize!=c&&O.eatSpace())return null;var ie=q.tokenize(O,q);return f=="comment"?ie:(q.lastType=f=="operator"&&(p=="++"||p=="--")?"incdec":f,M(q,ie,f,p,O))},indent:function(O,q){if(O.tokenize==c||O.tokenize==d)return oe.Pass;if(O.tokenize!=s)return 0;var ie=q&&q.charAt(0),ce=O.lexical,Me;if(!/^\s*else\b/.test(q))for(var Oe=O.cc.length-1;Oe>=0;--Oe){var ge=O.cc[Oe];if(ge==B)ce=ce.prev;else if(ge!=Hr&&ge!=we)break}for(;(ce.type=="stat"||ce.type=="form")&&(ie=="}"||(Me=O.cc[O.cc.length-1])&&(Me==Ie||Me==be)&&!/^[,\.=+\-*:?[\(]/.test(q));)ce=ce.prev;$&&ce.type==")"&&ce.prev.type=="stat"&&(ce=ce.prev);var Je=ce.type,mt=ie==Je;return Je=="vardef"?ce.indented+(O.lastType=="operator"||O.lastType==","?ce.info.length+1:0):Je=="form"&&ie=="{"?ce.indented:Je=="form"?ce.indented+ve:Je=="stat"?ce.indented+(Lr(O,q)?$||ve:0):ce.info=="switch"&&!mt&&Q.doubleIndentSwitch!=!1?ce.indented+(/^(?:case|default)\b/.test(q)?ve:2*ve):ce.align?ce.column+(mt?0:1):ce.indented+(mt?0:ve)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:k?null:"/*",blockCommentEnd:k?null:"*/",blockCommentContinue:k?null:" * ",lineComment:k?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:k?"json":"javascript",jsonldMode:h,jsonMode:k,expressionAllowed:le,skipExpression:function(O){M(O,"atom","atom","true",new oe.StringStream("",2,null))}}}),oe.registerHelper("wordChars","javascript",/[\w$]/),oe.defineMIME("text/javascript","javascript"),oe.defineMIME("text/ecmascript","javascript"),oe.defineMIME("application/javascript","javascript"),oe.defineMIME("application/x-javascript","javascript"),oe.defineMIME("application/ecmascript","javascript"),oe.defineMIME("application/json",{name:"javascript",json:!0}),oe.defineMIME("application/x-json",{name:"javascript",json:!0}),oe.defineMIME("application/manifest+json",{name:"javascript",json:!0}),oe.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),oe.defineMIME("text/typescript",{name:"javascript",typescript:!0}),oe.defineMIME("application/typescript",{name:"javascript",typescript:!0})})});var Ka=ki((qa,za)=>{(function(oe){typeof qa=="object"&&typeof za=="object"?oe(Ai()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],oe):oe(CodeMirror)})(function(oe){"use strict";oe.defineMode("perl",function(){var h={"->":4,"++":4,"--":4,"**":4,"=~":4,"!~":4,"*":4,"/":4,"%":4,x:4,"+":4,"-":4,".":4,"<<":4,">>":4,"<":4,">":4,"<=":4,">=":4,lt:4,gt:4,le:4,ge:4,"==":4,"!=":4,"<=>":4,eq:4,ne:4,cmp:4,"~~":4,"&":4,"|":4,"^":4,"&&":4,"||":4,"//":4,"..":4,"...":4,"?":4,":":4,"=":4,"+=":4,"-=":4,"*=":4,",":4,"=>":4,"::":4,not:4,and:4,or:4,xor:4,BEGIN:[5,1],END:[5,1],PRINT:[5,1],PRINTF:[5,1],GETC:[5,1],READ:[5,1],READLINE:[5,1],DESTROY:[5,1],TIE:[5,1],TIEHANDLE:[5,1],UNTIE:[5,1],STDIN:5,STDIN_TOP:5,STDOUT:5,STDOUT_TOP:5,STDERR:5,STDERR_TOP:5,$ARG:5,$_:5,"@ARG":5,"@_":5,$LIST_SEPARATOR:5,'$"':5,$PROCESS_ID:5,$PID:5,$$:5,$REAL_GROUP_ID:5,$GID:5,"$(":5,$EFFECTIVE_GROUP_ID:5,$EGID:5,"$)":5,$PROGRAM_NAME:5,$0:5,$SUBSCRIPT_SEPARATOR:5,$SUBSEP:5,"$;":5,$REAL_USER_ID:5,$UID:5,"$<":5,$EFFECTIVE_USER_ID:5,$EUID:5,"$>":5,$a:5,$b:5,$COMPILING:5,"$^C":5,$DEBUGGING:5,"$^D":5,"${^ENCODING}":5,$ENV:5,"%ENV":5,$SYSTEM_FD_MAX:5,"$^F":5,"@F":5,"${^GLOBAL_PHASE}":5,"$^H":5,"%^H":5,"@INC":5,"%INC":5,$INPLACE_EDIT:5,"$^I":5,"$^M":5,$OSNAME:5,"$^O":5,"${^OPEN}":5,$PERLDB:5,"$^P":5,$SIG:5,"%SIG":5,$BASETIME:5,"$^T":5,"${^TAINT}":5,"${^UNICODE}":5,"${^UTF8CACHE}":5,"${^UTF8LOCALE}":5,$PERL_VERSION:5,"$^V":5,"${^WIN32_SLOPPY_STAT}":5,$EXECUTABLE_NAME:5,"$^X":5,$1:5,$MATCH:5,"$&":5,"${^MATCH}":5,$PREMATCH:5,"$`":5,"${^PREMATCH}":5,$POSTMATCH:5,"$'":5,"${^POSTMATCH}":5,$LAST_PAREN_MATCH:5,"$+":5,$LAST_SUBMATCH_RESULT:5,"$^N":5,"@LAST_MATCH_END":5,"@+":5,"%LAST_PAREN_MATCH":5,"%+":5,"@LAST_MATCH_START":5,"@-":5,"%LAST_MATCH_START":5,"%-":5,$LAST_REGEXP_CODE_RESULT:5,"$^R":5,"${^RE_DEBUG_FLAGS}":5,"${^RE_TRIE_MAXBUF}":5,$ARGV:5,"@ARGV":5,ARGV:5,ARGVOUT:5,$OUTPUT_FIELD_SEPARATOR:5,$OFS:5,"$,":5,$INPUT_LINE_NUMBER:5,$NR:5,"$.":5,$INPUT_RECORD_SEPARATOR:5,$RS:5,"$/":5,$OUTPUT_RECORD_SEPARATOR:5,$ORS:5,"$\\":5,$OUTPUT_AUTOFLUSH:5,"$|":5,$ACCUMULATOR:5,"$^A":5,$FORMAT_FORMFEED:5,"$^L":5,$FORMAT_PAGE_NUMBER:5,"$%":5,$FORMAT_LINES_LEFT:5,"$-":5,$FORMAT_LINE_BREAK_CHARACTERS:5,"$:":5,$FORMAT_LINES_PER_PAGE:5,"$=":5,$FORMAT_TOP_NAME:5,"$^":5,$FORMAT_NAME:5,"$~":5,"${^CHILD_ERROR_NATIVE}":5,$EXTENDED_OS_ERROR:5,"$^E":5,$EXCEPTIONS_BEING_CAUGHT:5,"$^S":5,$WARNING:5,"$^W":5,"${^WARNING_BITS}":5,$OS_ERROR:5,$ERRNO:5,"$!":5,"%OS_ERROR":5,"%ERRNO":5,"%!":5,$CHILD_ERROR:5,"$?":5,$EVAL_ERROR:5,"$@":5,$OFMT:5,"$#":5,"$*":5,$ARRAY_BASE:5,"$[":5,$OLD_PERL_VERSION:5,"$]":5,if:[1,1],elsif:[1,1],else:[1,1],while:[1,1],unless:[1,1],for:[1,1],foreach:[1,1],abs:1,accept:1,alarm:1,atan2:1,bind:1,binmode:1,bless:1,bootstrap:1,break:1,caller:1,chdir:1,chmod:1,chomp:1,chop:1,chown:1,chr:1,chroot:1,close:1,closedir:1,connect:1,continue:[1,1],cos:1,crypt:1,dbmclose:1,dbmopen:1,default:1,defined:1,delete:1,die:1,do:1,dump:1,each:1,endgrent:1,endhostent:1,endnetent:1,endprotoent:1,endpwent:1,endservent:1,eof:1,eval:1,exec:1,exists:1,exit:1,exp:1,fcntl:1,fileno:1,flock:1,fork:1,format:1,formline:1,getc:1,getgrent:1,getgrgid:1,getgrnam:1,gethostbyaddr:1,gethostbyname:1,gethostent:1,getlogin:1,getnetbyaddr:1,getnetbyname:1,getnetent:1,getpeername:1,getpgrp:1,getppid:1,getpriority:1,getprotobyname:1,getprotobynumber:1,getprotoent:1,getpwent:1,getpwnam:1,getpwuid:1,getservbyname:1,getservbyport:1,getservent:1,getsockname:1,getsockopt:1,given:1,glob:1,gmtime:1,goto:1,grep:1,hex:1,import:1,index:1,int:1,ioctl:1,join:1,keys:1,kill:1,last:1,lc:1,lcfirst:1,length:1,link:1,listen:1,local:2,localtime:1,lock:1,log:1,lstat:1,m:null,map:1,mkdir:1,msgctl:1,msgget:1,msgrcv:1,msgsnd:1,my:2,new:1,next:1,no:1,oct:1,open:1,opendir:1,ord:1,our:2,pack:1,package:1,pipe:1,pop:1,pos:1,print:1,printf:1,prototype:1,push:1,q:null,qq:null,qr:null,quotemeta:null,qw:null,qx:null,rand:1,read:1,readdir:1,readline:1,readlink:1,readpipe:1,recv:1,redo:1,ref:1,rename:1,require:1,reset:1,return:1,reverse:1,rewinddir:1,rindex:1,rmdir:1,s:null,say:1,scalar:1,seek:1,seekdir:1,select:1,semctl:1,semget:1,semop:1,send:1,setgrent:1,sethostent:1,setnetent:1,setpgrp:1,setpriority:1,setprotoent:1,setpwent:1,setservent:1,setsockopt:1,shift:1,shmctl:1,shmget:1,shmread:1,shmwrite:1,shutdown:1,sin:1,sleep:1,socket:1,socketpair:1,sort:1,splice:1,split:1,sprintf:1,sqrt:1,srand:1,stat:1,state:1,study:1,sub:1,substr:1,symlink:1,syscall:1,sysopen:1,sysread:1,sysseek:1,system:1,syswrite:1,tell:1,telldir:1,tie:1,tied:1,time:1,times:1,tr:null,truncate:1,uc:1,ucfirst:1,umask:1,undef:1,unlink:1,unpack:1,unshift:1,untie:1,use:1,utime:1,values:1,vec:1,wait:1,waitpid:1,wantarray:1,warn:1,when:1,write:1,y:null},k="string-2",v=/[goseximacplud]/;function y(b,S,u,f,p){return S.chain=null,S.style=null,S.tail=null,S.tokenize=function(a,s){for(var o=!1,c,d=0;c=a.next();){if(c===u[d]&&!o)return u[++d]!==void 0?(s.chain=u[d],s.style=f,s.tail=p):p&&a.eatWhile(p),s.tokenize=m,f;o=!o&&c=="\\"}return f},S.tokenize(b,S)}function w(b,S,u){return S.tokenize=function(f,p){return f.string==u&&(p.tokenize=m),f.skipToEnd(),"string"},S.tokenize(b,S)}function m(b,S){if(b.eatSpace())return null;if(S.chain)return y(b,S,S.chain,S.style,S.tail);if(b.match(/^\-?[\d\.]/,!1)&&b.match(/^(\-?(\d*\.\d+(e[+-]?\d+)?|\d+\.\d*)|0x[\da-fA-F]+|0b[01]+|\d+(e[+-]?\d+)?)/))return"number";if(b.match(/^<<(?=[_a-zA-Z])/))return b.eatWhile(/\w/),w(b,S,b.current().substr(2));if(b.sol()&&b.match(/^\=item(?!\w)/))return w(b,S,"=cut");var u=b.next();if(u=='"'||u=="'"){if(Q(b,3)=="<<"+u){var f=b.pos;b.eatWhile(/\w/);var p=b.current().substr(1);if(p&&b.eat(u))return w(b,S,p);b.pos=f}return y(b,S,[u],"string")}if(u=="q"){var a=V(b,-2);if(!(a&&/\w/.test(a))){if(a=V(b,0),a=="x"){if(a=V(b,1),a=="(")return $(b,2),y(b,S,[")"],k,v);if(a=="[")return $(b,2),y(b,S,["]"],k,v);if(a=="{")return $(b,2),y(b,S,["}"],k,v);if(a=="<")return $(b,2),y(b,S,[">"],k,v);if(/[\^'"!~\/]/.test(a))return $(b,1),y(b,S,[b.eat(a)],k,v)}else if(a=="q"){if(a=V(b,1),a=="(")return $(b,2),y(b,S,[")"],"string");if(a=="[")return $(b,2),y(b,S,["]"],"string");if(a=="{")return $(b,2),y(b,S,["}"],"string");if(a=="<")return $(b,2),y(b,S,[">"],"string");if(/[\^'"!~\/]/.test(a))return $(b,1),y(b,S,[b.eat(a)],"string")}else if(a=="w"){if(a=V(b,1),a=="(")return $(b,2),y(b,S,[")"],"bracket");if(a=="[")return $(b,2),y(b,S,["]"],"bracket");if(a=="{")return $(b,2),y(b,S,["}"],"bracket");if(a=="<")return $(b,2),y(b,S,[">"],"bracket");if(/[\^'"!~\/]/.test(a))return $(b,1),y(b,S,[b.eat(a)],"bracket")}else if(a=="r"){if(a=V(b,1),a=="(")return $(b,2),y(b,S,[")"],k,v);if(a=="[")return $(b,2),y(b,S,["]"],k,v);if(a=="{")return $(b,2),y(b,S,["}"],k,v);if(a=="<")return $(b,2),y(b,S,[">"],k,v);if(/[\^'"!~\/]/.test(a))return $(b,1),y(b,S,[b.eat(a)],k,v)}else if(/[\^'"!~\/(\[{<]/.test(a)){if(a=="(")return $(b,1),y(b,S,[")"],"string");if(a=="[")return $(b,1),y(b,S,["]"],"string");if(a=="{")return $(b,1),y(b,S,["}"],"string");if(a=="<")return $(b,1),y(b,S,[">"],"string");if(/[\^'"!~\/]/.test(a))return y(b,S,[b.eat(a)],"string")}}}if(u=="m"){var a=V(b,-2);if(!(a&&/\w/.test(a))&&(a=b.eat(/[(\[{<\^'"!~\/]/),a)){if(/[\^'"!~\/]/.test(a))return y(b,S,[a],k,v);if(a=="(")return y(b,S,[")"],k,v);if(a=="[")return y(b,S,["]"],k,v);if(a=="{")return y(b,S,["}"],k,v);if(a=="<")return y(b,S,[">"],k,v)}}if(u=="s"){var a=/[\/>\]})\w]/.test(V(b,-2));if(!a&&(a=b.eat(/[(\[{<\^'"!~\/]/),a))return a=="["?y(b,S,["]","]"],k,v):a=="{"?y(b,S,["}","}"],k,v):a=="<"?y(b,S,[">",">"],k,v):a=="("?y(b,S,[")",")"],k,v):y(b,S,[a,a],k,v)}if(u=="y"){var a=/[\/>\]})\w]/.test(V(b,-2));if(!a&&(a=b.eat(/[(\[{<\^'"!~\/]/),a))return a=="["?y(b,S,["]","]"],k,v):a=="{"?y(b,S,["}","}"],k,v):a=="<"?y(b,S,[">",">"],k,v):a=="("?y(b,S,[")",")"],k,v):y(b,S,[a,a],k,v)}if(u=="t"){var a=/[\/>\]})\w]/.test(V(b,-2));if(!a&&(a=b.eat("r"),a&&(a=b.eat(/[(\[{<\^'"!~\/]/),a)))return a=="["?y(b,S,["]","]"],k,v):a=="{"?y(b,S,["}","}"],k,v):a=="<"?y(b,S,[">",">"],k,v):a=="("?y(b,S,[")",")"],k,v):y(b,S,[a,a],k,v)}if(u=="`")return y(b,S,[u],"variable-2");if(u=="/")return/~\s*$/.test(Q(b))?y(b,S,[u],k,v):"operator";if(u=="$"){var f=b.pos;if(b.eatWhile(/\d/)||b.eat("{")&&b.eatWhile(/\d/)&&b.eat("}"))return"variable-2";b.pos=f}if(/[$@%]/.test(u)){var f=b.pos;if(b.eat("^")&&b.eat(/[A-Z]/)||!/[@$%&]/.test(V(b,-2))&&b.eat(/[=|\\\-#?@;:&`~\^!\[\]*'"$+.,\/<>()]/)){var a=b.current();if(h[a])return"variable-2"}b.pos=f}if(/[$@%&]/.test(u)&&(b.eatWhile(/[\w$]/)||b.eat("{")&&b.eatWhile(/[\w$]/)&&b.eat("}"))){var a=b.current();return h[a]?"variable-2":"variable"}if(u=="#"&&V(b,-2)!="$")return b.skipToEnd(),"comment";if(/[:+\-\^*$&%@=<>!?|\/~\.]/.test(u)){var f=b.pos;if(b.eatWhile(/[:+\-\^*$&%@=<>!?|\/~\.]/),h[b.current()])return"operator";b.pos=f}if(u=="_"&&b.pos==1){if(ve(b,6)=="_END__")return y(b,S,["\0"],"comment");if(ve(b,7)=="_DATA__")return y(b,S,["\0"],"variable-2");if(ve(b,7)=="_C__")return y(b,S,["\0"],"string")}if(/\w/.test(u)){var f=b.pos;if(V(b,-2)=="{"&&(V(b,0)=="}"||b.eatWhile(/\w/)&&V(b,0)=="}"))return"string";b.pos=f}if(/[A-Z]/.test(u)){var s=V(b,-2),f=b.pos;if(b.eatWhile(/[A-Z_]/),/[\da-z]/.test(V(b,0)))b.pos=f;else{var a=h[b.current()];return a?(a[1]&&(a=a[0]),s!=":"?a==1?"keyword":a==2?"def":a==3?"atom":a==4?"operator":a==5?"variable-2":"meta":"meta"):"meta"}}if(/[a-zA-Z_]/.test(u)){var s=V(b,-2);b.eatWhile(/\w/);var a=h[b.current()];return a?(a[1]&&(a=a[0]),s!=":"?a==1?"keyword":a==2?"def":a==3?"atom":a==4?"operator":a==5?"variable-2":"meta":"meta"):"meta"}return null}return{startState:function(){return{tokenize:m,chain:null,style:null,tail:null}},token:function(b,S){return(S.tokenize||m)(b,S)},lineComment:"#"}}),oe.registerHelper("wordChars","perl",/[\w$]/),oe.defineMIME("text/x-perl","perl");function V(h,k){return h.string.charAt(h.pos+(k||0))}function Q(h,k){if(k){var v=h.pos-k;return h.string.substr(v>=0?v:0,k)}else return h.string.substr(0,h.pos-1)}function ve(h,k){var v=h.string.length,y=v-h.pos+1;return h.string.substr(h.pos,k&&k<v?k:y)}function $(h,k){var v=h.pos+k,y;v<=0?h.pos=0:v>=(y=h.string.length-1)?h.pos=y:h.pos=v}})});var Ya=ki((ro,Yo)=>{(function(oe,V){if(typeof ro=="object"&&typeof Yo=="object")Yo.exports=V();else if(typeof define=="function"&&define.amd)define([],V);else{var Q=V();for(var ve in Q)(typeof ro=="object"?ro:oe)[ve]=Q[ve]}})(self,function(){return(()=>{"use strict";var oe={4567:function($,h,k){var v,y=this&&this.__extends||(v=function(s,o){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g])},v(s,o)},function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function c(){this.constructor=s}v(s,o),s.prototype=o===null?Object.create(o):(c.prototype=o.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.AccessibilityManager=void 0;var w=k(9042),m=k(6114),b=k(9924),S=k(3656),u=k(844),f=k(5596),p=k(9631),a=function(s){function o(c,d){var g=s.call(this)||this;g._terminal=c,g._renderService=d,g._liveRegionLineCount=0,g._charsToConsume=[],g._charsToAnnounce="",g._accessibilityTreeRoot=document.createElement("div"),g._accessibilityTreeRoot.setAttribute("role","document"),g._accessibilityTreeRoot.classList.add("xterm-accessibility"),g._accessibilityTreeRoot.tabIndex=0,g._rowContainer=document.createElement("div"),g._rowContainer.setAttribute("role","list"),g._rowContainer.classList.add("xterm-accessibility-tree"),g._rowElements=[];for(var x=0;x<g._terminal.rows;x++)g._rowElements[x]=g._createAccessibilityTreeNode(),g._rowContainer.appendChild(g._rowElements[x]);if(g._topBoundaryFocusListener=function(T){return g._onBoundaryFocus(T,0)},g._bottomBoundaryFocusListener=function(T){return g._onBoundaryFocus(T,1)},g._rowElements[0].addEventListener("focus",g._topBoundaryFocusListener),g._rowElements[g._rowElements.length-1].addEventListener("focus",g._bottomBoundaryFocusListener),g._refreshRowsDimensions(),g._accessibilityTreeRoot.appendChild(g._rowContainer),g._renderRowsDebouncer=new b.TimeBasedDebouncer(g._renderRows.bind(g)),g._refreshRows(),g._liveRegion=document.createElement("div"),g._liveRegion.classList.add("live-region"),g._liveRegion.setAttribute("aria-live","assertive"),g._accessibilityTreeRoot.appendChild(g._liveRegion),!g._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");return g._terminal.element.insertAdjacentElement("afterbegin",g._accessibilityTreeRoot),g.register(g._renderRowsDebouncer),g.register(g._terminal.onResize(function(T){return g._onResize(T.rows)})),g.register(g._terminal.onRender(function(T){return g._refreshRows(T.start,T.end)})),g.register(g._terminal.onScroll(function(){return g._refreshRows()})),g.register(g._terminal.onA11yChar(function(T){return g._onChar(T)})),g.register(g._terminal.onLineFeed(function(){return g._onChar(`
`)})),g.register(g._terminal.onA11yTab(function(T){return g._onTab(T)})),g.register(g._terminal.onKey(function(T){return g._onKey(T.key)})),g.register(g._terminal.onBlur(function(){return g._clearLiveRegion()})),g.register(g._renderService.onDimensionsChange(function(){return g._refreshRowsDimensions()})),g._screenDprMonitor=new f.ScreenDprMonitor,g.register(g._screenDprMonitor),g._screenDprMonitor.setListener(function(){return g._refreshRowsDimensions()}),g.register((0,S.addDisposableDomListener)(window,"resize",function(){return g._refreshRowsDimensions()})),g}return y(o,s),o.prototype.dispose=function(){s.prototype.dispose.call(this),(0,p.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0},o.prototype._onBoundaryFocus=function(c,d){var g=c.target,x=this._rowElements[d===0?1:this._rowElements.length-2];if(g.getAttribute("aria-posinset")!==(d===0?"1":""+this._terminal.buffer.lines.length)&&c.relatedTarget===x){var T,H;if(d===0?(T=g,H=this._rowElements.pop(),this._rowContainer.removeChild(H)):(T=this._rowElements.shift(),H=g,this._rowContainer.removeChild(T)),T.removeEventListener("focus",this._topBoundaryFocusListener),H.removeEventListener("focus",this._bottomBoundaryFocusListener),d===0){var P=this._createAccessibilityTreeNode();this._rowElements.unshift(P),this._rowContainer.insertAdjacentElement("afterbegin",P)}else P=this._createAccessibilityTreeNode(),this._rowElements.push(P),this._rowContainer.appendChild(P);this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(d===0?-1:1),this._rowElements[d===0?1:this._rowElements.length-2].focus(),c.preventDefault(),c.stopImmediatePropagation()}},o.prototype._onResize=function(c){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var d=this._rowContainer.children.length;d<this._terminal.rows;d++)this._rowElements[d]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[d]);for(;this._rowElements.length>c;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},o.prototype._createAccessibilityTreeNode=function(){var c=document.createElement("div");return c.setAttribute("role","listitem"),c.tabIndex=-1,this._refreshRowDimensions(c),c},o.prototype._onTab=function(c){for(var d=0;d<c;d++)this._onChar(" ")},o.prototype._onChar=function(c){var d=this;this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==c&&(this._charsToAnnounce+=c):this._charsToAnnounce+=c,c===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=w.tooMuchOutput)),m.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(function(){d._accessibilityTreeRoot.appendChild(d._liveRegion)},0))},o.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,m.isMac&&(0,p.removeElementFromParent)(this._liveRegion)},o.prototype._onKey=function(c){this._clearLiveRegion(),this._charsToConsume.push(c)},o.prototype._refreshRows=function(c,d){this._renderRowsDebouncer.refresh(c,d,this._terminal.rows)},o.prototype._renderRows=function(c,d){for(var g=this._terminal.buffer,x=g.lines.length.toString(),T=c;T<=d;T++){var H=g.translateBufferLineToString(g.ydisp+T,!0),P=(g.ydisp+T+1).toString(),M=this._rowElements[T];M&&(H.length===0?M.innerText="\xA0":M.textContent=H,M.setAttribute("aria-posinset",P),M.setAttribute("aria-setsize",x))}this._announceCharacters()},o.prototype._refreshRowsDimensions=function(){if(this._renderService.dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var c=0;c<this._terminal.rows;c++)this._refreshRowDimensions(this._rowElements[c])}},o.prototype._refreshRowDimensions=function(c){c.style.height=this._renderService.dimensions.actualCellHeight+"px"},o.prototype._announceCharacters=function(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},o}(u.Disposable);h.AccessibilityManager=a},3614:($,h)=>{function k(m){return m.replace(/\r?\n/g,"\r")}function v(m,b){return b?"[200~"+m+"[201~":m}function y(m,b,S){m=v(m=k(m),S.decPrivateModes.bracketedPasteMode),S.triggerDataEvent(m,!0),b.value=""}function w(m,b,S){var u=S.getBoundingClientRect(),f=m.clientX-u.left-10,p=m.clientY-u.top-10;b.style.width="20px",b.style.height="20px",b.style.left=f+"px",b.style.top=p+"px",b.style.zIndex="1000",b.focus()}Object.defineProperty(h,"__esModule",{value:!0}),h.rightClickHandler=h.moveTextAreaUnderMouseCursor=h.paste=h.handlePasteEvent=h.copyHandler=h.bracketTextForPaste=h.prepareTextForTerminal=void 0,h.prepareTextForTerminal=k,h.bracketTextForPaste=v,h.copyHandler=function(m,b){m.clipboardData&&m.clipboardData.setData("text/plain",b.selectionText),m.preventDefault()},h.handlePasteEvent=function(m,b,S){m.stopPropagation(),m.clipboardData&&y(m.clipboardData.getData("text/plain"),b,S)},h.paste=y,h.moveTextAreaUnderMouseCursor=w,h.rightClickHandler=function(m,b,S,u,f){w(m,b,S),f&&u.rightClickSelect(m),b.value=u.selectionText,b.select()}},4774:($,h)=>{var k,v,y,w;function m(S){var u=S.toString(16);return u.length<2?"0"+u:u}function b(S,u){return S<u?(u+.05)/(S+.05):(S+.05)/(u+.05)}Object.defineProperty(h,"__esModule",{value:!0}),h.contrastRatio=h.toPaddedHex=h.rgba=h.rgb=h.css=h.color=h.channels=void 0,function(S){S.toCss=function(u,f,p,a){return a!==void 0?"#"+m(u)+m(f)+m(p)+m(a):"#"+m(u)+m(f)+m(p)},S.toRgba=function(u,f,p,a){return a===void 0&&(a=255),(u<<24|f<<16|p<<8|a)>>>0}}(k=h.channels||(h.channels={})),(v=h.color||(h.color={})).blend=function(S,u){var f=(255&u.rgba)/255;if(f===1)return{css:u.css,rgba:u.rgba};var p=u.rgba>>24&255,a=u.rgba>>16&255,s=u.rgba>>8&255,o=S.rgba>>24&255,c=S.rgba>>16&255,d=S.rgba>>8&255,g=o+Math.round((p-o)*f),x=c+Math.round((a-c)*f),T=d+Math.round((s-d)*f);return{css:k.toCss(g,x,T),rgba:k.toRgba(g,x,T)}},v.isOpaque=function(S){return(255&S.rgba)==255},v.ensureContrastRatio=function(S,u,f){var p=w.ensureContrastRatio(S.rgba,u.rgba,f);if(p)return w.toColor(p>>24&255,p>>16&255,p>>8&255)},v.opaque=function(S){var u=(255|S.rgba)>>>0,f=w.toChannels(u),p=f[0],a=f[1],s=f[2];return{css:k.toCss(p,a,s),rgba:u}},v.opacity=function(S,u){var f=Math.round(255*u),p=w.toChannels(S.rgba),a=p[0],s=p[1],o=p[2];return{css:k.toCss(a,s,o,f),rgba:k.toRgba(a,s,o,f)}},v.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]},(h.css||(h.css={})).toColor=function(S){switch(S.length){case 7:return{css:S,rgba:(parseInt(S.slice(1),16)<<8|255)>>>0};case 9:return{css:S,rgba:parseInt(S.slice(1),16)>>>0}}throw new Error("css.toColor: Unsupported css format")},function(S){function u(f,p,a){var s=f/255,o=p/255,c=a/255;return .2126*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))+.7152*(o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4))+.0722*(c<=.03928?c/12.92:Math.pow((c+.055)/1.055,2.4))}S.relativeLuminance=function(f){return u(f>>16&255,f>>8&255,255&f)},S.relativeLuminance2=u}(y=h.rgb||(h.rgb={})),function(S){function u(p,a,s){for(var o=p>>24&255,c=p>>16&255,d=p>>8&255,g=a>>24&255,x=a>>16&255,T=a>>8&255,H=b(y.relativeLuminance2(g,T,x),y.relativeLuminance2(o,c,d));H<s&&(g>0||x>0||T>0);)g-=Math.max(0,Math.ceil(.1*g)),x-=Math.max(0,Math.ceil(.1*x)),T-=Math.max(0,Math.ceil(.1*T)),H=b(y.relativeLuminance2(g,T,x),y.relativeLuminance2(o,c,d));return(g<<24|x<<16|T<<8|255)>>>0}function f(p,a,s){for(var o=p>>24&255,c=p>>16&255,d=p>>8&255,g=a>>24&255,x=a>>16&255,T=a>>8&255,H=b(y.relativeLuminance2(g,T,x),y.relativeLuminance2(o,c,d));H<s&&(g<255||x<255||T<255);)g=Math.min(255,g+Math.ceil(.1*(255-g))),x=Math.min(255,x+Math.ceil(.1*(255-x))),T=Math.min(255,T+Math.ceil(.1*(255-T))),H=b(y.relativeLuminance2(g,T,x),y.relativeLuminance2(o,c,d));return(g<<24|x<<16|T<<8|255)>>>0}S.ensureContrastRatio=function(p,a,s){var o=y.relativeLuminance(p>>8),c=y.relativeLuminance(a>>8);if(b(o,c)<s)return c<o?u(p,a,s):f(p,a,s)},S.reduceLuminance=u,S.increaseLuminance=f,S.toChannels=function(p){return[p>>24&255,p>>16&255,p>>8&255,255&p]},S.toColor=function(p,a,s){return{css:k.toCss(p,a,s),rgba:k.toRgba(p,a,s)}}}(w=h.rgba||(h.rgba={})),h.toPaddedHex=m,h.contrastRatio=b},7239:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ColorContrastCache=void 0;var k=function(){function v(){this._color={},this._rgba={}}return v.prototype.clear=function(){this._color={},this._rgba={}},v.prototype.setCss=function(y,w,m){this._rgba[y]||(this._rgba[y]={}),this._rgba[y][w]=m},v.prototype.getCss=function(y,w){return this._rgba[y]?this._rgba[y][w]:void 0},v.prototype.setColor=function(y,w,m){this._color[y]||(this._color[y]={}),this._color[y][w]=m},v.prototype.getColor=function(y,w){return this._color[y]?this._color[y][w]:void 0},v}();h.ColorContrastCache=k},5680:function($,h,k){var v=this&&this.__spreadArray||function(a,s,o){if(o||arguments.length===2)for(var c,d=0,g=s.length;d<g;d++)!c&&d in s||(c||(c=Array.prototype.slice.call(s,0,d)),c[d]=s[d]);return a.concat(c||Array.prototype.slice.call(s))};Object.defineProperty(h,"__esModule",{value:!0}),h.ColorManager=h.DEFAULT_ANSI_COLORS=void 0;var y=k(4774),w=k(7239),m=y.css.toColor("#ffffff"),b=y.css.toColor("#000000"),S=y.css.toColor("#ffffff"),u=y.css.toColor("#000000"),f={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};h.DEFAULT_ANSI_COLORS=Object.freeze(function(){for(var a=[y.css.toColor("#2e3436"),y.css.toColor("#cc0000"),y.css.toColor("#4e9a06"),y.css.toColor("#c4a000"),y.css.toColor("#3465a4"),y.css.toColor("#75507b"),y.css.toColor("#06989a"),y.css.toColor("#d3d7cf"),y.css.toColor("#555753"),y.css.toColor("#ef2929"),y.css.toColor("#8ae234"),y.css.toColor("#fce94f"),y.css.toColor("#729fcf"),y.css.toColor("#ad7fa8"),y.css.toColor("#34e2e2"),y.css.toColor("#eeeeec")],s=[0,95,135,175,215,255],o=0;o<216;o++){var c=s[o/36%6|0],d=s[o/6%6|0],g=s[o%6];a.push({css:y.channels.toCss(c,d,g),rgba:y.channels.toRgba(c,d,g)})}for(o=0;o<24;o++){var x=8+10*o;a.push({css:y.channels.toCss(x,x,x),rgba:y.channels.toRgba(x,x,x)})}return a}());var p=function(){function a(s,o){this.allowTransparency=o;var c=s.createElement("canvas");c.width=1,c.height=1;var d=c.getContext("2d");if(!d)throw new Error("Could not get rendering context");this._ctx=d,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this._contrastCache=new w.ColorContrastCache,this.colors={foreground:m,background:b,cursor:S,cursorAccent:u,selectionTransparent:f,selectionOpaque:y.color.blend(b,f),ansi:h.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors()}return a.prototype.onOptionsChange=function(s){s==="minimumContrastRatio"&&this._contrastCache.clear()},a.prototype.setTheme=function(s){s===void 0&&(s={}),this.colors.foreground=this._parseColor(s.foreground,m),this.colors.background=this._parseColor(s.background,b),this.colors.cursor=this._parseColor(s.cursor,S,!0),this.colors.cursorAccent=this._parseColor(s.cursorAccent,u,!0),this.colors.selectionTransparent=this._parseColor(s.selection,f,!0),this.colors.selectionOpaque=y.color.blend(this.colors.background,this.colors.selectionTransparent),y.color.isOpaque(this.colors.selectionTransparent)&&(this.colors.selectionTransparent=y.color.opacity(this.colors.selectionTransparent,.3)),this.colors.ansi[0]=this._parseColor(s.black,h.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(s.red,h.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(s.green,h.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(s.yellow,h.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(s.blue,h.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(s.magenta,h.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(s.cyan,h.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(s.white,h.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(s.brightBlack,h.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(s.brightRed,h.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(s.brightGreen,h.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(s.brightYellow,h.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(s.brightBlue,h.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(s.brightMagenta,h.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(s.brightCyan,h.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(s.brightWhite,h.DEFAULT_ANSI_COLORS[15]),this._contrastCache.clear(),this._updateRestoreColors()},a.prototype.restoreColor=function(s){if(s!==void 0)switch(s){case 256:this.colors.foreground=this._restoreColors.foreground;break;case 257:this.colors.background=this._restoreColors.background;break;case 258:this.colors.cursor=this._restoreColors.cursor;break;default:this.colors.ansi[s]=this._restoreColors.ansi[s]}else for(var o=0;o<this._restoreColors.ansi.length;++o)this.colors.ansi[o]=this._restoreColors.ansi[o]},a.prototype._updateRestoreColors=function(){this._restoreColors={foreground:this.colors.foreground,background:this.colors.background,cursor:this.colors.cursor,ansi:v([],this.colors.ansi,!0)}},a.prototype._parseColor=function(s,o,c){if(c===void 0&&(c=this.allowTransparency),s===void 0)return o;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=s,typeof this._ctx.fillStyle!="string")return console.warn("Color: "+s+" is invalid using fallback "+o.css),o;this._ctx.fillRect(0,0,1,1);var d=this._ctx.getImageData(0,0,1,1).data;if(d[3]!==255){if(!c)return console.warn("Color: "+s+" is using transparency, but allowTransparency is false. Using fallback "+o.css+"."),o;var g=this._ctx.fillStyle.substring(5,this._ctx.fillStyle.length-1).split(",").map(function(L){return Number(L)}),x=g[0],T=g[1],H=g[2],P=g[3],M=Math.round(255*P);return{rgba:y.channels.toRgba(x,T,H,M),css:s}}return{css:this._ctx.fillStyle,rgba:y.channels.toRgba(d[0],d[1],d[2],d[3])}},a}();h.ColorManager=p},9631:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.removeElementFromParent=void 0,h.removeElementFromParent=function(){for(var k,v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];for(var w=0,m=v;w<m.length;w++){var b=m[w];(k=b==null?void 0:b.parentElement)===null||k===void 0||k.removeChild(b)}}},3656:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.addDisposableDomListener=void 0,h.addDisposableDomListener=function(k,v,y,w){k.addEventListener(v,y,w);var m=!1;return{dispose:function(){m||(m=!0,k.removeEventListener(v,y,w))}}}},3551:function($,h,k){var v=this&&this.__decorate||function(u,f,p,a){var s,o=arguments.length,c=o<3?f:a===null?a=Object.getOwnPropertyDescriptor(f,p):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(u,f,p,a);else for(var d=u.length-1;d>=0;d--)(s=u[d])&&(c=(o<3?s(c):o>3?s(f,p,c):s(f,p))||c);return o>3&&c&&Object.defineProperty(f,p,c),c},y=this&&this.__param||function(u,f){return function(p,a){f(p,a,u)}};Object.defineProperty(h,"__esModule",{value:!0}),h.MouseZone=h.Linkifier=void 0;var w=k(8460),m=k(2585),b=function(){function u(f,p,a){this._bufferService=f,this._logService=p,this._unicodeService=a,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onShowLinkUnderline=new w.EventEmitter,this._onHideLinkUnderline=new w.EventEmitter,this._onLinkTooltip=new w.EventEmitter,this._rowsToLinkify={start:void 0,end:void 0}}return Object.defineProperty(u.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!1,configurable:!0}),u.prototype.attachToDom=function(f,p){this._element=f,this._mouseZoneManager=p},u.prototype.linkifyRows=function(f,p){var a=this;this._mouseZoneManager&&(this._rowsToLinkify.start===void 0||this._rowsToLinkify.end===void 0?(this._rowsToLinkify.start=f,this._rowsToLinkify.end=p):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,f),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,p)),this._mouseZoneManager.clearAll(f,p),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout(function(){return a._linkifyRows()},u._timeBeforeLatency))},u.prototype._linkifyRows=function(){this._rowsTimeoutId=void 0;var f=this._bufferService.buffer;if(this._rowsToLinkify.start!==void 0&&this._rowsToLinkify.end!==void 0){var p=f.ydisp+this._rowsToLinkify.start;if(!(p>=f.lines.length)){for(var a=f.ydisp+Math.min(this._rowsToLinkify.end,this._bufferService.rows)+1,s=Math.ceil(2e3/this._bufferService.cols),o=this._bufferService.buffer.iterator(!1,p,a,s,s);o.hasNext();)for(var c=o.next(),d=0;d<this._linkMatchers.length;d++)this._doLinkifyRow(c.range.first,c.content,this._linkMatchers[d]);this._rowsToLinkify.start=void 0,this._rowsToLinkify.end=void 0}}else this._logService.debug("_rowToLinkify was unset before _linkifyRows was called")},u.prototype.registerLinkMatcher=function(f,p,a){if(a===void 0&&(a={}),!p)throw new Error("handler must be defined");var s={id:this._nextLinkMatcherId++,regex:f,handler:p,matchIndex:a.matchIndex,validationCallback:a.validationCallback,hoverTooltipCallback:a.tooltipCallback,hoverLeaveCallback:a.leaveCallback,willLinkActivate:a.willLinkActivate,priority:a.priority||0};return this._addLinkMatcherToList(s),s.id},u.prototype._addLinkMatcherToList=function(f){if(this._linkMatchers.length!==0){for(var p=this._linkMatchers.length-1;p>=0;p--)if(f.priority<=this._linkMatchers[p].priority)return void this._linkMatchers.splice(p+1,0,f);this._linkMatchers.splice(0,0,f)}else this._linkMatchers.push(f)},u.prototype.deregisterLinkMatcher=function(f){for(var p=0;p<this._linkMatchers.length;p++)if(this._linkMatchers[p].id===f)return this._linkMatchers.splice(p,1),!0;return!1},u.prototype._doLinkifyRow=function(f,p,a){for(var s,o=this,c=new RegExp(a.regex.source,(a.regex.flags||"")+"g"),d=-1,g=function(){var T=s[typeof a.matchIndex!="number"?0:a.matchIndex];if(!T)return x._logService.debug("match found without corresponding matchIndex",s,a),"break";if(d=p.indexOf(T,d+1),c.lastIndex=d+T.length,d<0)return"break";var H=x._bufferService.buffer.stringIndexToBufferIndex(f,d);if(H[0]<0)return"break";var P=x._bufferService.buffer.lines.get(H[0]);if(!P)return"break";var M=P.getFg(H[1]),L=M?M>>9&511:void 0;a.validationCallback?a.validationCallback(T,function(D){o._rowsTimeoutId||D&&o._addLink(H[1],H[0]-o._bufferService.buffer.ydisp,T,a,L)}):x._addLink(H[1],H[0]-x._bufferService.buffer.ydisp,T,a,L)},x=this;(s=c.exec(p))!==null&&g()!=="break";);},u.prototype._addLink=function(f,p,a,s,o){var c=this;if(this._mouseZoneManager&&this._element){var d=this._unicodeService.getStringCellWidth(a),g=f%this._bufferService.cols,x=p+Math.floor(f/this._bufferService.cols),T=(g+d)%this._bufferService.cols,H=x+Math.floor((g+d)/this._bufferService.cols);T===0&&(T=this._bufferService.cols,H--),this._mouseZoneManager.add(new S(g+1,x+1,T+1,H+1,function(P){if(s.handler)return s.handler(P,a);var M=window.open();M?(M.opener=null,M.location.href=a):console.warn("Opening link blocked as opener could not be cleared")},function(){c._onShowLinkUnderline.fire(c._createLinkHoverEvent(g,x,T,H,o)),c._element.classList.add("xterm-cursor-pointer")},function(P){c._onLinkTooltip.fire(c._createLinkHoverEvent(g,x,T,H,o)),s.hoverTooltipCallback&&s.hoverTooltipCallback(P,a,{start:{x:g,y:x},end:{x:T,y:H}})},function(){c._onHideLinkUnderline.fire(c._createLinkHoverEvent(g,x,T,H,o)),c._element.classList.remove("xterm-cursor-pointer"),s.hoverLeaveCallback&&s.hoverLeaveCallback()},function(P){return!s.willLinkActivate||s.willLinkActivate(P,a)}))}},u.prototype._createLinkHoverEvent=function(f,p,a,s,o){return{x1:f,y1:p,x2:a,y2:s,cols:this._bufferService.cols,fg:o}},u._timeBeforeLatency=200,u=v([y(0,m.IBufferService),y(1,m.ILogService),y(2,m.IUnicodeService)],u)}();h.Linkifier=b;var S=function(u,f,p,a,s,o,c,d,g){this.x1=u,this.y1=f,this.x2=p,this.y2=a,this.clickCallback=s,this.hoverCallback=o,this.tooltipCallback=c,this.leaveCallback=d,this.willLinkActivate=g};h.MouseZone=S},6465:function($,h,k){var v,y=this&&this.__extends||(v=function(a,s){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},v(a,s)},function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function o(){this.constructor=a}v(a,s),a.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}),w=this&&this.__decorate||function(a,s,o,c){var d,g=arguments.length,x=g<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(a,s,o,c);else for(var T=a.length-1;T>=0;T--)(d=a[T])&&(x=(g<3?d(x):g>3?d(s,o,x):d(s,o))||x);return g>3&&x&&Object.defineProperty(s,o,x),x},m=this&&this.__param||function(a,s){return function(o,c){s(o,c,a)}};Object.defineProperty(h,"__esModule",{value:!0}),h.Linkifier2=void 0;var b=k(2585),S=k(8460),u=k(844),f=k(3656),p=function(a){function s(o){var c=a.call(this)||this;return c._bufferService=o,c._linkProviders=[],c._linkCacheDisposables=[],c._isMouseOut=!0,c._activeLine=-1,c._onShowLinkUnderline=c.register(new S.EventEmitter),c._onHideLinkUnderline=c.register(new S.EventEmitter),c.register((0,u.getDisposeArrayDisposable)(c._linkCacheDisposables)),c}return y(s,a),Object.defineProperty(s.prototype,"currentLink",{get:function(){return this._currentLink},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"onShowLinkUnderline",{get:function(){return this._onShowLinkUnderline.event},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"onHideLinkUnderline",{get:function(){return this._onHideLinkUnderline.event},enumerable:!1,configurable:!0}),s.prototype.registerLinkProvider=function(o){var c=this;return this._linkProviders.push(o),{dispose:function(){var d=c._linkProviders.indexOf(o);d!==-1&&c._linkProviders.splice(d,1)}}},s.prototype.attachToDom=function(o,c,d){var g=this;this._element=o,this._mouseService=c,this._renderService=d,this.register((0,f.addDisposableDomListener)(this._element,"mouseleave",function(){g._isMouseOut=!0,g._clearCurrentLink()})),this.register((0,f.addDisposableDomListener)(this._element,"mousemove",this._onMouseMove.bind(this))),this.register((0,f.addDisposableDomListener)(this._element,"click",this._onClick.bind(this)))},s.prototype._onMouseMove=function(o){if(this._lastMouseEvent=o,this._element&&this._mouseService){var c=this._positionFromMouseEvent(o,this._element,this._mouseService);if(c){this._isMouseOut=!1;for(var d=o.composedPath(),g=0;g<d.length;g++){var x=d[g];if(x.classList.contains("xterm"))break;if(x.classList.contains("xterm-hover"))return}this._lastBufferCell&&c.x===this._lastBufferCell.x&&c.y===this._lastBufferCell.y||(this._onHover(c),this._lastBufferCell=c)}}},s.prototype._onHover=function(o){if(this._activeLine!==o.y)return this._clearCurrentLink(),void this._askForLink(o,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,o)||(this._clearCurrentLink(),this._askForLink(o,!0))},s.prototype._askForLink=function(o,c){var d,g=this;this._activeProviderReplies&&c||((d=this._activeProviderReplies)===null||d===void 0||d.forEach(function(T){T==null||T.forEach(function(H){H.link.dispose&&H.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=o.y);var x=!1;this._linkProviders.forEach(function(T,H){var P;c?((P=g._activeProviderReplies)===null||P===void 0?void 0:P.get(H))&&(x=g._checkLinkProviderResult(H,o,x)):T.provideLinks(o.y,function(M){var L,D;if(!g._isMouseOut){var E=M==null?void 0:M.map(function(Y){return{link:Y}});(L=g._activeProviderReplies)===null||L===void 0||L.set(H,E),x=g._checkLinkProviderResult(H,o,x),((D=g._activeProviderReplies)===null||D===void 0?void 0:D.size)===g._linkProviders.length&&g._removeIntersectingLinks(o.y,g._activeProviderReplies)}})})},s.prototype._removeIntersectingLinks=function(o,c){for(var d=new Set,g=0;g<c.size;g++){var x=c.get(g);if(x)for(var T=0;T<x.length;T++)for(var H=x[T],P=H.link.range.start.y<o?0:H.link.range.start.x,M=H.link.range.end.y>o?this._bufferService.cols:H.link.range.end.x,L=P;L<=M;L++){if(d.has(L)){x.splice(T--,1);break}d.add(L)}}},s.prototype._checkLinkProviderResult=function(o,c,d){var g,x=this;if(!this._activeProviderReplies)return d;for(var T=this._activeProviderReplies.get(o),H=!1,P=0;P<o;P++)this._activeProviderReplies.has(P)&&!this._activeProviderReplies.get(P)||(H=!0);if(!H&&T){var M=T.find(function(D){return x._linkAtPosition(D.link,c)});M&&(d=!0,this._handleNewLink(M))}if(this._activeProviderReplies.size===this._linkProviders.length&&!d)for(P=0;P<this._activeProviderReplies.size;P++){var L=(g=this._activeProviderReplies.get(P))===null||g===void 0?void 0:g.find(function(D){return x._linkAtPosition(D.link,c)});if(L){d=!0,this._handleNewLink(L);break}}return d},s.prototype._onClick=function(o){if(this._element&&this._mouseService&&this._currentLink){var c=this._positionFromMouseEvent(o,this._element,this._mouseService);c&&this._linkAtPosition(this._currentLink.link,c)&&this._currentLink.link.activate(o,this._currentLink.link.text)}},s.prototype._clearCurrentLink=function(o,c){this._element&&this._currentLink&&this._lastMouseEvent&&(!o||!c||this._currentLink.link.range.start.y>=o&&this._currentLink.link.range.end.y<=c)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,u.disposeArray)(this._linkCacheDisposables))},s.prototype._handleNewLink=function(o){var c=this;if(this._element&&this._lastMouseEvent&&this._mouseService){var d=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);d&&this._linkAtPosition(o.link,d)&&(this._currentLink=o,this._currentLink.state={decorations:{underline:o.link.decorations===void 0||o.link.decorations.underline,pointerCursor:o.link.decorations===void 0||o.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,o.link,this._lastMouseEvent),o.link.decorations={},Object.defineProperties(o.link.decorations,{pointerCursor:{get:function(){var g,x;return(x=(g=c._currentLink)===null||g===void 0?void 0:g.state)===null||x===void 0?void 0:x.decorations.pointerCursor},set:function(g){var x,T;((x=c._currentLink)===null||x===void 0?void 0:x.state)&&c._currentLink.state.decorations.pointerCursor!==g&&(c._currentLink.state.decorations.pointerCursor=g,c._currentLink.state.isHovered&&((T=c._element)===null||T===void 0||T.classList.toggle("xterm-cursor-pointer",g)))}},underline:{get:function(){var g,x;return(x=(g=c._currentLink)===null||g===void 0?void 0:g.state)===null||x===void 0?void 0:x.decorations.underline},set:function(g){var x,T,H;((x=c._currentLink)===null||x===void 0?void 0:x.state)&&((H=(T=c._currentLink)===null||T===void 0?void 0:T.state)===null||H===void 0?void 0:H.decorations.underline)!==g&&(c._currentLink.state.decorations.underline=g,c._currentLink.state.isHovered&&c._fireUnderlineEvent(o.link,g))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedBufferChange(function(g){var x=g.start===0?0:g.start+1+c._bufferService.buffer.ydisp;c._clearCurrentLink(x,g.end+1+c._bufferService.buffer.ydisp)})))}},s.prototype._linkHover=function(o,c,d){var g;((g=this._currentLink)===null||g===void 0?void 0:g.state)&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(c,!0),this._currentLink.state.decorations.pointerCursor&&o.classList.add("xterm-cursor-pointer")),c.hover&&c.hover(d,c.text)},s.prototype._fireUnderlineEvent=function(o,c){var d=o.range,g=this._bufferService.buffer.ydisp,x=this._createLinkUnderlineEvent(d.start.x-1,d.start.y-g-1,d.end.x,d.end.y-g-1,void 0);(c?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(x)},s.prototype._linkLeave=function(o,c,d){var g;((g=this._currentLink)===null||g===void 0?void 0:g.state)&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(c,!1),this._currentLink.state.decorations.pointerCursor&&o.classList.remove("xterm-cursor-pointer")),c.leave&&c.leave(d,c.text)},s.prototype._linkAtPosition=function(o,c){var d=o.range.start.y===o.range.end.y,g=o.range.start.y<c.y,x=o.range.end.y>c.y;return(d&&o.range.start.x<=c.x&&o.range.end.x>=c.x||g&&o.range.end.x>=c.x||x&&o.range.start.x<=c.x||g&&x)&&o.range.start.y<=c.y&&o.range.end.y>=c.y},s.prototype._positionFromMouseEvent=function(o,c,d){var g=d.getCoords(o,c,this._bufferService.cols,this._bufferService.rows);if(g)return{x:g[0],y:g[1]+this._bufferService.buffer.ydisp}},s.prototype._createLinkUnderlineEvent=function(o,c,d,g,x){return{x1:o,y1:c,x2:d,y2:g,cols:this._bufferService.cols,fg:x}},w([m(0,b.IBufferService)],s)}(u.Disposable);h.Linkifier2=p},9042:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.tooMuchOutput=h.promptLabel=void 0,h.promptLabel="Terminal input",h.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},6954:function($,h,k){var v,y=this&&this.__extends||(v=function(a,s){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},v(a,s)},function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function o(){this.constructor=a}v(a,s),a.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}),w=this&&this.__decorate||function(a,s,o,c){var d,g=arguments.length,x=g<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(a,s,o,c);else for(var T=a.length-1;T>=0;T--)(d=a[T])&&(x=(g<3?d(x):g>3?d(s,o,x):d(s,o))||x);return g>3&&x&&Object.defineProperty(s,o,x),x},m=this&&this.__param||function(a,s){return function(o,c){s(o,c,a)}};Object.defineProperty(h,"__esModule",{value:!0}),h.MouseZoneManager=void 0;var b=k(844),S=k(3656),u=k(4725),f=k(2585),p=function(a){function s(o,c,d,g,x,T){var H=a.call(this)||this;return H._element=o,H._screenElement=c,H._bufferService=d,H._mouseService=g,H._selectionService=x,H._optionsService=T,H._zones=[],H._areZonesActive=!1,H._lastHoverCoords=[void 0,void 0],H._initialSelectionLength=0,H.register((0,S.addDisposableDomListener)(H._element,"mousedown",function(P){return H._onMouseDown(P)})),H._mouseMoveListener=function(P){return H._onMouseMove(P)},H._mouseLeaveListener=function(P){return H._onMouseLeave(P)},H._clickListener=function(P){return H._onClick(P)},H}return y(s,a),s.prototype.dispose=function(){a.prototype.dispose.call(this),this._deactivate()},s.prototype.add=function(o){this._zones.push(o),this._zones.length===1&&this._activate()},s.prototype.clearAll=function(o,c){if(this._zones.length!==0){o&&c||(o=0,c=this._bufferService.rows-1);for(var d=0;d<this._zones.length;d++){var g=this._zones[d];(g.y1>o&&g.y1<=c+1||g.y2>o&&g.y2<=c+1||g.y1<o&&g.y2>c+1)&&(this._currentZone&&this._currentZone===g&&(this._currentZone.leaveCallback(),this._currentZone=void 0),this._zones.splice(d--,1))}this._zones.length===0&&this._deactivate()}},s.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._element.addEventListener("mousemove",this._mouseMoveListener),this._element.addEventListener("mouseleave",this._mouseLeaveListener),this._element.addEventListener("click",this._clickListener))},s.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._element.removeEventListener("mousemove",this._mouseMoveListener),this._element.removeEventListener("mouseleave",this._mouseLeaveListener),this._element.removeEventListener("click",this._clickListener))},s.prototype._onMouseMove=function(o){this._lastHoverCoords[0]===o.pageX&&this._lastHoverCoords[1]===o.pageY||(this._onHover(o),this._lastHoverCoords=[o.pageX,o.pageY])},s.prototype._onHover=function(o){var c=this,d=this._findZoneEventAt(o);d!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),d&&(this._currentZone=d,d.hoverCallback&&d.hoverCallback(o),this._tooltipTimeout=window.setTimeout(function(){return c._onTooltip(o)},this._optionsService.options.linkTooltipHoverDuration)))},s.prototype._onTooltip=function(o){this._tooltipTimeout=void 0;var c=this._findZoneEventAt(o);c==null||c.tooltipCallback(o)},s.prototype._onMouseDown=function(o){if(this._initialSelectionLength=this._getSelectionLength(),this._areZonesActive){var c=this._findZoneEventAt(o);(c==null?void 0:c.willLinkActivate(o))&&(o.preventDefault(),o.stopImmediatePropagation())}},s.prototype._onMouseLeave=function(o){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=void 0,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},s.prototype._onClick=function(o){var c=this._findZoneEventAt(o),d=this._getSelectionLength();c&&d===this._initialSelectionLength&&(c.clickCallback(o),o.preventDefault(),o.stopImmediatePropagation())},s.prototype._getSelectionLength=function(){var o=this._selectionService.selectionText;return o?o.length:0},s.prototype._findZoneEventAt=function(o){var c=this._mouseService.getCoords(o,this._screenElement,this._bufferService.cols,this._bufferService.rows);if(c)for(var d=c[0],g=c[1],x=0;x<this._zones.length;x++){var T=this._zones[x];if(T.y1===T.y2){if(g===T.y1&&d>=T.x1&&d<T.x2)return T}else if(g===T.y1&&d>=T.x1||g===T.y2&&d<T.x2||g>T.y1&&g<T.y2)return T}},w([m(2,f.IBufferService),m(3,u.IMouseService),m(4,u.ISelectionService),m(5,f.IOptionsService)],s)}(b.Disposable);h.MouseZoneManager=p},6193:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.RenderDebouncer=void 0;var k=function(){function v(y){this._renderCallback=y}return v.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},v.prototype.refresh=function(y,w,m){var b=this;this._rowCount=m,y=y!==void 0?y:0,w=w!==void 0?w:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,y):y,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,w):w,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){return b._innerRefresh()}))},v.prototype._innerRefresh=function(){if(this._rowStart!==void 0&&this._rowEnd!==void 0&&this._rowCount!==void 0){var y=Math.max(this._rowStart,0),w=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0,this._renderCallback(y,w)}},v}();h.RenderDebouncer=k},5596:function($,h,k){var v,y=this&&this.__extends||(v=function(m,b){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,u){S.__proto__=u}||function(S,u){for(var f in u)Object.prototype.hasOwnProperty.call(u,f)&&(S[f]=u[f])},v(m,b)},function(m,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");function S(){this.constructor=m}v(m,b),m.prototype=b===null?Object.create(b):(S.prototype=b.prototype,new S)});Object.defineProperty(h,"__esModule",{value:!0}),h.ScreenDprMonitor=void 0;var w=function(m){function b(){var S=m!==null&&m.apply(this,arguments)||this;return S._currentDevicePixelRatio=window.devicePixelRatio,S}return y(b,m),b.prototype.setListener=function(S){var u=this;this._listener&&this.clearListener(),this._listener=S,this._outerListener=function(){u._listener&&(u._listener(window.devicePixelRatio,u._currentDevicePixelRatio),u._updateDpr())},this._updateDpr()},b.prototype.dispose=function(){m.prototype.dispose.call(this),this.clearListener()},b.prototype._updateDpr=function(){var S;this._outerListener&&((S=this._resolutionMediaMatchList)===null||S===void 0||S.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},b.prototype.clearListener=function(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},b}(k(844).Disposable);h.ScreenDprMonitor=w},3236:function($,h,k){var v,y=this&&this.__extends||(v=function(fe,B){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(N,U){N.__proto__=U}||function(N,U){for(var se in U)Object.prototype.hasOwnProperty.call(U,se)&&(N[se]=U[se])},v(fe,B)},function(fe,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function N(){this.constructor=fe}v(fe,B),fe.prototype=B===null?Object.create(B):(N.prototype=B.prototype,new N)});Object.defineProperty(h,"__esModule",{value:!0}),h.Terminal=void 0;var w=k(2950),m=k(1680),b=k(3614),S=k(2584),u=k(5435),f=k(3525),p=k(3551),a=k(9312),s=k(6114),o=k(3656),c=k(9042),d=k(357),g=k(6954),x=k(4567),T=k(1296),H=k(7399),P=k(8460),M=k(8437),L=k(5680),D=k(3230),E=k(4725),Y=k(428),j=k(8934),I=k(6465),F=k(5114),K=k(8969),Z=k(4774),ue=k(4269),ae=k(5941),Ce=typeof window!="undefined"?window.document:null,we=function(fe){function B(N){N===void 0&&(N={});var U=fe.call(this,N)||this;return U.browser=s,U._keyDownHandled=!1,U._keyPressHandled=!1,U._unprocessedDeadKey=!1,U._onCursorMove=new P.EventEmitter,U._onKey=new P.EventEmitter,U._onRender=new P.EventEmitter,U._onSelectionChange=new P.EventEmitter,U._onTitleChange=new P.EventEmitter,U._onBell=new P.EventEmitter,U._onFocus=new P.EventEmitter,U._onBlur=new P.EventEmitter,U._onA11yCharEmitter=new P.EventEmitter,U._onA11yTabEmitter=new P.EventEmitter,U._setup(),U.linkifier=U._instantiationService.createInstance(p.Linkifier),U.linkifier2=U.register(U._instantiationService.createInstance(I.Linkifier2)),U.register(U._inputHandler.onRequestBell(function(){return U.bell()})),U.register(U._inputHandler.onRequestRefreshRows(function(se,G){return U.refresh(se,G)})),U.register(U._inputHandler.onRequestSendFocus(function(){return U._reportFocus()})),U.register(U._inputHandler.onRequestReset(function(){return U.reset()})),U.register(U._inputHandler.onRequestWindowsOptionsReport(function(se){return U._reportWindowsOptions(se)})),U.register(U._inputHandler.onColor(function(se){return U._handleColorEvent(se)})),U.register((0,P.forwardEvent)(U._inputHandler.onCursorMove,U._onCursorMove)),U.register((0,P.forwardEvent)(U._inputHandler.onTitleChange,U._onTitleChange)),U.register((0,P.forwardEvent)(U._inputHandler.onA11yChar,U._onA11yCharEmitter)),U.register((0,P.forwardEvent)(U._inputHandler.onA11yTab,U._onA11yTabEmitter)),U.register(U._bufferService.onResize(function(se){return U._afterResize(se.cols,se.rows)})),U}return y(B,fe),Object.defineProperty(B.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onBell",{get:function(){return this._onBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onFocus",{get:function(){return this._onFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onBlur",{get:function(){return this._onBlur.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onA11yChar",{get:function(){return this._onA11yCharEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"onA11yTab",{get:function(){return this._onA11yTabEmitter.event},enumerable:!1,configurable:!0}),B.prototype._handleColorEvent=function(N){var U,se;if(this._colorManager){for(var G=0,_e=N;G<_e.length;G++){var Le=_e[G],Be=void 0,Ee="";switch(Le.index){case 256:Be="foreground",Ee="10";break;case 257:Be="background",Ee="11";break;case 258:Be="cursor",Ee="12";break;default:Be="ansi",Ee="4;"+Le.index}if(Be)switch(Le.type){case 0:var Ie=Z.color.toColorRGB(Be==="ansi"?this._colorManager.colors.ansi[Le.index]:this._colorManager.colors[Be]);this.coreService.triggerDataEvent(S.C0.ESC+"]"+Ee+";"+(0,ae.toRgbString)(Ie)+S.C0.BEL);break;case 1:Be==="ansi"?this._colorManager.colors.ansi[Le.index]=Z.rgba.toColor.apply(Z.rgba,Le.color):this._colorManager.colors[Be]=Z.rgba.toColor.apply(Z.rgba,Le.color);break;case 2:this._colorManager.restoreColor(Le.index)}}(U=this._renderService)===null||U===void 0||U.setColors(this._colorManager.colors),(se=this.viewport)===null||se===void 0||se.onThemeChange(this._colorManager.colors)}},B.prototype.dispose=function(){var N,U,se;this._isDisposed||(fe.prototype.dispose.call(this),(N=this._renderService)===null||N===void 0||N.dispose(),this._customKeyEventHandler=void 0,this.write=function(){},(se=(U=this.element)===null||U===void 0?void 0:U.parentNode)===null||se===void 0||se.removeChild(this.element))},B.prototype._setup=function(){fe.prototype._setup.call(this),this._customKeyEventHandler=void 0},Object.defineProperty(B.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),B.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},B.prototype._updateOptions=function(N){var U,se,G,_e;switch(fe.prototype._updateOptions.call(this,N),N){case"fontFamily":case"fontSize":(U=this._renderService)===null||U===void 0||U.clear(),(se=this._charSizeService)===null||se===void 0||se.measure();break;case"cursorBlink":case"cursorStyle":this.refresh(this.buffer.y,this.buffer.y);break;case"customGlyphs":case"drawBoldTextInBrightColors":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":case"minimumContrastRatio":this._renderService&&(this._renderService.clear(),this._renderService.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderService&&(this._renderService.setRenderer(this._createRenderer()),this._renderService.onResize(this.cols,this.rows));break;case"scrollback":(G=this.viewport)===null||G===void 0||G.syncScrollArea();break;case"screenReaderMode":this.optionsService.options.screenReaderMode?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new x.AccessibilityManager(this,this._renderService)):((_e=this._accessibilityManager)===null||_e===void 0||_e.dispose(),this._accessibilityManager=void 0);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"theme":this._setTheme(this.optionsService.options.theme)}},B.prototype._onTextAreaFocus=function(N){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(S.C0.ESC+"[I"),this.updateCursorStyle(N),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()},B.prototype.blur=function(){var N;return(N=this.textarea)===null||N===void 0?void 0:N.blur()},B.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(S.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()},B.prototype._syncTextArea=function(){if(this.textarea&&this.buffer.isCursorInViewport&&!this._compositionHelper.isComposing&&this._renderService){var N=this.buffer.ybase+this.buffer.y,U=this.buffer.lines.get(N);if(U){var se=Math.min(this.buffer.x,this.cols-1),G=this._renderService.dimensions.actualCellHeight,_e=U.getWidth(se),Le=this._renderService.dimensions.actualCellWidth*_e,Be=this.buffer.y*this._renderService.dimensions.actualCellHeight,Ee=se*this._renderService.dimensions.actualCellWidth;this.textarea.style.left=Ee+"px",this.textarea.style.top=Be+"px",this.textarea.style.width=Le+"px",this.textarea.style.height=G+"px",this.textarea.style.lineHeight=G+"px",this.textarea.style.zIndex="-5"}}},B.prototype._initGlobal=function(){var N=this;this._bindKeys(),this.register((0,o.addDisposableDomListener)(this.element,"copy",function(se){N.hasSelection()&&(0,b.copyHandler)(se,N._selectionService)}));var U=function(se){return(0,b.handlePasteEvent)(se,N.textarea,N.coreService)};this.register((0,o.addDisposableDomListener)(this.textarea,"paste",U)),this.register((0,o.addDisposableDomListener)(this.element,"paste",U)),s.isFirefox?this.register((0,o.addDisposableDomListener)(this.element,"mousedown",function(se){se.button===2&&(0,b.rightClickHandler)(se,N.textarea,N.screenElement,N._selectionService,N.options.rightClickSelectsWord)})):this.register((0,o.addDisposableDomListener)(this.element,"contextmenu",function(se){(0,b.rightClickHandler)(se,N.textarea,N.screenElement,N._selectionService,N.options.rightClickSelectsWord)})),s.isLinux&&this.register((0,o.addDisposableDomListener)(this.element,"auxclick",function(se){se.button===1&&(0,b.moveTextAreaUnderMouseCursor)(se,N.textarea,N.screenElement)}))},B.prototype._bindKeys=function(){var N=this;this.register((0,o.addDisposableDomListener)(this.textarea,"keyup",function(U){return N._keyUp(U)},!0)),this.register((0,o.addDisposableDomListener)(this.textarea,"keydown",function(U){return N._keyDown(U)},!0)),this.register((0,o.addDisposableDomListener)(this.textarea,"keypress",function(U){return N._keyPress(U)},!0)),this.register((0,o.addDisposableDomListener)(this.textarea,"compositionstart",function(){return N._compositionHelper.compositionstart()})),this.register((0,o.addDisposableDomListener)(this.textarea,"compositionupdate",function(U){return N._compositionHelper.compositionupdate(U)})),this.register((0,o.addDisposableDomListener)(this.textarea,"compositionend",function(){return N._compositionHelper.compositionend()})),this.register((0,o.addDisposableDomListener)(this.textarea,"input",function(U){return N._inputEvent(U)},!0)),this.register(this.onRender(function(){return N._compositionHelper.updateCompositionElements()})),this.register(this.onRender(function(U){return N._queueLinkification(U.start,U.end)}))},B.prototype.open=function(N){var U=this;if(!N)throw new Error("Terminal requires a parent element.");N.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=N.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),N.appendChild(this.element);var se=Ce.createDocumentFragment();this._viewportElement=Ce.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),se.appendChild(this._viewportElement),this._viewportScrollArea=Ce.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=Ce.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=Ce.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),se.appendChild(this.screenElement),this.textarea=Ce.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",c.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register((0,o.addDisposableDomListener)(this.textarea,"focus",function(Le){return U._onTextAreaFocus(Le)})),this.register((0,o.addDisposableDomListener)(this.textarea,"blur",function(){return U._onTextAreaBlur()})),this._helperContainer.appendChild(this.textarea);var G=this._instantiationService.createInstance(F.CoreBrowserService,this.textarea);this._instantiationService.setService(E.ICoreBrowserService,G),this._charSizeService=this._instantiationService.createInstance(Y.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._theme=this.options.theme||this._theme,this._colorManager=new L.ColorManager(Ce,this.options.allowTransparency),this.register(this.optionsService.onOptionChange(function(Le){return U._colorManager.onOptionsChange(Le)})),this._colorManager.setTheme(this._theme),this._characterJoinerService=this._instantiationService.createInstance(ue.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService);var _e=this._createRenderer();this._renderService=this.register(this._instantiationService.createInstance(D.RenderService,_e,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedBufferChange(function(Le){return U._onRender.fire(Le)})),this.onResize(function(Le){return U._renderService.resize(Le.cols,Le.rows)}),this._compositionView=Ce.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(w.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(se),this._soundService=this._instantiationService.createInstance(d.SoundService),this._instantiationService.setService(E.ISoundService,this._soundService),this._mouseService=this._instantiationService.createInstance(j.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(m.Viewport,function(Le){return U.scrollLines(Le,!0,1)},this._viewportElement,this._viewportScrollArea,this.element),this.viewport.onThemeChange(this._colorManager.colors),this.register(this._inputHandler.onRequestSyncScrollBar(function(){return U.viewport.syncScrollArea()})),this.register(this.viewport),this.register(this.onCursorMove(function(){U._renderService.onCursorMove(),U._syncTextArea()})),this.register(this.onResize(function(){return U._renderService.onResize(U.cols,U.rows)})),this.register(this.onBlur(function(){return U._renderService.onBlur()})),this.register(this.onFocus(function(){return U._renderService.onFocus()})),this.register(this._renderService.onDimensionsChange(function(){return U.viewport.syncScrollArea()})),this._selectionService=this.register(this._instantiationService.createInstance(a.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(function(Le){return U.scrollLines(Le.amount,Le.suppressScrollEvent)})),this.register(this._selectionService.onSelectionChange(function(){return U._onSelectionChange.fire()})),this.register(this._selectionService.onRequestRedraw(function(Le){return U._renderService.onSelectionChanged(Le.start,Le.end,Le.columnSelectMode)})),this.register(this._selectionService.onLinuxMouseSelection(function(Le){U.textarea.value=Le,U.textarea.focus(),U.textarea.select()})),this.register(this._onScroll.event(function(Le){U.viewport.syncScrollArea(),U._selectionService.refresh()})),this.register((0,o.addDisposableDomListener)(this._viewportElement,"scroll",function(){return U._selectionService.refresh()})),this._mouseZoneManager=this._instantiationService.createInstance(g.MouseZoneManager,this.element,this.screenElement),this.register(this._mouseZoneManager),this.register(this.onScroll(function(){return U._mouseZoneManager.clearAll()})),this.linkifier.attachToDom(this.element,this._mouseZoneManager),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register((0,o.addDisposableDomListener)(this.element,"mousedown",function(Le){return U._selectionService.onMouseDown(Le)})),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new x.AccessibilityManager(this,this._renderService)),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},B.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return this._instantiationService.createInstance(f.Renderer,this._colorManager.colors,this.screenElement,this.linkifier,this.linkifier2);case"dom":return this._instantiationService.createInstance(T.DomRenderer,this._colorManager.colors,this.element,this.screenElement,this._viewportElement,this.linkifier,this.linkifier2);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},B.prototype._setTheme=function(N){var U,se,G;this._theme=N,(U=this._colorManager)===null||U===void 0||U.setTheme(N),(se=this._renderService)===null||se===void 0||se.setColors(this._colorManager.colors),(G=this.viewport)===null||G===void 0||G.onThemeChange(this._colorManager.colors)},B.prototype.bindMouse=function(){var N=this,U=this,se=this.element;function G(be){var qe,_t,Mt=U._mouseService.getRawByteCoords(be,U.screenElement,U.cols,U.rows);if(!Mt)return!1;switch(be.overrideType||be.type){case"mousemove":_t=32,be.buttons===void 0?(qe=3,be.button!==void 0&&(qe=be.button<3?be.button:3)):qe=1&be.buttons?0:4&be.buttons?1:2&be.buttons?2:3;break;case"mouseup":_t=0,qe=be.button<3?be.button:3;break;case"mousedown":_t=1,qe=be.button<3?be.button:3;break;case"wheel":be.deltaY!==0&&(_t=be.deltaY<0?0:1),qe=4;break;default:return!1}return!(_t===void 0||qe===void 0||qe>4)&&U.coreMouseService.triggerMouseEvent({col:Mt.x-33,row:Mt.y-33,button:qe,action:_t,ctrl:be.ctrlKey,alt:be.altKey,shift:be.shiftKey})}var _e={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Le=function(be){return G(be),be.buttons||(N._document.removeEventListener("mouseup",_e.mouseup),_e.mousedrag&&N._document.removeEventListener("mousemove",_e.mousedrag)),N.cancel(be)},Be=function(be){return G(be),N.cancel(be,!0)},Ee=function(be){be.buttons&&G(be)},Ie=function(be){be.buttons||G(be)};this.register(this.coreMouseService.onProtocolChange(function(be){be?(N.optionsService.options.logLevel==="debug"&&N._logService.debug("Binding to mouse events:",N.coreMouseService.explainEvents(be)),N.element.classList.add("enable-mouse-events"),N._selectionService.disable()):(N._logService.debug("Unbinding from mouse events."),N.element.classList.remove("enable-mouse-events"),N._selectionService.enable()),8&be?_e.mousemove||(se.addEventListener("mousemove",Ie),_e.mousemove=Ie):(se.removeEventListener("mousemove",_e.mousemove),_e.mousemove=null),16&be?_e.wheel||(se.addEventListener("wheel",Be,{passive:!1}),_e.wheel=Be):(se.removeEventListener("wheel",_e.wheel),_e.wheel=null),2&be?_e.mouseup||(_e.mouseup=Le):(N._document.removeEventListener("mouseup",_e.mouseup),_e.mouseup=null),4&be?_e.mousedrag||(_e.mousedrag=Ee):(N._document.removeEventListener("mousemove",_e.mousedrag),_e.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,o.addDisposableDomListener)(se,"mousedown",function(be){if(be.preventDefault(),N.focus(),N.coreMouseService.areMouseEventsActive&&!N._selectionService.shouldForceSelection(be))return G(be),_e.mouseup&&N._document.addEventListener("mouseup",_e.mouseup),_e.mousedrag&&N._document.addEventListener("mousemove",_e.mousedrag),N.cancel(be)})),this.register((0,o.addDisposableDomListener)(se,"wheel",function(be){if(!_e.wheel){if(!N.buffer.hasScrollback){var qe=N.viewport.getLinesScrolled(be);if(qe===0)return;for(var _t=S.C0.ESC+(N.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(be.deltaY<0?"A":"B"),Mt="",Yt=0;Yt<Math.abs(qe);Yt++)Mt+=_t;return N.coreService.triggerDataEvent(Mt,!0),N.cancel(be,!0)}return N.viewport.onWheel(be)?N.cancel(be):void 0}},{passive:!1})),this.register((0,o.addDisposableDomListener)(se,"touchstart",function(be){if(!N.coreMouseService.areMouseEventsActive)return N.viewport.onTouchStart(be),N.cancel(be)},{passive:!0})),this.register((0,o.addDisposableDomListener)(se,"touchmove",function(be){if(!N.coreMouseService.areMouseEventsActive)return N.viewport.onTouchMove(be)?void 0:N.cancel(be)},{passive:!1}))},B.prototype.refresh=function(N,U){var se;(se=this._renderService)===null||se===void 0||se.refreshRows(N,U)},B.prototype._queueLinkification=function(N,U){var se;(se=this.linkifier)===null||se===void 0||se.linkifyRows(N,U)},B.prototype.updateCursorStyle=function(N){var U;((U=this._selectionService)===null||U===void 0?void 0:U.shouldColumnSelect(N))?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},B.prototype._showCursor=function(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))},B.prototype.scrollLines=function(N,U,se){se===void 0&&(se=0),fe.prototype.scrollLines.call(this,N,U,se),this.refresh(0,this.rows-1)},B.prototype.paste=function(N){(0,b.paste)(N,this.textarea,this.coreService)},B.prototype.attachCustomKeyEventHandler=function(N){this._customKeyEventHandler=N},B.prototype.registerLinkMatcher=function(N,U,se){var G=this.linkifier.registerLinkMatcher(N,U,se);return this.refresh(0,this.rows-1),G},B.prototype.deregisterLinkMatcher=function(N){this.linkifier.deregisterLinkMatcher(N)&&this.refresh(0,this.rows-1)},B.prototype.registerLinkProvider=function(N){return this.linkifier2.registerLinkProvider(N)},B.prototype.registerCharacterJoiner=function(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");var U=this._characterJoinerService.register(N);return this.refresh(0,this.rows-1),U},B.prototype.deregisterCharacterJoiner=function(N){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(N)&&this.refresh(0,this.rows-1)},Object.defineProperty(B.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!1,configurable:!0}),B.prototype.addMarker=function(N){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+N)},B.prototype.hasSelection=function(){return!!this._selectionService&&this._selectionService.hasSelection},B.prototype.select=function(N,U,se){this._selectionService.setSelection(N,U,se)},B.prototype.getSelection=function(){return this._selectionService?this._selectionService.selectionText:""},B.prototype.getSelectionPosition=function(){if(this._selectionService&&this._selectionService.hasSelection)return{startColumn:this._selectionService.selectionStart[0],startRow:this._selectionService.selectionStart[1],endColumn:this._selectionService.selectionEnd[0],endRow:this._selectionService.selectionEnd[1]}},B.prototype.clearSelection=function(){var N;(N=this._selectionService)===null||N===void 0||N.clearSelection()},B.prototype.selectAll=function(){var N;(N=this._selectionService)===null||N===void 0||N.selectAll()},B.prototype.selectLines=function(N,U){var se;(se=this._selectionService)===null||se===void 0||se.selectLines(N,U)},B.prototype._keyDown=function(N){if(this._keyDownHandled=!1,this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1)return!1;if(!this._compositionHelper.keydown(N))return this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;N.key!=="Dead"&&N.key!=="AltGraph"||(this._unprocessedDeadKey=!0);var U=(0,H.evaluateKeyboardEvent)(N,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(N),U.type===3||U.type===2){var se=this.rows-1;return this.scrollLines(U.type===2?-se:se),this.cancel(N,!0)}return U.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,N)||(U.cancel&&this.cancel(N,!0),!U.key||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(U.key!==S.C0.ETX&&U.key!==S.C0.CR||(this.textarea.value=""),this._onKey.fire({key:U.key,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(U.key,!0),this.optionsService.options.screenReaderMode?void(this._keyDownHandled=!0):this.cancel(N,!0))))},B.prototype._isThirdLevelShift=function(N,U){var se=N.isMac&&!this.options.macOptionIsMeta&&U.altKey&&!U.ctrlKey&&!U.metaKey||N.isWindows&&U.altKey&&U.ctrlKey&&!U.metaKey||N.isWindows&&U.getModifierState("AltGraph");return U.type==="keypress"?se:se&&(!U.keyCode||U.keyCode>47)},B.prototype._keyUp=function(N){this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1||(function(U){return U.keyCode===16||U.keyCode===17||U.keyCode===18}(N)||this.focus(),this.updateCursorStyle(N),this._keyPressHandled=!1)},B.prototype._keyPress=function(N){var U;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(N)===!1)return!1;if(this.cancel(N),N.charCode)U=N.charCode;else if(N.which===null||N.which===void 0)U=N.keyCode;else{if(N.which===0||N.charCode===0)return!1;U=N.which}return!(!U||(N.altKey||N.ctrlKey||N.metaKey)&&!this._isThirdLevelShift(this.browser,N)||(U=String.fromCharCode(U),this._onKey.fire({key:U,domEvent:N}),this._showCursor(),this.coreService.triggerDataEvent(U,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))},B.prototype._inputEvent=function(N){if(N.data&&N.inputType==="insertText"&&!N.composed&&!this.optionsService.options.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;var U=N.data;return this.coreService.triggerDataEvent(U,!0),this.cancel(N),!0}return!1},B.prototype.bell=function(){var N;this._soundBell()&&((N=this._soundService)===null||N===void 0||N.playBellSound()),this._onBell.fire()},B.prototype.resize=function(N,U){N!==this.cols||U!==this.rows?fe.prototype.resize.call(this,N,U):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()},B.prototype._afterResize=function(N,U){var se,G;(se=this._charSizeService)===null||se===void 0||se.measure(),(G=this.viewport)===null||G===void 0||G.syncScrollArea(!0)},B.prototype.clear=function(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var N=1;N<this.rows;N++)this.buffer.lines.push(this.buffer.getBlankLine(M.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}},B.prototype.reset=function(){var N,U;this.options.rows=this.rows,this.options.cols=this.cols;var se=this._customKeyEventHandler;this._setup(),fe.prototype.reset.call(this),(N=this._selectionService)===null||N===void 0||N.reset(),this._customKeyEventHandler=se,this.refresh(0,this.rows-1),(U=this.viewport)===null||U===void 0||U.syncScrollArea()},B.prototype.clearTextureAtlas=function(){var N;(N=this._renderService)===null||N===void 0||N.clearTextureAtlas()},B.prototype._reportFocus=function(){var N;((N=this.element)===null||N===void 0?void 0:N.classList.contains("focus"))?this.coreService.triggerDataEvent(S.C0.ESC+"[I"):this.coreService.triggerDataEvent(S.C0.ESC+"[O")},B.prototype._reportWindowsOptions=function(N){if(this._renderService)switch(N){case u.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:var U=this._renderService.dimensions.scaledCanvasWidth.toFixed(0),se=this._renderService.dimensions.scaledCanvasHeight.toFixed(0);this.coreService.triggerDataEvent(S.C0.ESC+"[4;"+se+";"+U+"t");break;case u.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:var G=this._renderService.dimensions.scaledCellWidth.toFixed(0),_e=this._renderService.dimensions.scaledCellHeight.toFixed(0);this.coreService.triggerDataEvent(S.C0.ESC+"[6;"+_e+";"+G+"t")}},B.prototype.cancel=function(N,U){if(this.options.cancelEvents||U)return N.preventDefault(),N.stopPropagation(),!1},B.prototype._visualBell=function(){return!1},B.prototype._soundBell=function(){return this.options.bellStyle==="sound"},B}(K.CoreTerminal);h.Terminal=we},9924:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.TimeBasedDebouncer=void 0;var k=function(){function v(y,w){w===void 0&&(w=1e3),this._renderCallback=y,this._debounceThresholdMS=w,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}return v.prototype.dispose=function(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)},v.prototype.refresh=function(y,w,m){var b=this;this._rowCount=m,y=y!==void 0?y:0,w=w!==void 0?w:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,y):y,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,w):w;var S=Date.now();if(S-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=S,this._innerRefresh();else if(!this._additionalRefreshRequested){var u=S-this._lastRefreshMs,f=this._debounceThresholdMS-u;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(function(){b._lastRefreshMs=Date.now(),b._innerRefresh(),b._additionalRefreshRequested=!1,b._refreshTimeoutID=void 0},f)}},v.prototype._innerRefresh=function(){if(this._rowStart!==void 0&&this._rowEnd!==void 0&&this._rowCount!==void 0){var y=Math.max(this._rowStart,0),w=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(y,w)}},v}();h.TimeBasedDebouncer=k},1680:function($,h,k){var v,y=this&&this.__extends||(v=function(a,s){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},v(a,s)},function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function o(){this.constructor=a}v(a,s),a.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}),w=this&&this.__decorate||function(a,s,o,c){var d,g=arguments.length,x=g<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(a,s,o,c);else for(var T=a.length-1;T>=0;T--)(d=a[T])&&(x=(g<3?d(x):g>3?d(s,o,x):d(s,o))||x);return g>3&&x&&Object.defineProperty(s,o,x),x},m=this&&this.__param||function(a,s){return function(o,c){s(o,c,a)}};Object.defineProperty(h,"__esModule",{value:!0}),h.Viewport=void 0;var b=k(844),S=k(3656),u=k(4725),f=k(2585),p=function(a){function s(o,c,d,g,x,T,H,P){var M=a.call(this)||this;return M._scrollLines=o,M._viewportElement=c,M._scrollArea=d,M._element=g,M._bufferService=x,M._optionsService=T,M._charSizeService=H,M._renderService=P,M.scrollBarWidth=0,M._currentRowHeight=0,M._currentScaledCellHeight=0,M._lastRecordedBufferLength=0,M._lastRecordedViewportHeight=0,M._lastRecordedBufferHeight=0,M._lastTouchY=0,M._lastScrollTop=0,M._lastHadScrollBar=!1,M._wheelPartialScroll=0,M._refreshAnimationFrame=null,M._ignoreNextScrollEvent=!1,M.scrollBarWidth=M._viewportElement.offsetWidth-M._scrollArea.offsetWidth||15,M._lastHadScrollBar=!0,M.register((0,S.addDisposableDomListener)(M._viewportElement,"scroll",M._onScroll.bind(M))),M._activeBuffer=M._bufferService.buffer,M.register(M._bufferService.buffers.onBufferActivate(function(L){return M._activeBuffer=L.activeBuffer})),M._renderDimensions=M._renderService.dimensions,M.register(M._renderService.onDimensionsChange(function(L){return M._renderDimensions=L})),setTimeout(function(){return M.syncScrollArea()},0),M}return y(s,a),s.prototype.onThemeChange=function(o){this._viewportElement.style.backgroundColor=o.background.css},s.prototype._refresh=function(o){var c=this;if(o)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=requestAnimationFrame(function(){return c._innerRefresh()}))},s.prototype._innerRefresh=function(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.scaledCellHeight/window.devicePixelRatio,this._currentScaledCellHeight=this._renderService.dimensions.scaledCellHeight,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var o=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.canvasHeight);this._lastRecordedBufferHeight!==o&&(this._lastRecordedBufferHeight=o,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var c=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==c&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=c),this._optionsService.options.scrollback===0?this.scrollBarWidth=0:this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this._lastHadScrollBar=this.scrollBarWidth>0;var d=window.getComputedStyle(this._element),g=parseInt(d.paddingLeft)+parseInt(d.paddingRight);this._viewportElement.style.width=(this._renderService.dimensions.actualCellWidth*this._bufferService.cols+this.scrollBarWidth+(this._lastHadScrollBar?g:0)).toString()+"px",this._refreshAnimationFrame=null},s.prototype.syncScrollArea=function(o){if(o===void 0&&(o=!1),this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(o);this._lastRecordedViewportHeight===this._renderService.dimensions.canvasHeight&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.scaledCellHeight===this._currentScaledCellHeight?this._lastHadScrollBar!==this._optionsService.options.scrollback>0&&this._refresh(o):this._refresh(o)},s.prototype._onScroll=function(o){if(this._lastScrollTop=this._viewportElement.scrollTop,this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);var c=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(c)}},s.prototype._bubbleScroll=function(o,c){var d=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(c<0&&this._viewportElement.scrollTop!==0||c>0&&d<this._lastRecordedBufferHeight)||(o.cancelable&&o.preventDefault(),!1)},s.prototype.onWheel=function(o){var c=this._getPixelsScrolled(o);return c!==0&&(this._viewportElement.scrollTop+=c,this._bubbleScroll(o,c))},s.prototype._getPixelsScrolled=function(o){if(o.deltaY===0||o.shiftKey)return 0;var c=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_LINE?c*=this._currentRowHeight:o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._currentRowHeight*this._bufferService.rows),c},s.prototype.getLinesScrolled=function(o){if(o.deltaY===0||o.shiftKey)return 0;var c=this._applyScrollModifier(o.deltaY,o);return o.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(c/=this._currentRowHeight+0,this._wheelPartialScroll+=c,c=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):o.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(c*=this._bufferService.rows),c},s.prototype._applyScrollModifier=function(o,c){var d=this._optionsService.options.fastScrollModifier;return d==="alt"&&c.altKey||d==="ctrl"&&c.ctrlKey||d==="shift"&&c.shiftKey?o*this._optionsService.options.fastScrollSensitivity*this._optionsService.options.scrollSensitivity:o*this._optionsService.options.scrollSensitivity},s.prototype.onTouchStart=function(o){this._lastTouchY=o.touches[0].pageY},s.prototype.onTouchMove=function(o){var c=this._lastTouchY-o.touches[0].pageY;return this._lastTouchY=o.touches[0].pageY,c!==0&&(this._viewportElement.scrollTop+=c,this._bubbleScroll(o,c))},w([m(4,f.IBufferService),m(5,f.IOptionsService),m(6,u.ICharSizeService),m(7,u.IRenderService)],s)}(b.Disposable);h.Viewport=p},2950:function($,h,k){var v=this&&this.__decorate||function(S,u,f,p){var a,s=arguments.length,o=s<3?u:p===null?p=Object.getOwnPropertyDescriptor(u,f):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(S,u,f,p);else for(var c=S.length-1;c>=0;c--)(a=S[c])&&(o=(s<3?a(o):s>3?a(u,f,o):a(u,f))||o);return s>3&&o&&Object.defineProperty(u,f,o),o},y=this&&this.__param||function(S,u){return function(f,p){u(f,p,S)}};Object.defineProperty(h,"__esModule",{value:!0}),h.CompositionHelper=void 0;var w=k(4725),m=k(2585),b=function(){function S(u,f,p,a,s,o){this._textarea=u,this._compositionView=f,this._bufferService=p,this._optionsService=a,this._coreService=s,this._renderService=o,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}return Object.defineProperty(S.prototype,"isComposing",{get:function(){return this._isComposing},enumerable:!1,configurable:!0}),S.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")},S.prototype.compositionupdate=function(u){var f=this;this._compositionView.textContent=u.data,this.updateCompositionElements(),setTimeout(function(){f._compositionPosition.end=f._textarea.value.length},0)},S.prototype.compositionend=function(){this._finalizeComposition(!0)},S.prototype.keydown=function(u){if(this._isComposing||this._isSendingComposition){if(u.keyCode===229||u.keyCode===16||u.keyCode===17||u.keyCode===18)return!1;this._finalizeComposition(!1)}return u.keyCode!==229||(this._handleAnyTextareaChanges(),!1)},S.prototype._finalizeComposition=function(u){var f=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,u){var p={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(function(){if(f._isSendingComposition){f._isSendingComposition=!1;var s;p.start+=f._dataAlreadySent.length,(s=f._isComposing?f._textarea.value.substring(p.start,p.end):f._textarea.value.substring(p.start)).length>0&&f._coreService.triggerDataEvent(s,!0)}},0)}else{this._isSendingComposition=!1;var a=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(a,!0)}},S.prototype._handleAnyTextareaChanges=function(){var u=this,f=this._textarea.value;setTimeout(function(){if(!u._isComposing){var p=u._textarea.value.replace(f,"");p.length>0&&(u._dataAlreadySent=p,u._coreService.triggerDataEvent(p,!0))}},0)},S.prototype.updateCompositionElements=function(u){var f=this;if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){var p=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),a=this._renderService.dimensions.actualCellHeight,s=this._bufferService.buffer.y*this._renderService.dimensions.actualCellHeight,o=p*this._renderService.dimensions.actualCellWidth;this._compositionView.style.left=o+"px",this._compositionView.style.top=s+"px",this._compositionView.style.height=a+"px",this._compositionView.style.lineHeight=a+"px",this._compositionView.style.fontFamily=this._optionsService.options.fontFamily,this._compositionView.style.fontSize=this._optionsService.options.fontSize+"px";var c=this._compositionView.getBoundingClientRect();this._textarea.style.left=o+"px",this._textarea.style.top=s+"px",this._textarea.style.width=Math.max(c.width,1)+"px",this._textarea.style.height=Math.max(c.height,1)+"px",this._textarea.style.lineHeight=c.height+"px"}u||setTimeout(function(){return f.updateCompositionElements(!0)},0)}},v([y(2,m.IBufferService),y(3,m.IOptionsService),y(4,m.ICoreService),y(5,w.IRenderService)],S)}();h.CompositionHelper=b},9806:($,h)=>{function k(v,y){var w=y.getBoundingClientRect();return[v.clientX-w.left,v.clientY-w.top]}Object.defineProperty(h,"__esModule",{value:!0}),h.getRawByteCoords=h.getCoords=h.getCoordsRelativeToElement=void 0,h.getCoordsRelativeToElement=k,h.getCoords=function(v,y,w,m,b,S,u,f){if(b){var p=k(v,y);if(p)return p[0]=Math.ceil((p[0]+(f?S/2:0))/S),p[1]=Math.ceil(p[1]/u),p[0]=Math.min(Math.max(p[0],1),w+(f?1:0)),p[1]=Math.min(Math.max(p[1],1),m),p}},h.getRawByteCoords=function(v){if(v)return{x:v[0]+32,y:v[1]+32}}},9504:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.moveToCellSequence=void 0;var v=k(2584);function y(f,p,a,s){var o=f-w(a,f),c=p-w(a,p),d=Math.abs(o-c)-function(g,x,T){for(var H=0,P=g-w(T,g),M=x-w(T,x),L=0;L<Math.abs(P-M);L++){var D=m(g,x)==="A"?-1:1,E=T.buffer.lines.get(P+D*L);(E==null?void 0:E.isWrapped)&&H++}return H}(f,p,a);return u(d,S(m(f,p),s))}function w(f,p){for(var a=0,s=f.buffer.lines.get(p),o=s==null?void 0:s.isWrapped;o&&p>=0&&p<f.rows;)a++,o=(s=f.buffer.lines.get(--p))==null?void 0:s.isWrapped;return a}function m(f,p){return f>p?"A":"B"}function b(f,p,a,s,o,c){for(var d=f,g=p,x="";d!==a||g!==s;)d+=o?1:-1,o&&d>c.cols-1?(x+=c.buffer.translateBufferLineToString(g,!1,f,d),d=0,f=0,g++):!o&&d<0&&(x+=c.buffer.translateBufferLineToString(g,!1,0,f+1),f=d=c.cols-1,g--);return x+c.buffer.translateBufferLineToString(g,!1,f,d)}function S(f,p){var a=p?"O":"[";return v.C0.ESC+a+f}function u(f,p){f=Math.floor(f);for(var a="",s=0;s<f;s++)a+=p;return a}h.moveToCellSequence=function(f,p,a,s){var o,c=a.buffer.x,d=a.buffer.y;if(!a.buffer.hasScrollback)return function(x,T,H,P,M,L){return y(T,P,M,L).length===0?"":u(b(x,T,x,T-w(M,T),!1,M).length,S("D",L))}(c,d,0,p,a,s)+y(d,p,a,s)+function(x,T,H,P,M,L){var D;D=y(T,P,M,L).length>0?P-w(M,P):T;var E=P,Y=function(j,I,F,K,Z,ue){var ae;return ae=y(F,K,Z,ue).length>0?K-w(Z,K):I,j<F&&ae<=K||j>=F&&ae<K?"C":"D"}(x,T,H,P,M,L);return u(b(x,D,H,E,Y==="C",M).length,S(Y,L))}(c,d,f,p,a,s);if(d===p)return o=c>f?"D":"C",u(Math.abs(c-f),S(o,s));o=d>p?"D":"C";var g=Math.abs(d-p);return u(function(x,T){return T.cols-x}(d>p?f:c,a)+(g-1)*a.cols+1+((d>p?c:f)-1),S(o,s))}},1546:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BaseRenderLayer=void 0;var v=k(643),y=k(8803),w=k(1420),m=k(3734),b=k(1752),S=k(4774),u=k(9631),f=k(8978),p=function(){function a(s,o,c,d,g,x,T,H){this._container=s,this._alpha=d,this._colors=g,this._rendererId=x,this._bufferService=T,this._optionsService=H,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+o+"-layer"),this._canvas.style.zIndex=c.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return a.prototype.dispose=function(){var s;(0,u.removeElementFromParent)(this._canvas),(s=this._charAtlas)===null||s===void 0||s.dispose()},a.prototype._initCanvas=function(){this._ctx=(0,b.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()},a.prototype.onOptionsChanged=function(){},a.prototype.onBlur=function(){},a.prototype.onFocus=function(){},a.prototype.onCursorMove=function(){},a.prototype.onGridChanged=function(s,o){},a.prototype.onSelectionChanged=function(s,o,c){c===void 0&&(c=!1)},a.prototype.setColors=function(s){this._refreshCharAtlas(s)},a.prototype._setTransparency=function(s){if(s!==this._alpha){var o=this._canvas;this._alpha=s,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,o),this._refreshCharAtlas(this._colors),this.onGridChanged(0,this._bufferService.rows-1)}},a.prototype._refreshCharAtlas=function(s){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=(0,w.acquireCharAtlas)(this._optionsService.options,this._rendererId,s,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},a.prototype.resize=function(s){this._scaledCellWidth=s.scaledCellWidth,this._scaledCellHeight=s.scaledCellHeight,this._scaledCharWidth=s.scaledCharWidth,this._scaledCharHeight=s.scaledCharHeight,this._scaledCharLeft=s.scaledCharLeft,this._scaledCharTop=s.scaledCharTop,this._canvas.width=s.scaledCanvasWidth,this._canvas.height=s.scaledCanvasHeight,this._canvas.style.width=s.canvasWidth+"px",this._canvas.style.height=s.canvasHeight+"px",this._alpha||this._clearAll(),this._refreshCharAtlas(this._colors)},a.prototype.clearTextureAtlas=function(){var s;(s=this._charAtlas)===null||s===void 0||s.clear()},a.prototype._fillCells=function(s,o,c,d){this._ctx.fillRect(s*this._scaledCellWidth,o*this._scaledCellHeight,c*this._scaledCellWidth,d*this._scaledCellHeight)},a.prototype._fillMiddleLineAtCells=function(s,o,c){c===void 0&&(c=1);var d=Math.ceil(.5*this._scaledCellHeight);this._ctx.fillRect(s*this._scaledCellWidth,(o+1)*this._scaledCellHeight-d-window.devicePixelRatio,c*this._scaledCellWidth,window.devicePixelRatio)},a.prototype._fillBottomLineAtCells=function(s,o,c){c===void 0&&(c=1),this._ctx.fillRect(s*this._scaledCellWidth,(o+1)*this._scaledCellHeight-window.devicePixelRatio-1,c*this._scaledCellWidth,window.devicePixelRatio)},a.prototype._fillLeftLineAtCell=function(s,o,c){this._ctx.fillRect(s*this._scaledCellWidth,o*this._scaledCellHeight,window.devicePixelRatio*c,this._scaledCellHeight)},a.prototype._strokeRectAtCell=function(s,o,c,d){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(s*this._scaledCellWidth+window.devicePixelRatio/2,o*this._scaledCellHeight+window.devicePixelRatio/2,c*this._scaledCellWidth-window.devicePixelRatio,d*this._scaledCellHeight-window.devicePixelRatio)},a.prototype._clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},a.prototype._clearCells=function(s,o,c,d){this._alpha?this._ctx.clearRect(s*this._scaledCellWidth,o*this._scaledCellHeight,c*this._scaledCellWidth,d*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(s*this._scaledCellWidth,o*this._scaledCellHeight,c*this._scaledCellWidth,d*this._scaledCellHeight))},a.prototype._fillCharTrueColor=function(s,o,c){this._ctx.font=this._getFont(!1,!1),this._ctx.textBaseline=y.TEXT_BASELINE,this._clipRow(c);var d=!1;this._optionsService.options.customGlyphs!==!1&&(d=(0,f.tryDrawCustomChar)(this._ctx,s.getChars(),o*this._scaledCellWidth,c*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),d||this._ctx.fillText(s.getChars(),o*this._scaledCellWidth+this._scaledCharLeft,c*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight)},a.prototype._drawChars=function(s,o,c){var d,g,x,T=this._getContrastColor(s);T||s.isFgRGB()||s.isBgRGB()?this._drawUncachedChars(s,o,c,T):(s.isInverse()?(g=s.isBgDefault()?y.INVERTED_DEFAULT_COLOR:s.getBgColor(),x=s.isFgDefault()?y.INVERTED_DEFAULT_COLOR:s.getFgColor()):(x=s.isBgDefault()?v.DEFAULT_COLOR:s.getBgColor(),g=s.isFgDefault()?v.DEFAULT_COLOR:s.getFgColor()),g+=this._optionsService.options.drawBoldTextInBrightColors&&s.isBold()&&g<8?8:0,this._currentGlyphIdentifier.chars=s.getChars()||v.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=s.getCode()||v.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=x,this._currentGlyphIdentifier.fg=g,this._currentGlyphIdentifier.bold=!!s.isBold(),this._currentGlyphIdentifier.dim=!!s.isDim(),this._currentGlyphIdentifier.italic=!!s.isItalic(),((d=this._charAtlas)===null||d===void 0?void 0:d.draw(this._ctx,this._currentGlyphIdentifier,o*this._scaledCellWidth+this._scaledCharLeft,c*this._scaledCellHeight+this._scaledCharTop))||this._drawUncachedChars(s,o,c))},a.prototype._drawUncachedChars=function(s,o,c,d){if(this._ctx.save(),this._ctx.font=this._getFont(!!s.isBold(),!!s.isItalic()),this._ctx.textBaseline=y.TEXT_BASELINE,s.isInverse())if(d)this._ctx.fillStyle=d.css;else if(s.isBgDefault())this._ctx.fillStyle=S.color.opaque(this._colors.background).css;else if(s.isBgRGB())this._ctx.fillStyle="rgb("+m.AttributeData.toColorRGB(s.getBgColor()).join(",")+")";else{var g=s.getBgColor();this._optionsService.options.drawBoldTextInBrightColors&&s.isBold()&&g<8&&(g+=8),this._ctx.fillStyle=this._colors.ansi[g].css}else if(d)this._ctx.fillStyle=d.css;else if(s.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(s.isFgRGB())this._ctx.fillStyle="rgb("+m.AttributeData.toColorRGB(s.getFgColor()).join(",")+")";else{var x=s.getFgColor();this._optionsService.options.drawBoldTextInBrightColors&&s.isBold()&&x<8&&(x+=8),this._ctx.fillStyle=this._colors.ansi[x].css}this._clipRow(c),s.isDim()&&(this._ctx.globalAlpha=y.DIM_OPACITY);var T=!1;this._optionsService.options.customGlyphs!==!1&&(T=(0,f.tryDrawCustomChar)(this._ctx,s.getChars(),o*this._scaledCellWidth,c*this._scaledCellHeight,this._scaledCellWidth,this._scaledCellHeight)),T||this._ctx.fillText(s.getChars(),o*this._scaledCellWidth+this._scaledCharLeft,c*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight),this._ctx.restore()},a.prototype._clipRow=function(s){this._ctx.beginPath(),this._ctx.rect(0,s*this._scaledCellHeight,this._bufferService.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},a.prototype._getFont=function(s,o){return(o?"italic":"")+" "+(s?this._optionsService.options.fontWeightBold:this._optionsService.options.fontWeight)+" "+this._optionsService.options.fontSize*window.devicePixelRatio+"px "+this._optionsService.options.fontFamily},a.prototype._getContrastColor=function(s){if(this._optionsService.options.minimumContrastRatio!==1){var o=this._colors.contrastCache.getColor(s.bg,s.fg);if(o!==void 0)return o||void 0;var c=s.getFgColor(),d=s.getFgColorMode(),g=s.getBgColor(),x=s.getBgColorMode(),T=!!s.isInverse(),H=!!s.isInverse();if(T){var P=c;c=g,g=P;var M=d;d=x,x=M}var L=this._resolveBackgroundRgba(x,g,T),D=this._resolveForegroundRgba(d,c,T,H),E=S.rgba.ensureContrastRatio(L,D,this._optionsService.options.minimumContrastRatio);if(E){var Y={css:S.channels.toCss(E>>24&255,E>>16&255,E>>8&255),rgba:E};return this._colors.contrastCache.setColor(s.bg,s.fg,Y),Y}this._colors.contrastCache.setColor(s.bg,s.fg,null)}},a.prototype._resolveBackgroundRgba=function(s,o,c){switch(s){case 16777216:case 33554432:return this._colors.ansi[o].rgba;case 50331648:return o<<8;default:return c?this._colors.foreground.rgba:this._colors.background.rgba}},a.prototype._resolveForegroundRgba=function(s,o,c,d){switch(s){case 16777216:case 33554432:return this._optionsService.options.drawBoldTextInBrightColors&&d&&o<8&&(o+=8),this._colors.ansi[o].rgba;case 50331648:return o<<8;default:return c?this._colors.background.rgba:this._colors.foreground.rgba}},a}();h.BaseRenderLayer=p},2512:function($,h,k){var v,y=this&&this.__extends||(v=function(o,c){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,g){d.__proto__=g}||function(d,g){for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&(d[x]=g[x])},v(o,c)},function(o,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function d(){this.constructor=o}v(o,c),o.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}),w=this&&this.__decorate||function(o,c,d,g){var x,T=arguments.length,H=T<3?c:g===null?g=Object.getOwnPropertyDescriptor(c,d):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(o,c,d,g);else for(var P=o.length-1;P>=0;P--)(x=o[P])&&(H=(T<3?x(H):T>3?x(c,d,H):x(c,d))||H);return T>3&&H&&Object.defineProperty(c,d,H),H},m=this&&this.__param||function(o,c){return function(d,g){c(d,g,o)}};Object.defineProperty(h,"__esModule",{value:!0}),h.CursorRenderLayer=void 0;var b=k(1546),S=k(511),u=k(2585),f=k(4725),p=600,a=function(o){function c(d,g,x,T,H,P,M,L,D){var E=o.call(this,d,"cursor",g,!0,x,T,P,M)||this;return E._onRequestRedraw=H,E._coreService=L,E._coreBrowserService=D,E._cell=new S.CellData,E._state={x:0,y:0,isFocused:!1,style:"",width:0},E._cursorRenderers={bar:E._renderBarCursor.bind(E),block:E._renderBlockCursor.bind(E),underline:E._renderUnderlineCursor.bind(E)},E}return y(c,o),c.prototype.dispose=function(){this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=void 0),o.prototype.dispose.call(this)},c.prototype.resize=function(d){o.prototype.resize.call(this,d),this._state={x:0,y:0,isFocused:!1,style:"",width:0}},c.prototype.reset=function(){var d;this._clearCursor(),(d=this._cursorBlinkStateManager)===null||d===void 0||d.restartBlinkAnimation(),this.onOptionsChanged()},c.prototype.onBlur=function(){var d;(d=this._cursorBlinkStateManager)===null||d===void 0||d.pause(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},c.prototype.onFocus=function(){var d;(d=this._cursorBlinkStateManager)===null||d===void 0||d.resume(),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},c.prototype.onOptionsChanged=function(){var d,g=this;this._optionsService.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new s(this._coreBrowserService.isFocused,function(){g._render(!0)})):((d=this._cursorBlinkStateManager)===null||d===void 0||d.dispose(),this._cursorBlinkStateManager=void 0),this._onRequestRedraw.fire({start:this._bufferService.buffer.y,end:this._bufferService.buffer.y})},c.prototype.onCursorMove=function(){var d;(d=this._cursorBlinkStateManager)===null||d===void 0||d.restartBlinkAnimation()},c.prototype.onGridChanged=function(d,g){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(!1):this._cursorBlinkStateManager.restartBlinkAnimation()},c.prototype._render=function(d){if(this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden){var g=this._bufferService.buffer.ybase+this._bufferService.buffer.y,x=g-this._bufferService.buffer.ydisp;if(x<0||x>=this._bufferService.rows)this._clearCursor();else{var T=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1);if(this._bufferService.buffer.lines.get(g).loadCell(T,this._cell),this._cell.content!==void 0){if(!this._coreBrowserService.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css;var H=this._optionsService.options.cursorStyle;return H&&H!=="block"?this._cursorRenderers[H](T,x,this._cell):this._renderBlurCursor(T,x,this._cell),this._ctx.restore(),this._state.x=T,this._state.y=x,this._state.isFocused=!1,this._state.style=H,void(this._state.width=this._cell.getWidth())}if(!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isCursorVisible){if(this._state){if(this._state.x===T&&this._state.y===x&&this._state.isFocused===this._coreBrowserService.isFocused&&this._state.style===this._optionsService.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[this._optionsService.options.cursorStyle||"block"](T,x,this._cell),this._ctx.restore(),this._state.x=T,this._state.y=x,this._state.isFocused=!1,this._state.style=this._optionsService.options.cursorStyle,this._state.width=this._cell.getWidth()}else this._clearCursor()}}}else this._clearCursor()},c.prototype._clearCursor=function(){this._state&&(window.devicePixelRatio<1?this._clearAll():this._clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:0,y:0,isFocused:!1,style:"",width:0})},c.prototype._renderBarCursor=function(d,g,x){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillLeftLineAtCell(d,g,this._optionsService.options.cursorWidth),this._ctx.restore()},c.prototype._renderBlockCursor=function(d,g,x){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillCells(d,g,x.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this._fillCharTrueColor(x,d,g),this._ctx.restore()},c.prototype._renderUnderlineCursor=function(d,g,x){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._fillBottomLineAtCells(d,g),this._ctx.restore()},c.prototype._renderBlurCursor=function(d,g,x){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this._strokeRectAtCell(d,g,x.getWidth(),1),this._ctx.restore()},w([m(5,u.IBufferService),m(6,u.IOptionsService),m(7,u.ICoreService),m(8,f.ICoreBrowserService)],c)}(b.BaseRenderLayer);h.CursorRenderLayer=a;var s=function(){function o(c,d){this._renderCallback=d,this.isCursorVisible=!0,c&&this._restartInterval()}return Object.defineProperty(o.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!1,configurable:!0}),o.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},o.prototype.restartBlinkAnimation=function(){var c=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){c._renderCallback(),c._animationFrame=void 0})))},o.prototype._restartInterval=function(c){var d=this;c===void 0&&(c=p),this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=window.setTimeout(function(){if(d._animationTimeRestarted){var g=p-(Date.now()-d._animationTimeRestarted);if(d._animationTimeRestarted=void 0,g>0)return void d._restartInterval(g)}d.isCursorVisible=!1,d._animationFrame=window.requestAnimationFrame(function(){d._renderCallback(),d._animationFrame=void 0}),d._blinkInterval=window.setInterval(function(){if(d._animationTimeRestarted){var x=p-(Date.now()-d._animationTimeRestarted);return d._animationTimeRestarted=void 0,void d._restartInterval(x)}d.isCursorVisible=!d.isCursorVisible,d._animationFrame=window.requestAnimationFrame(function(){d._renderCallback(),d._animationFrame=void 0})},p)},c)},o.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},o.prototype.resume=function(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()},o}()},8978:($,h,k)=>{var v,y,w,m,b,S,u,f,p,a,s,o,c,d,g,x,T,H,P,M,L,D,E,Y,j,I,F,K,Z,ue,ae,Ce,we,fe,B,N,U,se,G,_e,Le,Be,Ee,Ie,be,qe,_t,Mt,Yt,_r,Zr,li,Dr,Vr,Ut,ci,gt,Ne,sr,ut,Zt,ke,ar,et,Te,je,lr,Ke,Rt,Ye,cr,ft,tr,Vt,Br,gr,tt,Pr,yr,Ot,mr,Hr,Ir,br,Jt,yt,ht,Fr,qt,ur,fr,kt,Et,dt,Sr,Cr,Fe,Se,Dt,wr,nt,De,Bt,rr,Lr,le,O,q,ie,ce,Me,Oe,ge,Je,mt,xr,zt,Ti,Mi,Wr,ui,Ri,fi,Oi,Di,Bi,Pi,tn;Object.defineProperty(h,"__esModule",{value:!0}),h.tryDrawCustomChar=h.boxDrawingDefinitions=h.blockElementDefinitions=void 0;var Tn=k(1752);h.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258A":[{x:0,y:0,w:6,h:8}],"\u258B":[{x:0,y:0,w:5,h:8}],"\u258C":[{x:0,y:0,w:4,h:8}],"\u258D":[{x:0,y:0,w:3,h:8}],"\u258E":[{x:0,y:0,w:2,h:8}],"\u258F":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:9,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259A":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259B":[{x:0,y:0,w:4,h:8},{x:0,y:0,w:4,h:8}],"\u259C":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259D":[{x:4,y:0,w:4,h:4}],"\u259E":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259F":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u{1FB70}":[{x:1,y:0,w:1,h:8}],"\u{1FB71}":[{x:2,y:0,w:1,h:8}],"\u{1FB72}":[{x:3,y:0,w:1,h:8}],"\u{1FB73}":[{x:4,y:0,w:1,h:8}],"\u{1FB74}":[{x:5,y:0,w:1,h:8}],"\u{1FB75}":[{x:6,y:0,w:1,h:8}],"\u{1FB76}":[{x:0,y:1,w:8,h:1}],"\u{1FB77}":[{x:0,y:2,w:8,h:1}],"\u{1FB78}":[{x:0,y:3,w:8,h:1}],"\u{1FB79}":[{x:0,y:4,w:8,h:1}],"\u{1FB7A}":[{x:0,y:5,w:8,h:1}],"\u{1FB7B}":[{x:0,y:6,w:8,h:1}],"\u{1FB7C}":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB7D}":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7E}":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7F}":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB80}":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB81}":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB82}":[{x:0,y:0,w:8,h:2}],"\u{1FB83}":[{x:0,y:0,w:8,h:3}],"\u{1FB84}":[{x:0,y:0,w:8,h:5}],"\u{1FB85}":[{x:0,y:0,w:8,h:6}],"\u{1FB86}":[{x:0,y:0,w:8,h:7}],"\u{1FB87}":[{x:6,y:0,w:2,h:8}],"\u{1FB88}":[{x:5,y:0,w:3,h:8}],"\u{1FB89}":[{x:3,y:0,w:5,h:8}],"\u{1FB8A}":[{x:2,y:0,w:6,h:8}],"\u{1FB8B}":[{x:1,y:0,w:7,h:8}],"\u{1FB95}":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\u{1FB96}":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\u{1FB97}":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};var Mn={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};h.boxDrawingDefinitions={"\u2500":(v={},v[1]="M0,.5 L1,.5",v),"\u2501":(y={},y[3]="M0,.5 L1,.5",y),"\u2502":(w={},w[1]="M.5,0 L.5,1",w),"\u2503":(m={},m[3]="M.5,0 L.5,1",m),"\u250C":(b={},b[1]="M0.5,1 L.5,.5 L1,.5",b),"\u250F":(S={},S[3]="M0.5,1 L.5,.5 L1,.5",S),"\u2510":(u={},u[1]="M0,.5 L.5,.5 L.5,1",u),"\u2513":(f={},f[3]="M0,.5 L.5,.5 L.5,1",f),"\u2514":(p={},p[1]="M.5,0 L.5,.5 L1,.5",p),"\u2517":(a={},a[3]="M.5,0 L.5,.5 L1,.5",a),"\u2518":(s={},s[1]="M.5,0 L.5,.5 L0,.5",s),"\u251B":(o={},o[3]="M.5,0 L.5,.5 L0,.5",o),"\u251C":(c={},c[1]="M.5,0 L.5,1 M.5,.5 L1,.5",c),"\u2523":(d={},d[3]="M.5,0 L.5,1 M.5,.5 L1,.5",d),"\u2524":(g={},g[1]="M.5,0 L.5,1 M.5,.5 L0,.5",g),"\u252B":(x={},x[3]="M.5,0 L.5,1 M.5,.5 L0,.5",x),"\u252C":(T={},T[1]="M0,.5 L1,.5 M.5,.5 L.5,1",T),"\u2533":(H={},H[3]="M0,.5 L1,.5 M.5,.5 L.5,1",H),"\u2534":(P={},P[1]="M0,.5 L1,.5 M.5,.5 L.5,0",P),"\u253B":(M={},M[3]="M0,.5 L1,.5 M.5,.5 L.5,0",M),"\u253C":(L={},L[1]="M0,.5 L1,.5 M.5,0 L.5,1",L),"\u254B":(D={},D[3]="M0,.5 L1,.5 M.5,0 L.5,1",D),"\u2574":(E={},E[1]="M.5,.5 L0,.5",E),"\u2578":(Y={},Y[3]="M.5,.5 L0,.5",Y),"\u2575":(j={},j[1]="M.5,.5 L.5,0",j),"\u2579":(I={},I[3]="M.5,.5 L.5,0",I),"\u2576":(F={},F[1]="M.5,.5 L1,.5",F),"\u257A":(K={},K[3]="M.5,.5 L1,.5",K),"\u2577":(Z={},Z[1]="M.5,.5 L.5,1",Z),"\u257B":(ue={},ue[3]="M.5,.5 L.5,1",ue),"\u2550":(ae={},ae[1]=function(re,te){return"M0,"+(.5-te)+" L1,"+(.5-te)+" M0,"+(.5+te)+" L1,"+(.5+te)},ae),"\u2551":(Ce={},Ce[1]=function(re,te){return"M"+(.5-re)+",0 L"+(.5-re)+",1 M"+(.5+re)+",0 L"+(.5+re)+",1"},Ce),"\u2552":(we={},we[1]=function(re,te){return"M.5,1 L.5,"+(.5-te)+" L1,"+(.5-te)+" M.5,"+(.5+te)+" L1,"+(.5+te)},we),"\u2553":(fe={},fe[1]=function(re,te){return"M"+(.5-re)+",1 L"+(.5-re)+",.5 L1,.5 M"+(.5+re)+",.5 L"+(.5+re)+",1"},fe),"\u2554":(B={},B[1]=function(re,te){return"M1,"+(.5-te)+" L"+(.5-re)+","+(.5-te)+" L"+(.5-re)+",1 M1,"+(.5+te)+" L"+(.5+re)+","+(.5+te)+" L"+(.5+re)+",1"},B),"\u2555":(N={},N[1]=function(re,te){return"M0,"+(.5-te)+" L.5,"+(.5-te)+" L.5,1 M0,"+(.5+te)+" L.5,"+(.5+te)},N),"\u2556":(U={},U[1]=function(re,te){return"M"+(.5+re)+",1 L"+(.5+re)+",.5 L0,.5 M"+(.5-re)+",.5 L"+(.5-re)+",1"},U),"\u2557":(se={},se[1]=function(re,te){return"M0,"+(.5+te)+" L"+(.5-re)+","+(.5+te)+" L"+(.5-re)+",1 M0,"+(.5-te)+" L"+(.5+re)+","+(.5-te)+" L"+(.5+re)+",1"},se),"\u2558":(G={},G[1]=function(re,te){return"M.5,0 L.5,"+(.5+te)+" L1,"+(.5+te)+" M.5,"+(.5-te)+" L1,"+(.5-te)},G),"\u2559":(_e={},_e[1]=function(re,te){return"M1,.5 L"+(.5-re)+",.5 L"+(.5-re)+",0 M"+(.5+re)+",.5 L"+(.5+re)+",0"},_e),"\u255A":(Le={},Le[1]=function(re,te){return"M1,"+(.5-te)+" L"+(.5+re)+","+(.5-te)+" L"+(.5+re)+",0 M1,"+(.5+te)+" L"+(.5-re)+","+(.5+te)+" L"+(.5-re)+",0"},Le),"\u255B":(Be={},Be[1]=function(re,te){return"M0,"+(.5+te)+" L.5,"+(.5+te)+" L.5,0 M0,"+(.5-te)+" L.5,"+(.5-te)},Be),"\u255C":(Ee={},Ee[1]=function(re,te){return"M0,.5 L"+(.5+re)+",.5 L"+(.5+re)+",0 M"+(.5-re)+",.5 L"+(.5-re)+",0"},Ee),"\u255D":(Ie={},Ie[1]=function(re,te){return"M0,"+(.5-te)+" L"+(.5-re)+","+(.5-te)+" L"+(.5-re)+",0 M0,"+(.5+te)+" L"+(.5+re)+","+(.5+te)+" L"+(.5+re)+",0"},Ie),"\u255E":(be={},be[1]=function(re,te){return"M.5,0 L.5,1 M.5,"+(.5-te)+" L1,"+(.5-te)+" M.5,"+(.5+te)+" L1,"+(.5+te)},be),"\u255F":(qe={},qe[1]=function(re,te){return"M"+(.5-re)+",0 L"+(.5-re)+",1 M"+(.5+re)+",0 L"+(.5+re)+",1 M"+(.5+re)+",.5 L1,.5"},qe),"\u2560":(_t={},_t[1]=function(re,te){return"M"+(.5-re)+",0 L"+(.5-re)+",1 M1,"+(.5+te)+" L"+(.5+re)+","+(.5+te)+" L"+(.5+re)+",1 M1,"+(.5-te)+" L"+(.5+re)+","+(.5-te)+" L"+(.5+re)+",0"},_t),"\u2561":(Mt={},Mt[1]=function(re,te){return"M.5,0 L.5,1 M0,"+(.5-te)+" L.5,"+(.5-te)+" M0,"+(.5+te)+" L.5,"+(.5+te)},Mt),"\u2562":(Yt={},Yt[1]=function(re,te){return"M0,.5 L"+(.5-re)+",.5 M"+(.5-re)+",0 L"+(.5-re)+",1 M"+(.5+re)+",0 L"+(.5+re)+",1"},Yt),"\u2563":(_r={},_r[1]=function(re,te){return"M"+(.5+re)+",0 L"+(.5+re)+",1 M0,"+(.5+te)+" L"+(.5-re)+","+(.5+te)+" L"+(.5-re)+",1 M0,"+(.5-te)+" L"+(.5-re)+","+(.5-te)+" L"+(.5-re)+",0"},_r),"\u2564":(Zr={},Zr[1]=function(re,te){return"M0,"+(.5-te)+" L1,"+(.5-te)+" M0,"+(.5+te)+" L1,"+(.5+te)+" M.5,"+(.5+te)+" L.5,1"},Zr),"\u2565":(li={},li[1]=function(re,te){return"M0,.5 L1,.5 M"+(.5-re)+",.5 L"+(.5-re)+",1 M"+(.5+re)+",.5 L"+(.5+re)+",1"},li),"\u2566":(Dr={},Dr[1]=function(re,te){return"M0,"+(.5-te)+" L1,"+(.5-te)+" M0,"+(.5+te)+" L"+(.5-re)+","+(.5+te)+" L"+(.5-re)+",1 M1,"+(.5+te)+" L"+(.5+re)+","+(.5+te)+" L"+(.5+re)+",1"},Dr),"\u2567":(Vr={},Vr[1]=function(re,te){return"M.5,0 L.5,"+(.5-te)+" M0,"+(.5-te)+" L1,"+(.5-te)+" M0,"+(.5+te)+" L1,"+(.5+te)},Vr),"\u2568":(Ut={},Ut[1]=function(re,te){return"M0,.5 L1,.5 M"+(.5-re)+",.5 L"+(.5-re)+",0 M"+(.5+re)+",.5 L"+(.5+re)+",0"},Ut),"\u2569":(ci={},ci[1]=function(re,te){return"M0,"+(.5+te)+" L1,"+(.5+te)+" M0,"+(.5-te)+" L"+(.5-re)+","+(.5-te)+" L"+(.5-re)+",0 M1,"+(.5-te)+" L"+(.5+re)+","+(.5-te)+" L"+(.5+re)+",0"},ci),"\u256A":(gt={},gt[1]=function(re,te){return"M.5,0 L.5,1 M0,"+(.5-te)+" L1,"+(.5-te)+" M0,"+(.5+te)+" L1,"+(.5+te)},gt),"\u256B":(Ne={},Ne[1]=function(re,te){return"M0,.5 L1,.5 M"+(.5-re)+",0 L"+(.5-re)+",1 M"+(.5+re)+",0 L"+(.5+re)+",1"},Ne),"\u256C":(sr={},sr[1]=function(re,te){return"M0,"+(.5+te)+" L"+(.5-re)+","+(.5+te)+" L"+(.5-re)+",1 M1,"+(.5+te)+" L"+(.5+re)+","+(.5+te)+" L"+(.5+re)+",1 M0,"+(.5-te)+" L"+(.5-re)+","+(.5-te)+" L"+(.5-re)+",0 M1,"+(.5-te)+" L"+(.5+re)+","+(.5-te)+" L"+(.5+re)+",0"},sr),"\u2571":(ut={},ut[1]="M1,0 L0,1",ut),"\u2572":(Zt={},Zt[1]="M0,0 L1,1",Zt),"\u2573":(ke={},ke[1]="M1,0 L0,1 M0,0 L1,1",ke),"\u257C":(ar={},ar[1]="M.5,.5 L0,.5",ar[3]="M.5,.5 L1,.5",ar),"\u257D":(et={},et[1]="M.5,.5 L.5,0",et[3]="M.5,.5 L.5,1",et),"\u257E":(Te={},Te[1]="M.5,.5 L1,.5",Te[3]="M.5,.5 L0,.5",Te),"\u257F":(je={},je[1]="M.5,.5 L.5,1",je[3]="M.5,.5 L.5,0",je),"\u250D":(lr={},lr[1]="M.5,.5 L.5,1",lr[3]="M.5,.5 L1,.5",lr),"\u250E":(Ke={},Ke[1]="M.5,.5 L1,.5",Ke[3]="M.5,.5 L.5,1",Ke),"\u2511":(Rt={},Rt[1]="M.5,.5 L.5,1",Rt[3]="M.5,.5 L0,.5",Rt),"\u2512":(Ye={},Ye[1]="M.5,.5 L0,.5",Ye[3]="M.5,.5 L.5,1",Ye),"\u2515":(cr={},cr[1]="M.5,.5 L.5,0",cr[3]="M.5,.5 L1,.5",cr),"\u2516":(ft={},ft[1]="M.5,.5 L1,.5",ft[3]="M.5,.5 L.5,0",ft),"\u2519":(tr={},tr[1]="M.5,.5 L.5,0",tr[3]="M.5,.5 L0,.5",tr),"\u251A":(Vt={},Vt[1]="M.5,.5 L0,.5",Vt[3]="M.5,.5 L.5,0",Vt),"\u251D":(Br={},Br[1]="M.5,0 L.5,1",Br[3]="M.5,.5 L1,.5",Br),"\u251E":(gr={},gr[1]="M0.5,1 L.5,.5 L1,.5",gr[3]="M.5,.5 L.5,0",gr),"\u251F":(tt={},tt[1]="M.5,0 L.5,.5 L1,.5",tt[3]="M.5,.5 L.5,1",tt),"\u2520":(Pr={},Pr[1]="M.5,.5 L1,.5",Pr[3]="M.5,0 L.5,1",Pr),"\u2521":(yr={},yr[1]="M.5,.5 L.5,1",yr[3]="M.5,0 L.5,.5 L1,.5",yr),"\u2522":(Ot={},Ot[1]="M.5,.5 L.5,0",Ot[3]="M0.5,1 L.5,.5 L1,.5",Ot),"\u2525":(mr={},mr[1]="M.5,0 L.5,1",mr[3]="M.5,.5 L0,.5",mr),"\u2526":(Hr={},Hr[1]="M0,.5 L.5,.5 L.5,1",Hr[3]="M.5,.5 L.5,0",Hr),"\u2527":(Ir={},Ir[1]="M.5,0 L.5,.5 L0,.5",Ir[3]="M.5,.5 L.5,1",Ir),"\u2528":(br={},br[1]="M.5,.5 L0,.5",br[3]="M.5,0 L.5,1",br),"\u2529":(Jt={},Jt[1]="M.5,.5 L.5,1",Jt[3]="M.5,0 L.5,.5 L0,.5",Jt),"\u252A":(yt={},yt[1]="M.5,.5 L.5,0",yt[3]="M0,.5 L.5,.5 L.5,1",yt),"\u252D":(ht={},ht[1]="M0.5,1 L.5,.5 L1,.5",ht[3]="M.5,.5 L0,.5",ht),"\u252E":(Fr={},Fr[1]="M0,.5 L.5,.5 L.5,1",Fr[3]="M.5,.5 L1,.5",Fr),"\u252F":(qt={},qt[1]="M.5,.5 L.5,1",qt[3]="M0,.5 L1,.5",qt),"\u2530":(ur={},ur[1]="M0,.5 L1,.5",ur[3]="M.5,.5 L.5,1",ur),"\u2531":(fr={},fr[1]="M.5,.5 L1,.5",fr[3]="M0,.5 L.5,.5 L.5,1",fr),"\u2532":(kt={},kt[1]="M.5,.5 L0,.5",kt[3]="M0.5,1 L.5,.5 L1,.5",kt),"\u2535":(Et={},Et[1]="M.5,0 L.5,.5 L1,.5",Et[3]="M.5,.5 L0,.5",Et),"\u2536":(dt={},dt[1]="M.5,0 L.5,.5 L0,.5",dt[3]="M.5,.5 L1,.5",dt),"\u2537":(Sr={},Sr[1]="M.5,.5 L.5,0",Sr[3]="M0,.5 L1,.5",Sr),"\u2538":(Cr={},Cr[1]="M0,.5 L1,.5",Cr[3]="M.5,.5 L.5,0",Cr),"\u2539":(Fe={},Fe[1]="M.5,.5 L1,.5",Fe[3]="M.5,0 L.5,.5 L0,.5",Fe),"\u253A":(Se={},Se[1]="M.5,.5 L0,.5",Se[3]="M.5,0 L.5,.5 L1,.5",Se),"\u253D":(Dt={},Dt[1]="M.5,0 L.5,1 M.5,.5 L1,.5",Dt[3]="M.5,.5 L0,.5",Dt),"\u253E":(wr={},wr[1]="M.5,0 L.5,1 M.5,.5 L0,.5",wr[3]="M.5,.5 L1,.5",wr),"\u253F":(nt={},nt[1]="M.5,0 L.5,1",nt[3]="M0,.5 L1,.5",nt),"\u2540":(De={},De[1]="M0,.5 L1,.5 M.5,.5 L.5,1",De[3]="M.5,.5 L.5,0",De),"\u2541":(Bt={},Bt[1]="M.5,.5 L.5,0 M0,.5 L1,.5",Bt[3]="M.5,.5 L.5,1",Bt),"\u2542":(rr={},rr[1]="M0,.5 L1,.5",rr[3]="M.5,0 L.5,1",rr),"\u2543":(Lr={},Lr[1]="M0.5,1 L.5,.5 L1,.5",Lr[3]="M.5,0 L.5,.5 L0,.5",Lr),"\u2544":(le={},le[1]="M0,.5 L.5,.5 L.5,1",le[3]="M.5,0 L.5,.5 L1,.5",le),"\u2545":(O={},O[1]="M.5,0 L.5,.5 L1,.5",O[3]="M0,.5 L.5,.5 L.5,1",O),"\u2546":(q={},q[1]="M.5,0 L.5,.5 L0,.5",q[3]="M0.5,1 L.5,.5 L1,.5",q),"\u2547":(ie={},ie[1]="M.5,.5 L.5,1",ie[3]="M.5,.5 L.5,0 M0,.5 L1,.5",ie),"\u2548":(ce={},ce[1]="M.5,.5 L.5,0",ce[3]="M0,.5 L1,.5 M.5,.5 L.5,1",ce),"\u2549":(Me={},Me[1]="M.5,.5 L1,.5",Me[3]="M.5,0 L.5,1 M.5,.5 L0,.5",Me),"\u254A":(Oe={},Oe[1]="M.5,.5 L0,.5",Oe[3]="M.5,0 L.5,1 M.5,.5 L1,.5",Oe),"\u254C":(ge={},ge[1]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",ge),"\u254D":(Je={},Je[3]="M.1,.5 L.4,.5 M.6,.5 L.9,.5",Je),"\u2504":(mt={},mt[1]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",mt),"\u2505":(xr={},xr[3]="M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5",xr),"\u2508":(zt={},zt[1]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",zt),"\u2509":(Ti={},Ti[3]="M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5",Ti),"\u254E":(Mi={},Mi[1]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",Mi),"\u254F":(Wr={},Wr[3]="M.5,.1 L.5,.4 M.5,.6 L.5,.9",Wr),"\u2506":(ui={},ui[1]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",ui),"\u2507":(Ri={},Ri[3]="M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333",Ri),"\u250A":(fi={},fi[1]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",fi),"\u250B":(Oi={},Oi[3]="M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95",Oi),"\u256D":(Di={},Di[1]="C.5,1,.5,.5,1,.5",Di),"\u256E":(Bi={},Bi[1]="C.5,1,.5,.5,0,.5",Bi),"\u256F":(Pi={},Pi[1]="C.5,0,.5,.5,0,.5",Pi),"\u2570":(tn={},tn[1]="C.5,0,.5,.5,1,.5",tn)},h.tryDrawCustomChar=function(re,te,nr,hi,di,Ze){var $t=h.blockElementDefinitions[te];if($t)return function(bt,Pt,kr,Nr,jr,Ur){for(var St=0;St<Pt.length;St++){var Ht=Pt[St],Ge=jr/8,rt=Ur/8;bt.fillRect(kr+Ht.x*Ge,Nr+Ht.y*rt,Ht.w*Ge,Ht.h*rt)}}(re,$t,nr,hi,di,Ze),!0;var or=Mn[te];if(or)return function(bt,Pt,kr,Nr,jr,Ur){var St,Ht=ir.get(Pt);Ht||(Ht=new Map,ir.set(Pt,Ht));var Ge=bt.fillStyle;if(typeof Ge!="string")throw new Error('Unexpected fillStyle type "'+Ge+'"');var rt=Ht.get(Ge);if(!rt){var Qt=Pt[0].length,qr=Pt.length,hr=document.createElement("canvas");hr.width=Qt,hr.height=qr;var pi=(0,Tn.throwIfFalsy)(hr.getContext("2d")),Ct=new ImageData(Qt,qr),Er=void 0,wt=void 0,$r=void 0,vi=void 0;if(Ge.startsWith("#"))Er=parseInt(Ge.substr(1,2),16),wt=parseInt(Ge.substr(3,2),16),$r=parseInt(Ge.substr(5,2),16),vi=Ge.length>7&&parseInt(Ge.substr(7,2),16)||1;else{if(!Ge.startsWith("rgba"))throw new Error('Unexpected fillStyle color format "'+Ge+'" when drawing pattern glyph');Er=(St=Ge.substring(5,Ge.length-1).split(",").map(function(no){return parseFloat(no)}))[0],wt=St[1],$r=St[2],vi=St[3]}for(var Kt=0;Kt<qr;Kt++)for(var zr=0;zr<Qt;zr++)Ct.data[4*(Kt*Qt+zr)]=Er,Ct.data[4*(Kt*Qt+zr)+1]=wt,Ct.data[4*(Kt*Qt+zr)+2]=$r,Ct.data[4*(Kt*Qt+zr)+3]=Pt[Kt][zr]*(255*vi);pi.putImageData(Ct,0,0),rt=(0,Tn.throwIfFalsy)(bt.createPattern(hr,null)),Ht.set(Ge,rt)}bt.fillStyle=rt,bt.fillRect(kr,Nr,jr,Ur)}(re,or,nr,hi,di,Ze),!0;var Jr=h.boxDrawingDefinitions[te];return!!Jr&&(function(bt,Pt,kr,Nr,jr,Ur){bt.strokeStyle=bt.fillStyle;for(var St=0,Ht=Object.entries(Pt);St<Ht.length;St++){var Ge=Ht[St],rt=Ge[0],Qt=Ge[1];bt.beginPath(),bt.lineWidth=window.devicePixelRatio*Number.parseInt(rt);for(var qr=0,hr=(typeof Qt=="function"?Qt(.15,.15/Ur*jr):Qt).split(" ");qr<hr.length;qr++){var pi=hr[qr],Ct=pi[0],Er=io[Ct];if(Er){var wt=pi.substring(1).split(",");wt[0]&&wt[1]&&Er(bt,Hi(wt,jr,Ur,kr,Nr))}else console.error('Could not find drawing instructions for "'+Ct+'"')}bt.stroke(),bt.closePath()}}(re,Jr,nr,hi,di,Ze),!0)};var ir=new Map;function Rn(re,te,nr){return nr===void 0&&(nr=0),Math.max(Math.min(re,te),nr)}var io={C:function(re,te){return re.bezierCurveTo(te[0],te[1],te[2],te[3],te[4],te[5])},L:function(re,te){return re.lineTo(te[0],te[1])},M:function(re,te){return re.moveTo(te[0],te[1])}};function Hi(re,te,nr,hi,di){var Ze=re.map(function(Jr){return parseFloat(Jr)||parseInt(Jr)});if(Ze.length<2)throw new Error("Too few arguments for instruction");for(var $t=0;$t<Ze.length;$t+=2)Ze[$t]*=te,Ze[$t]!==0&&(Ze[$t]=Rn(Math.round(Ze[$t]+.5)-.5,te,0)),Ze[$t]+=hi;for(var or=1;or<Ze.length;or+=2)Ze[or]*=nr,Ze[or]!==0&&(Ze[or]=Rn(Math.round(Ze[or]+.5)-.5,nr,0)),Ze[or]+=di;return Ze}},3700:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.GridCache=void 0;var k=function(){function v(){this.cache=[]}return v.prototype.resize=function(y,w){for(var m=0;m<y;m++){this.cache.length<=m&&this.cache.push([]);for(var b=this.cache[m].length;b<w;b++)this.cache[m].push(void 0);this.cache[m].length=w}this.cache.length=y},v.prototype.clear=function(){for(var y=0;y<this.cache.length;y++)for(var w=0;w<this.cache[y].length;w++)this.cache[y][w]=void 0},v}();h.GridCache=k},5098:function($,h,k){var v,y=this&&this.__extends||(v=function(a,s){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},v(a,s)},function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function o(){this.constructor=a}v(a,s),a.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}),w=this&&this.__decorate||function(a,s,o,c){var d,g=arguments.length,x=g<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(a,s,o,c);else for(var T=a.length-1;T>=0;T--)(d=a[T])&&(x=(g<3?d(x):g>3?d(s,o,x):d(s,o))||x);return g>3&&x&&Object.defineProperty(s,o,x),x},m=this&&this.__param||function(a,s){return function(o,c){s(o,c,a)}};Object.defineProperty(h,"__esModule",{value:!0}),h.LinkRenderLayer=void 0;var b=k(1546),S=k(8803),u=k(2040),f=k(2585),p=function(a){function s(o,c,d,g,x,T,H,P){var M=a.call(this,o,"link",c,!0,d,g,H,P)||this;return x.onShowLinkUnderline(function(L){return M._onShowLinkUnderline(L)}),x.onHideLinkUnderline(function(L){return M._onHideLinkUnderline(L)}),T.onShowLinkUnderline(function(L){return M._onShowLinkUnderline(L)}),T.onHideLinkUnderline(function(L){return M._onHideLinkUnderline(L)}),M}return y(s,a),s.prototype.resize=function(o){a.prototype.resize.call(this,o),this._state=void 0},s.prototype.reset=function(){this._clearCurrentLink()},s.prototype._clearCurrentLink=function(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var o=this._state.y2-this._state.y1-1;o>0&&this._clearCells(0,this._state.y1+1,this._state.cols,o),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}},s.prototype._onShowLinkUnderline=function(o){if(o.fg===S.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:o.fg&&(0,u.is256Color)(o.fg)?this._ctx.fillStyle=this._colors.ansi[o.fg].css:this._ctx.fillStyle=this._colors.foreground.css,o.y1===o.y2)this._fillBottomLineAtCells(o.x1,o.y1,o.x2-o.x1);else{this._fillBottomLineAtCells(o.x1,o.y1,o.cols-o.x1);for(var c=o.y1+1;c<o.y2;c++)this._fillBottomLineAtCells(0,c,o.cols);this._fillBottomLineAtCells(0,o.y2,o.x2)}this._state=o},s.prototype._onHideLinkUnderline=function(o){this._clearCurrentLink()},w([m(6,f.IBufferService),m(7,f.IOptionsService)],s)}(b.BaseRenderLayer);h.LinkRenderLayer=p},3525:function($,h,k){var v,y=this&&this.__extends||(v=function(x,T){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,P){H.__proto__=P}||function(H,P){for(var M in P)Object.prototype.hasOwnProperty.call(P,M)&&(H[M]=P[M])},v(x,T)},function(x,T){if(typeof T!="function"&&T!==null)throw new TypeError("Class extends value "+String(T)+" is not a constructor or null");function H(){this.constructor=x}v(x,T),x.prototype=T===null?Object.create(T):(H.prototype=T.prototype,new H)}),w=this&&this.__decorate||function(x,T,H,P){var M,L=arguments.length,D=L<3?T:P===null?P=Object.getOwnPropertyDescriptor(T,H):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(x,T,H,P);else for(var E=x.length-1;E>=0;E--)(M=x[E])&&(D=(L<3?M(D):L>3?M(T,H,D):M(T,H))||D);return L>3&&D&&Object.defineProperty(T,H,D),D},m=this&&this.__param||function(x,T){return function(H,P){T(H,P,x)}};Object.defineProperty(h,"__esModule",{value:!0}),h.Renderer=void 0;var b=k(9596),S=k(4149),u=k(2512),f=k(5098),p=k(844),a=k(4725),s=k(2585),o=k(1420),c=k(8460),d=1,g=function(x){function T(H,P,M,L,D,E,Y,j){var I=x.call(this)||this;I._colors=H,I._screenElement=P,I._bufferService=E,I._charSizeService=Y,I._optionsService=j,I._id=d++,I._onRequestRedraw=new c.EventEmitter;var F=I._optionsService.options.allowTransparency;return I._renderLayers=[D.createInstance(b.TextRenderLayer,I._screenElement,0,I._colors,F,I._id),D.createInstance(S.SelectionRenderLayer,I._screenElement,1,I._colors,I._id),D.createInstance(f.LinkRenderLayer,I._screenElement,2,I._colors,I._id,M,L),D.createInstance(u.CursorRenderLayer,I._screenElement,3,I._colors,I._id,I._onRequestRedraw)],I.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},I._devicePixelRatio=window.devicePixelRatio,I._updateDimensions(),I.onOptionsChanged(),I}return y(T,x),Object.defineProperty(T.prototype,"onRequestRedraw",{get:function(){return this._onRequestRedraw.event},enumerable:!1,configurable:!0}),T.prototype.dispose=function(){for(var H=0,P=this._renderLayers;H<P.length;H++)P[H].dispose();x.prototype.dispose.call(this),(0,o.removeTerminalFromCache)(this._id)},T.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._bufferService.cols,this._bufferService.rows))},T.prototype.setColors=function(H){this._colors=H;for(var P=0,M=this._renderLayers;P<M.length;P++){var L=M[P];L.setColors(this._colors),L.reset()}},T.prototype.onResize=function(H,P){this._updateDimensions();for(var M=0,L=this._renderLayers;M<L.length;M++)L[M].resize(this.dimensions);this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},T.prototype.onCharSizeChanged=function(){this.onResize(this._bufferService.cols,this._bufferService.rows)},T.prototype.onBlur=function(){this._runOperation(function(H){return H.onBlur()})},T.prototype.onFocus=function(){this._runOperation(function(H){return H.onFocus()})},T.prototype.onSelectionChanged=function(H,P,M){M===void 0&&(M=!1),this._runOperation(function(L){return L.onSelectionChanged(H,P,M)})},T.prototype.onCursorMove=function(){this._runOperation(function(H){return H.onCursorMove()})},T.prototype.onOptionsChanged=function(){this._runOperation(function(H){return H.onOptionsChanged()})},T.prototype.clear=function(){this._runOperation(function(H){return H.reset()})},T.prototype._runOperation=function(H){for(var P=0,M=this._renderLayers;P<M.length;P++)H(M[P])},T.prototype.renderRows=function(H,P){for(var M=0,L=this._renderLayers;M<L.length;M++)L[M].onGridChanged(H,P)},T.prototype.clearTextureAtlas=function(){for(var H=0,P=this._renderLayers;H<P.length;H++)P[H].clearTextureAtlas()},T.prototype._updateDimensions=function(){this._charSizeService.hasValidSize&&(this.dimensions.scaledCharWidth=Math.floor(this._charSizeService.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.options.lineHeight),this.dimensions.scaledCharTop=this._optionsService.options.lineHeight===1?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.options.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._optionsService.options.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._bufferService.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._bufferService.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols)},w([m(4,s.IInstantiationService),m(5,s.IBufferService),m(6,a.ICharSizeService),m(7,s.IOptionsService)],T)}(p.Disposable);h.Renderer=g},1752:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.throwIfFalsy=void 0,h.throwIfFalsy=function(k){if(!k)throw new Error("value must not be falsy");return k}},4149:function($,h,k){var v,y=this&&this.__extends||(v=function(f,p){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,s){a.__proto__=s}||function(a,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(a[o]=s[o])},v(f,p)},function(f,p){if(typeof p!="function"&&p!==null)throw new TypeError("Class extends value "+String(p)+" is not a constructor or null");function a(){this.constructor=f}v(f,p),f.prototype=p===null?Object.create(p):(a.prototype=p.prototype,new a)}),w=this&&this.__decorate||function(f,p,a,s){var o,c=arguments.length,d=c<3?p:s===null?s=Object.getOwnPropertyDescriptor(p,a):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(f,p,a,s);else for(var g=f.length-1;g>=0;g--)(o=f[g])&&(d=(c<3?o(d):c>3?o(p,a,d):o(p,a))||d);return c>3&&d&&Object.defineProperty(p,a,d),d},m=this&&this.__param||function(f,p){return function(a,s){p(a,s,f)}};Object.defineProperty(h,"__esModule",{value:!0}),h.SelectionRenderLayer=void 0;var b=k(1546),S=k(2585),u=function(f){function p(a,s,o,c,d,g){var x=f.call(this,a,"selection",s,!0,o,c,d,g)||this;return x._clearState(),x}return y(p,f),p.prototype._clearState=function(){this._state={start:void 0,end:void 0,columnSelectMode:void 0,ydisp:void 0}},p.prototype.resize=function(a){f.prototype.resize.call(this,a),this._clearState()},p.prototype.reset=function(){this._state.start&&this._state.end&&(this._clearState(),this._clearAll())},p.prototype.onSelectionChanged=function(a,s,o){if(this._didStateChange(a,s,o,this._bufferService.buffer.ydisp))if(this._clearAll(),a&&s){var c=a[1]-this._bufferService.buffer.ydisp,d=s[1]-this._bufferService.buffer.ydisp,g=Math.max(c,0),x=Math.min(d,this._bufferService.rows-1);if(g>=this._bufferService.rows||x<0)this._state.ydisp=this._bufferService.buffer.ydisp;else{if(this._ctx.fillStyle=this._colors.selectionTransparent.css,o){var T=a[0],H=s[0]-T,P=x-g+1;this._fillCells(T,g,H,P)}else{T=c===g?a[0]:0;var M=g===d?s[0]:this._bufferService.cols;this._fillCells(T,g,M-T,1);var L=Math.max(x-g-1,0);if(this._fillCells(0,g+1,this._bufferService.cols,L),g!==x){var D=d===x?s[0]:this._bufferService.cols;this._fillCells(0,x,D,1)}}this._state.start=[a[0],a[1]],this._state.end=[s[0],s[1]],this._state.columnSelectMode=o,this._state.ydisp=this._bufferService.buffer.ydisp}}else this._clearState()},p.prototype._didStateChange=function(a,s,o,c){return!this._areCoordinatesEqual(a,this._state.start)||!this._areCoordinatesEqual(s,this._state.end)||o!==this._state.columnSelectMode||c!==this._state.ydisp},p.prototype._areCoordinatesEqual=function(a,s){return!(!a||!s)&&a[0]===s[0]&&a[1]===s[1]},w([m(4,S.IBufferService),m(5,S.IOptionsService)],p)}(b.BaseRenderLayer);h.SelectionRenderLayer=u},9596:function($,h,k){var v,y=this&&this.__extends||(v=function(d,g){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,T){x.__proto__=T}||function(x,T){for(var H in T)Object.prototype.hasOwnProperty.call(T,H)&&(x[H]=T[H])},v(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function x(){this.constructor=d}v(d,g),d.prototype=g===null?Object.create(g):(x.prototype=g.prototype,new x)}),w=this&&this.__decorate||function(d,g,x,T){var H,P=arguments.length,M=P<3?g:T===null?T=Object.getOwnPropertyDescriptor(g,x):T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(d,g,x,T);else for(var L=d.length-1;L>=0;L--)(H=d[L])&&(M=(P<3?H(M):P>3?H(g,x,M):H(g,x))||M);return P>3&&M&&Object.defineProperty(g,x,M),M},m=this&&this.__param||function(d,g){return function(x,T){g(x,T,d)}};Object.defineProperty(h,"__esModule",{value:!0}),h.TextRenderLayer=void 0;var b=k(3700),S=k(1546),u=k(3734),f=k(643),p=k(511),a=k(2585),s=k(4725),o=k(4269),c=function(d){function g(x,T,H,P,M,L,D,E){var Y=d.call(this,x,"text",T,P,H,M,L,D)||this;return Y._characterJoinerService=E,Y._characterWidth=0,Y._characterFont="",Y._characterOverlapCache={},Y._workCell=new p.CellData,Y._state=new b.GridCache,Y}return y(g,d),g.prototype.resize=function(x){d.prototype.resize.call(this,x);var T=this._getFont(!1,!1);this._characterWidth===x.scaledCharWidth&&this._characterFont===T||(this._characterWidth=x.scaledCharWidth,this._characterFont=T,this._characterOverlapCache={}),this._state.clear(),this._state.resize(this._bufferService.cols,this._bufferService.rows)},g.prototype.reset=function(){this._state.clear(),this._clearAll()},g.prototype._forEachCell=function(x,T,H){for(var P=x;P<=T;P++)for(var M=P+this._bufferService.buffer.ydisp,L=this._bufferService.buffer.lines.get(M),D=this._characterJoinerService.getJoinedCharacters(M),E=0;E<this._bufferService.cols;E++){L.loadCell(E,this._workCell);var Y=this._workCell,j=!1,I=E;if(Y.getWidth()!==0){if(D.length>0&&E===D[0][0]){j=!0;var F=D.shift();Y=new o.JoinedCellData(this._workCell,L.translateToString(!0,F[0],F[1]),F[1]-F[0]),I=F[1]-1}!j&&this._isOverlapping(Y)&&I<L.length-1&&L.getCodePoint(I+1)===f.NULL_CELL_CODE&&(Y.content&=-12582913,Y.content|=2<<22),H(Y,E,P),E=I}}},g.prototype._drawBackground=function(x,T){var H=this,P=this._ctx,M=this._bufferService.cols,L=0,D=0,E=null;P.save(),this._forEachCell(x,T,function(Y,j,I){var F=null;Y.isInverse()?F=Y.isFgDefault()?H._colors.foreground.css:Y.isFgRGB()?"rgb("+u.AttributeData.toColorRGB(Y.getFgColor()).join(",")+")":H._colors.ansi[Y.getFgColor()].css:Y.isBgRGB()?F="rgb("+u.AttributeData.toColorRGB(Y.getBgColor()).join(",")+")":Y.isBgPalette()&&(F=H._colors.ansi[Y.getBgColor()].css),E===null&&(L=j,D=I),I!==D?(P.fillStyle=E||"",H._fillCells(L,D,M-L,1),L=j,D=I):E!==F&&(P.fillStyle=E||"",H._fillCells(L,D,j-L,1),L=j,D=I),E=F}),E!==null&&(P.fillStyle=E,this._fillCells(L,D,M-L,1)),P.restore()},g.prototype._drawForeground=function(x,T){var H=this;this._forEachCell(x,T,function(P,M,L){if(!P.isInvisible()&&(H._drawChars(P,M,L),P.isUnderline()||P.isStrikethrough())){if(H._ctx.save(),P.isInverse())if(P.isBgDefault())H._ctx.fillStyle=H._colors.background.css;else if(P.isBgRGB())H._ctx.fillStyle="rgb("+u.AttributeData.toColorRGB(P.getBgColor()).join(",")+")";else{var D=P.getBgColor();H._optionsService.options.drawBoldTextInBrightColors&&P.isBold()&&D<8&&(D+=8),H._ctx.fillStyle=H._colors.ansi[D].css}else if(P.isFgDefault())H._ctx.fillStyle=H._colors.foreground.css;else if(P.isFgRGB())H._ctx.fillStyle="rgb("+u.AttributeData.toColorRGB(P.getFgColor()).join(",")+")";else{var E=P.getFgColor();H._optionsService.options.drawBoldTextInBrightColors&&P.isBold()&&E<8&&(E+=8),H._ctx.fillStyle=H._colors.ansi[E].css}P.isStrikethrough()&&H._fillMiddleLineAtCells(M,L,P.getWidth()),P.isUnderline()&&H._fillBottomLineAtCells(M,L,P.getWidth()),H._ctx.restore()}})},g.prototype.onGridChanged=function(x,T){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this._clearCells(0,x,this._bufferService.cols,T-x+1),this._drawBackground(x,T),this._drawForeground(x,T))},g.prototype.onOptionsChanged=function(){this._setTransparency(this._optionsService.options.allowTransparency)},g.prototype._isOverlapping=function(x){if(x.getWidth()!==1||x.getCode()<256)return!1;var T=x.getChars();if(this._characterOverlapCache.hasOwnProperty(T))return this._characterOverlapCache[T];this._ctx.save(),this._ctx.font=this._characterFont;var H=Math.floor(this._ctx.measureText(T).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[T]=H,H},w([m(5,a.IBufferService),m(6,a.IOptionsService),m(7,s.ICharacterJoinerService)],g)}(S.BaseRenderLayer);h.TextRenderLayer=c},9616:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BaseCharAtlas=void 0;var k=function(){function v(){this._didWarmUp=!1}return v.prototype.dispose=function(){},v.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},v.prototype._doWarmUp=function(){},v.prototype.clear=function(){},v.prototype.beginFrame=function(){},v}();h.BaseCharAtlas=k},1420:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.removeTerminalFromCache=h.acquireCharAtlas=void 0;var v=k(2040),y=k(1906),w=[];h.acquireCharAtlas=function(m,b,S,u,f){for(var p=(0,v.generateConfig)(u,f,m,S),a=0;a<w.length;a++){var s=(o=w[a]).ownedBy.indexOf(b);if(s>=0){if((0,v.configEquals)(o.config,p))return o.atlas;o.ownedBy.length===1?(o.atlas.dispose(),w.splice(a,1)):o.ownedBy.splice(s,1);break}}for(a=0;a<w.length;a++){var o=w[a];if((0,v.configEquals)(o.config,p))return o.ownedBy.push(b),o.atlas}var c={atlas:new y.DynamicCharAtlas(document,p),config:p,ownedBy:[b]};return w.push(c),c.atlas},h.removeTerminalFromCache=function(m){for(var b=0;b<w.length;b++){var S=w[b].ownedBy.indexOf(m);if(S!==-1){w[b].ownedBy.length===1?(w[b].atlas.dispose(),w.splice(b,1)):w[b].ownedBy.splice(S,1);break}}}},2040:function($,h,k){var v=this&&this.__spreadArray||function(w,m,b){if(b||arguments.length===2)for(var S,u=0,f=m.length;u<f;u++)!S&&u in m||(S||(S=Array.prototype.slice.call(m,0,u)),S[u]=m[u]);return w.concat(S||Array.prototype.slice.call(m))};Object.defineProperty(h,"__esModule",{value:!0}),h.is256Color=h.configEquals=h.generateConfig=void 0;var y=k(643);h.generateConfig=function(w,m,b,S){var u={foreground:S.foreground,background:S.background,cursor:void 0,cursorAccent:void 0,selection:void 0,ansi:v([],S.ansi,!0)};return{devicePixelRatio:window.devicePixelRatio,scaledCharWidth:w,scaledCharHeight:m,fontFamily:b.fontFamily,fontSize:b.fontSize,fontWeight:b.fontWeight,fontWeightBold:b.fontWeightBold,allowTransparency:b.allowTransparency,colors:u}},h.configEquals=function(w,m){for(var b=0;b<w.colors.ansi.length;b++)if(w.colors.ansi[b].rgba!==m.colors.ansi[b].rgba)return!1;return w.devicePixelRatio===m.devicePixelRatio&&w.fontFamily===m.fontFamily&&w.fontSize===m.fontSize&&w.fontWeight===m.fontWeight&&w.fontWeightBold===m.fontWeightBold&&w.allowTransparency===m.allowTransparency&&w.scaledCharWidth===m.scaledCharWidth&&w.scaledCharHeight===m.scaledCharHeight&&w.colors.foreground===m.colors.foreground&&w.colors.background===m.colors.background},h.is256Color=function(w){return w<y.DEFAULT_COLOR}},8803:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.CHAR_ATLAS_CELL_SPACING=h.TEXT_BASELINE=h.DIM_OPACITY=h.INVERTED_DEFAULT_COLOR=void 0;var v=k(6114);h.INVERTED_DEFAULT_COLOR=257,h.DIM_OPACITY=.5,h.TEXT_BASELINE=v.isFirefox?"bottom":"ideographic",h.CHAR_ATLAS_CELL_SPACING=1},1906:function($,h,k){var v,y=this&&this.__extends||(v=function(T,H){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,M){P.__proto__=M}||function(P,M){for(var L in M)Object.prototype.hasOwnProperty.call(M,L)&&(P[L]=M[L])},v(T,H)},function(T,H){if(typeof H!="function"&&H!==null)throw new TypeError("Class extends value "+String(H)+" is not a constructor or null");function P(){this.constructor=T}v(T,H),T.prototype=H===null?Object.create(H):(P.prototype=H.prototype,new P)});Object.defineProperty(h,"__esModule",{value:!0}),h.NoneCharAtlas=h.DynamicCharAtlas=h.getGlyphCacheKey=void 0;var w=k(8803),m=k(9616),b=k(5680),S=k(7001),u=k(6114),f=k(1752),p=k(4774),a=1024,s=1024,o={css:"rgba(0, 0, 0, 0)",rgba:0};function c(T){return T.code<<21|T.bg<<12|T.fg<<3|(T.bold?0:4)+(T.dim?0:2)+(T.italic?0:1)}h.getGlyphCacheKey=c;var d=function(T){function H(P,M){var L=T.call(this)||this;L._config=M,L._drawToCacheCount=0,L._glyphsWaitingOnBitmap=[],L._bitmapCommitTimeout=null,L._bitmap=null,L._cacheCanvas=P.createElement("canvas"),L._cacheCanvas.width=a,L._cacheCanvas.height=s,L._cacheCtx=(0,f.throwIfFalsy)(L._cacheCanvas.getContext("2d",{alpha:!0}));var D=P.createElement("canvas");D.width=L._config.scaledCharWidth,D.height=L._config.scaledCharHeight,L._tmpCtx=(0,f.throwIfFalsy)(D.getContext("2d",{alpha:L._config.allowTransparency})),L._width=Math.floor(a/L._config.scaledCharWidth),L._height=Math.floor(s/L._config.scaledCharHeight);var E=L._width*L._height;return L._cacheMap=new S.LRUMap(E),L._cacheMap.prealloc(E),L}return y(H,T),H.prototype.dispose=function(){this._bitmapCommitTimeout!==null&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},H.prototype.beginFrame=function(){this._drawToCacheCount=0},H.prototype.clear=function(){if(this._cacheMap.size>0){var P=this._width*this._height;this._cacheMap=new S.LRUMap(P),this._cacheMap.prealloc(P)}this._cacheCtx.clearRect(0,0,a,s),this._tmpCtx.clearRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight)},H.prototype.draw=function(P,M,L,D){if(M.code===32)return!0;if(!this._canCache(M))return!1;var E=c(M),Y=this._cacheMap.get(E);if(Y!=null)return this._drawFromCache(P,Y,L,D),!0;if(this._drawToCacheCount<100){var j;j=this._cacheMap.size<this._cacheMap.capacity?this._cacheMap.size:this._cacheMap.peek().index;var I=this._drawToCache(M,j);return this._cacheMap.set(E,I),this._drawFromCache(P,I,L,D),!0}return!1},H.prototype._canCache=function(P){return P.code<256},H.prototype._toCoordinateX=function(P){return P%this._width*this._config.scaledCharWidth},H.prototype._toCoordinateY=function(P){return Math.floor(P/this._width)*this._config.scaledCharHeight},H.prototype._drawFromCache=function(P,M,L,D){if(!M.isEmpty){var E=this._toCoordinateX(M.index),Y=this._toCoordinateY(M.index);P.drawImage(M.inBitmap?this._bitmap:this._cacheCanvas,E,Y,this._config.scaledCharWidth,this._config.scaledCharHeight,L,D,this._config.scaledCharWidth,this._config.scaledCharHeight)}},H.prototype._getColorFromAnsiIndex=function(P){return P<this._config.colors.ansi.length?this._config.colors.ansi[P]:b.DEFAULT_ANSI_COLORS[P]},H.prototype._getBackgroundColor=function(P){return this._config.allowTransparency?o:P.bg===w.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:P.bg<256?this._getColorFromAnsiIndex(P.bg):this._config.colors.background},H.prototype._getForegroundColor=function(P){return P.fg===w.INVERTED_DEFAULT_COLOR?p.color.opaque(this._config.colors.background):P.fg<256?this._getColorFromAnsiIndex(P.fg):this._config.colors.foreground},H.prototype._drawToCache=function(P,M){this._drawToCacheCount++,this._tmpCtx.save();var L=this._getBackgroundColor(P);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=L.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var D=P.bold?this._config.fontWeightBold:this._config.fontWeight,E=P.italic?"italic":"";this._tmpCtx.font=E+" "+D+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline=w.TEXT_BASELINE,this._tmpCtx.fillStyle=this._getForegroundColor(P).css,P.dim&&(this._tmpCtx.globalAlpha=w.DIM_OPACITY),this._tmpCtx.fillText(P.chars,0,this._config.scaledCharHeight);var Y=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),j=!1;if(this._config.allowTransparency||(j=x(Y,L)),j&&P.chars==="_"&&!this._config.allowTransparency)for(var I=1;I<=5&&(this._tmpCtx.fillText(P.chars,0,this._config.scaledCharHeight-I),j=x(Y=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),L));I++);this._tmpCtx.restore();var F=this._toCoordinateX(M),K=this._toCoordinateY(M);this._cacheCtx.putImageData(Y,F,K);var Z={index:M,isEmpty:j,inBitmap:!1};return this._addGlyphToBitmap(Z),Z},H.prototype._addGlyphToBitmap=function(P){var M=this;!("createImageBitmap"in window)||u.isFirefox||u.isSafari||(this._glyphsWaitingOnBitmap.push(P),this._bitmapCommitTimeout===null&&(this._bitmapCommitTimeout=window.setTimeout(function(){return M._generateBitmap()},100)))},H.prototype._generateBitmap=function(){var P=this,M=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then(function(L){P._bitmap=L;for(var D=0;D<M.length;D++)M[D].inBitmap=!0}),this._bitmapCommitTimeout=null},H}(m.BaseCharAtlas);h.DynamicCharAtlas=d;var g=function(T){function H(P,M){return T.call(this)||this}return y(H,T),H.prototype.draw=function(P,M,L,D){return!1},H}(m.BaseCharAtlas);function x(T,H){for(var P=!0,M=H.rgba>>>24,L=H.rgba>>>16&255,D=H.rgba>>>8&255,E=0;E<T.data.length;E+=4)T.data[E]===M&&T.data[E+1]===L&&T.data[E+2]===D?T.data[E+3]=0:P=!1;return P}h.NoneCharAtlas=g},7001:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.LRUMap=void 0;var k=function(){function v(y){this.capacity=y,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return v.prototype._unlinkNode=function(y){var w=y.prev,m=y.next;y===this._head&&(this._head=m),y===this._tail&&(this._tail=w),w!==null&&(w.next=m),m!==null&&(m.prev=w)},v.prototype._appendNode=function(y){var w=this._tail;w!==null&&(w.next=y),y.prev=w,y.next=null,this._tail=y,this._head===null&&(this._head=y)},v.prototype.prealloc=function(y){for(var w=this._nodePool,m=0;m<y;m++)w.push({prev:null,next:null,key:null,value:null})},v.prototype.get=function(y){var w=this._map[y];return w!==void 0?(this._unlinkNode(w),this._appendNode(w),w.value):null},v.prototype.peekValue=function(y){var w=this._map[y];return w!==void 0?w.value:null},v.prototype.peek=function(){var y=this._head;return y===null?null:y.value},v.prototype.set=function(y,w){var m=this._map[y];if(m!==void 0)m=this._map[y],this._unlinkNode(m),m.value=w;else if(this.size>=this.capacity)m=this._head,this._unlinkNode(m),delete this._map[m.key],m.key=y,m.value=w,this._map[y]=m;else{var b=this._nodePool;b.length>0?((m=b.pop()).key=y,m.value=w):m={prev:null,next:null,key:y,value:w},this._map[y]=m,this.size++}this._appendNode(m)},v}();h.LRUMap=k},1296:function($,h,k){var v,y=this&&this.__extends||(v=function(P,M){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,D){L.__proto__=D}||function(L,D){for(var E in D)Object.prototype.hasOwnProperty.call(D,E)&&(L[E]=D[E])},v(P,M)},function(P,M){if(typeof M!="function"&&M!==null)throw new TypeError("Class extends value "+String(M)+" is not a constructor or null");function L(){this.constructor=P}v(P,M),P.prototype=M===null?Object.create(M):(L.prototype=M.prototype,new L)}),w=this&&this.__decorate||function(P,M,L,D){var E,Y=arguments.length,j=Y<3?M:D===null?D=Object.getOwnPropertyDescriptor(M,L):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(P,M,L,D);else for(var I=P.length-1;I>=0;I--)(E=P[I])&&(j=(Y<3?E(j):Y>3?E(M,L,j):E(M,L))||j);return Y>3&&j&&Object.defineProperty(M,L,j),j},m=this&&this.__param||function(P,M){return function(L,D){M(L,D,P)}};Object.defineProperty(h,"__esModule",{value:!0}),h.DomRenderer=void 0;var b=k(3787),S=k(8803),u=k(844),f=k(4725),p=k(2585),a=k(8460),s=k(4774),o=k(9631),c="xterm-dom-renderer-owner-",d="xterm-fg-",g="xterm-bg-",x="xterm-focus",T=1,H=function(P){function M(L,D,E,Y,j,I,F,K,Z,ue){var ae=P.call(this)||this;return ae._colors=L,ae._element=D,ae._screenElement=E,ae._viewportElement=Y,ae._linkifier=j,ae._linkifier2=I,ae._charSizeService=K,ae._optionsService=Z,ae._bufferService=ue,ae._terminalClass=T++,ae._rowElements=[],ae._rowContainer=document.createElement("div"),ae._rowContainer.classList.add("xterm-rows"),ae._rowContainer.style.lineHeight="normal",ae._rowContainer.setAttribute("aria-hidden","true"),ae._refreshRowElements(ae._bufferService.cols,ae._bufferService.rows),ae._selectionContainer=document.createElement("div"),ae._selectionContainer.classList.add("xterm-selection"),ae._selectionContainer.setAttribute("aria-hidden","true"),ae.dimensions={scaledCharWidth:0,scaledCharHeight:0,scaledCellWidth:0,scaledCellHeight:0,scaledCharLeft:0,scaledCharTop:0,scaledCanvasWidth:0,scaledCanvasHeight:0,canvasWidth:0,canvasHeight:0,actualCellWidth:0,actualCellHeight:0},ae._updateDimensions(),ae._injectCss(),ae._rowFactory=F.createInstance(b.DomRendererRowFactory,document,ae._colors),ae._element.classList.add(c+ae._terminalClass),ae._screenElement.appendChild(ae._rowContainer),ae._screenElement.appendChild(ae._selectionContainer),ae._linkifier.onShowLinkUnderline(function(Ce){return ae._onLinkHover(Ce)}),ae._linkifier.onHideLinkUnderline(function(Ce){return ae._onLinkLeave(Ce)}),ae._linkifier2.onShowLinkUnderline(function(Ce){return ae._onLinkHover(Ce)}),ae._linkifier2.onHideLinkUnderline(function(Ce){return ae._onLinkLeave(Ce)}),ae}return y(M,P),Object.defineProperty(M.prototype,"onRequestRedraw",{get:function(){return new a.EventEmitter().event},enumerable:!1,configurable:!0}),M.prototype.dispose=function(){this._element.classList.remove(c+this._terminalClass),(0,o.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement),P.prototype.dispose.call(this)},M.prototype._updateDimensions=function(){this.dimensions.scaledCharWidth=this._charSizeService.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._charSizeService.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._optionsService.options.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._optionsService.options.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._bufferService.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._bufferService.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._bufferService.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._bufferService.rows;for(var L=0,D=this._rowElements;L<D.length;L++){var E=D[L];E.style.width=this.dimensions.canvasWidth+"px",E.style.height=this.dimensions.actualCellHeight+"px",E.style.lineHeight=this.dimensions.actualCellHeight+"px",E.style.overflow="hidden"}this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));var Y=this._terminalSelector+" .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: "+this.dimensions.actualCellWidth+"px}";this._dimensionsStyleElement.textContent=Y,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=this.dimensions.canvasWidth+"px",this._screenElement.style.height=this.dimensions.canvasHeight+"px"},M.prototype.setColors=function(L){this._colors=L,this._injectCss()},M.prototype._injectCss=function(){var L=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));var D=this._terminalSelector+" .xterm-rows { color: "+this._colors.foreground.css+"; font-family: "+this._optionsService.options.fontFamily+"; font-size: "+this._optionsService.options.fontSize+"px;}";D+=this._terminalSelector+" span:not(."+b.BOLD_CLASS+") { font-weight: "+this._optionsService.options.fontWeight+";}"+this._terminalSelector+" span."+b.BOLD_CLASS+" { font-weight: "+this._optionsService.options.fontWeightBold+";}"+this._terminalSelector+" span."+b.ITALIC_CLASS+" { font-style: italic;}",D+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",D+="@keyframes blink_block_"+this._terminalClass+" { 0% {  background-color: "+this._colors.cursor.css+";  color: "+this._colors.cursorAccent.css+"; } 50% {  background-color: "+this._colors.cursorAccent.css+";  color: "+this._colors.cursor.css+"; }}",D+=this._terminalSelector+" .xterm-rows:not(.xterm-focus) ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_BLOCK_CLASS+" { outline: 1px solid "+this._colors.cursor.css+"; outline-offset: -1px;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+b.CURSOR_CLASS+"."+b.CURSOR_BLINK_CLASS+":not(."+b.CURSOR_STYLE_BLOCK_CLASS+") { animation: blink_box_shadow_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+b.CURSOR_CLASS+"."+b.CURSOR_BLINK_CLASS+"."+b.CURSOR_STYLE_BLOCK_CLASS+" { animation: blink_block_"+this._terminalClass+" 1s step-end infinite;}"+this._terminalSelector+" .xterm-rows.xterm-focus ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_BLOCK_CLASS+" { background-color: "+this._colors.cursor.css+"; color: "+this._colors.cursorAccent.css+";}"+this._terminalSelector+" .xterm-rows ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_BAR_CLASS+" { box-shadow: "+this._optionsService.options.cursorWidth+"px 0 0 "+this._colors.cursor.css+" inset;}"+this._terminalSelector+" .xterm-rows ."+b.CURSOR_CLASS+"."+b.CURSOR_STYLE_UNDERLINE_CLASS+" { box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;}",D+=this._terminalSelector+" .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+this._terminalSelector+" .xterm-selection div { position: absolute; background-color: "+this._colors.selectionTransparent.css+";}",this._colors.ansi.forEach(function(E,Y){D+=L._terminalSelector+" ."+d+Y+" { color: "+E.css+"; }"+L._terminalSelector+" ."+g+Y+" { background-color: "+E.css+"; }"}),D+=this._terminalSelector+" ."+d+S.INVERTED_DEFAULT_COLOR+" { color: "+s.color.opaque(this._colors.background).css+"; }"+this._terminalSelector+" ."+g+S.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }",this._themeStyleElement.textContent=D},M.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},M.prototype._refreshRowElements=function(L,D){for(var E=this._rowElements.length;E<=D;E++){var Y=document.createElement("div");this._rowContainer.appendChild(Y),this._rowElements.push(Y)}for(;this._rowElements.length>D;)this._rowContainer.removeChild(this._rowElements.pop())},M.prototype.onResize=function(L,D){this._refreshRowElements(L,D),this._updateDimensions()},M.prototype.onCharSizeChanged=function(){this._updateDimensions()},M.prototype.onBlur=function(){this._rowContainer.classList.remove(x)},M.prototype.onFocus=function(){this._rowContainer.classList.add(x)},M.prototype.onSelectionChanged=function(L,D,E){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(L&&D){var Y=L[1]-this._bufferService.buffer.ydisp,j=D[1]-this._bufferService.buffer.ydisp,I=Math.max(Y,0),F=Math.min(j,this._bufferService.rows-1);if(!(I>=this._bufferService.rows||F<0)){var K=document.createDocumentFragment();if(E)K.appendChild(this._createSelectionElement(I,L[0],D[0],F-I+1));else{var Z=Y===I?L[0]:0,ue=I===j?D[0]:this._bufferService.cols;K.appendChild(this._createSelectionElement(I,Z,ue));var ae=F-I-1;if(K.appendChild(this._createSelectionElement(I+1,0,this._bufferService.cols,ae)),I!==F){var Ce=j===F?D[0]:this._bufferService.cols;K.appendChild(this._createSelectionElement(F,0,Ce))}}this._selectionContainer.appendChild(K)}}},M.prototype._createSelectionElement=function(L,D,E,Y){Y===void 0&&(Y=1);var j=document.createElement("div");return j.style.height=Y*this.dimensions.actualCellHeight+"px",j.style.top=L*this.dimensions.actualCellHeight+"px",j.style.left=D*this.dimensions.actualCellWidth+"px",j.style.width=this.dimensions.actualCellWidth*(E-D)+"px",j},M.prototype.onCursorMove=function(){},M.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss()},M.prototype.clear=function(){for(var L=0,D=this._rowElements;L<D.length;L++)D[L].innerText=""},M.prototype.renderRows=function(L,D){for(var E=this._bufferService.buffer.ybase+this._bufferService.buffer.y,Y=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),j=this._optionsService.options.cursorBlink,I=L;I<=D;I++){var F=this._rowElements[I];F.innerText="";var K=I+this._bufferService.buffer.ydisp,Z=this._bufferService.buffer.lines.get(K),ue=this._optionsService.options.cursorStyle;F.appendChild(this._rowFactory.createRow(Z,K,K===E,ue,Y,j,this.dimensions.actualCellWidth,this._bufferService.cols))}},Object.defineProperty(M.prototype,"_terminalSelector",{get:function(){return"."+c+this._terminalClass},enumerable:!1,configurable:!0}),M.prototype._onLinkHover=function(L){this._setCellUnderline(L.x1,L.x2,L.y1,L.y2,L.cols,!0)},M.prototype._onLinkLeave=function(L){this._setCellUnderline(L.x1,L.x2,L.y1,L.y2,L.cols,!1)},M.prototype._setCellUnderline=function(L,D,E,Y,j,I){for(;L!==D||E!==Y;){var F=this._rowElements[E];if(!F)return;var K=F.children[L];K&&(K.style.textDecoration=I?"underline":"none"),++L>=j&&(L=0,E++)}},w([m(6,p.IInstantiationService),m(7,f.ICharSizeService),m(8,p.IOptionsService),m(9,p.IBufferService)],M)}(u.Disposable);h.DomRenderer=H},3787:function($,h,k){var v=this&&this.__decorate||function(o,c,d,g){var x,T=arguments.length,H=T<3?c:g===null?g=Object.getOwnPropertyDescriptor(c,d):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(o,c,d,g);else for(var P=o.length-1;P>=0;P--)(x=o[P])&&(H=(T<3?x(H):T>3?x(c,d,H):x(c,d))||H);return T>3&&H&&Object.defineProperty(c,d,H),H},y=this&&this.__param||function(o,c){return function(d,g){c(d,g,o)}};Object.defineProperty(h,"__esModule",{value:!0}),h.DomRendererRowFactory=h.CURSOR_STYLE_UNDERLINE_CLASS=h.CURSOR_STYLE_BAR_CLASS=h.CURSOR_STYLE_BLOCK_CLASS=h.CURSOR_BLINK_CLASS=h.CURSOR_CLASS=h.STRIKETHROUGH_CLASS=h.UNDERLINE_CLASS=h.ITALIC_CLASS=h.DIM_CLASS=h.BOLD_CLASS=void 0;var w=k(8803),m=k(643),b=k(511),S=k(2585),u=k(4774),f=k(4725),p=k(4269);h.BOLD_CLASS="xterm-bold",h.DIM_CLASS="xterm-dim",h.ITALIC_CLASS="xterm-italic",h.UNDERLINE_CLASS="xterm-underline",h.STRIKETHROUGH_CLASS="xterm-strikethrough",h.CURSOR_CLASS="xterm-cursor",h.CURSOR_BLINK_CLASS="xterm-cursor-blink",h.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",h.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",h.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var a=function(){function o(c,d,g,x,T){this._document=c,this._colors=d,this._characterJoinerService=g,this._optionsService=x,this._coreService=T,this._workCell=new b.CellData}return o.prototype.setColors=function(c){this._colors=c},o.prototype.createRow=function(c,d,g,x,T,H,P,M){for(var L=this._document.createDocumentFragment(),D=this._characterJoinerService.getJoinedCharacters(d),E=0,Y=Math.min(c.length,M)-1;Y>=0;Y--)if(c.loadCell(Y,this._workCell).getCode()!==m.NULL_CELL_CODE||g&&Y===T){E=Y+1;break}for(Y=0;Y<E;Y++){c.loadCell(Y,this._workCell);var j=this._workCell.getWidth();if(j!==0){var I=!1,F=Y,K=this._workCell;if(D.length>0&&Y===D[0][0]){I=!0;var Z=D.shift();K=new p.JoinedCellData(this._workCell,c.translateToString(!0,Z[0],Z[1]),Z[1]-Z[0]),F=Z[1]-1,j=K.getWidth()}var ue=this._document.createElement("span");if(j>1&&(ue.style.width=P*j+"px"),I&&(ue.style.display="inline",T>=Y&&T<=F&&(T=Y)),!this._coreService.isCursorHidden&&g&&Y===T)switch(ue.classList.add(h.CURSOR_CLASS),H&&ue.classList.add(h.CURSOR_BLINK_CLASS),x){case"bar":ue.classList.add(h.CURSOR_STYLE_BAR_CLASS);break;case"underline":ue.classList.add(h.CURSOR_STYLE_UNDERLINE_CLASS);break;default:ue.classList.add(h.CURSOR_STYLE_BLOCK_CLASS)}K.isBold()&&ue.classList.add(h.BOLD_CLASS),K.isItalic()&&ue.classList.add(h.ITALIC_CLASS),K.isDim()&&ue.classList.add(h.DIM_CLASS),K.isUnderline()&&ue.classList.add(h.UNDERLINE_CLASS),K.isInvisible()?ue.textContent=m.WHITESPACE_CELL_CHAR:ue.textContent=K.getChars()||m.WHITESPACE_CELL_CHAR,K.isStrikethrough()&&ue.classList.add(h.STRIKETHROUGH_CLASS);var ae=K.getFgColor(),Ce=K.getFgColorMode(),we=K.getBgColor(),fe=K.getBgColorMode(),B=!!K.isInverse();if(B){var N=ae;ae=we,we=N;var U=Ce;Ce=fe,fe=U}switch(Ce){case 16777216:case 33554432:K.isBold()&&ae<8&&this._optionsService.options.drawBoldTextInBrightColors&&(ae+=8),this._applyMinimumContrast(ue,this._colors.background,this._colors.ansi[ae])||ue.classList.add("xterm-fg-"+ae);break;case 50331648:var se=u.rgba.toColor(ae>>16&255,ae>>8&255,255&ae);this._applyMinimumContrast(ue,this._colors.background,se)||this._addStyle(ue,"color:#"+s(ae.toString(16),"0",6));break;default:this._applyMinimumContrast(ue,this._colors.background,this._colors.foreground)||B&&ue.classList.add("xterm-fg-"+w.INVERTED_DEFAULT_COLOR)}switch(fe){case 16777216:case 33554432:ue.classList.add("xterm-bg-"+we);break;case 50331648:this._addStyle(ue,"background-color:#"+s(we.toString(16),"0",6));break;default:B&&ue.classList.add("xterm-bg-"+w.INVERTED_DEFAULT_COLOR)}L.appendChild(ue),Y=F}}return L},o.prototype._applyMinimumContrast=function(c,d,g){if(this._optionsService.options.minimumContrastRatio===1)return!1;var x=this._colors.contrastCache.getColor(this._workCell.bg,this._workCell.fg);return x===void 0&&(x=u.color.ensureContrastRatio(d,g,this._optionsService.options.minimumContrastRatio),this._colors.contrastCache.setColor(this._workCell.bg,this._workCell.fg,x??null)),!!x&&(this._addStyle(c,"color:"+x.css),!0)},o.prototype._addStyle=function(c,d){c.setAttribute("style",""+(c.getAttribute("style")||"")+d+";")},v([y(2,f.ICharacterJoinerService),y(3,S.IOptionsService),y(4,S.ICoreService)],o)}();function s(o,c,d){for(;o.length<d;)o=c+o;return o}h.DomRendererRowFactory=a},456:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.SelectionModel=void 0;var k=function(){function v(y){this._bufferService=y,this.isSelectAllActive=!1,this.selectionStartLength=0}return v.prototype.clearSelection=function(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(v.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){var y=this.selectionStart[0]+this.selectionStartLength;return y>this._bufferService.cols?y%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)-1]:[y%this._bufferService.cols,this.selectionStart[1]+Math.floor(y/this._bufferService.cols)]:[y,this.selectionStart[1]]}return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd}},enumerable:!1,configurable:!0}),v.prototype.areSelectionValuesReversed=function(){var y=this.selectionStart,w=this.selectionEnd;return!(!y||!w)&&(y[1]>w[1]||y[1]===w[1]&&y[0]>w[0])},v.prototype.onTrim=function(y){return this.selectionStart&&(this.selectionStart[1]-=y),this.selectionEnd&&(this.selectionEnd[1]-=y),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},v}();h.SelectionModel=k},428:function($,h,k){var v=this&&this.__decorate||function(u,f,p,a){var s,o=arguments.length,c=o<3?f:a===null?a=Object.getOwnPropertyDescriptor(f,p):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(u,f,p,a);else for(var d=u.length-1;d>=0;d--)(s=u[d])&&(c=(o<3?s(c):o>3?s(f,p,c):s(f,p))||c);return o>3&&c&&Object.defineProperty(f,p,c),c},y=this&&this.__param||function(u,f){return function(p,a){f(p,a,u)}};Object.defineProperty(h,"__esModule",{value:!0}),h.CharSizeService=void 0;var w=k(2585),m=k(8460),b=function(){function u(f,p,a){this._optionsService=a,this.width=0,this.height=0,this._onCharSizeChange=new m.EventEmitter,this._measureStrategy=new S(f,p,this._optionsService)}return Object.defineProperty(u.prototype,"hasValidSize",{get:function(){return this.width>0&&this.height>0},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onCharSizeChange",{get:function(){return this._onCharSizeChange.event},enumerable:!1,configurable:!0}),u.prototype.measure=function(){var f=this._measureStrategy.measure();f.width===this.width&&f.height===this.height||(this.width=f.width,this.height=f.height,this._onCharSizeChange.fire())},v([y(2,w.IOptionsService)],u)}();h.CharSizeService=b;var S=function(){function u(f,p,a){this._document=f,this._parentElement=p,this._optionsService=a,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return u.prototype.measure=function(){this._measureElement.style.fontFamily=this._optionsService.options.fontFamily,this._measureElement.style.fontSize=this._optionsService.options.fontSize+"px";var f=this._measureElement.getBoundingClientRect();return f.width!==0&&f.height!==0&&(this._result.width=f.width,this._result.height=Math.ceil(f.height)),this._result},u}()},4269:function($,h,k){var v,y=this&&this.__extends||(v=function(s,o){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g])},v(s,o)},function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function c(){this.constructor=s}v(s,o),s.prototype=o===null?Object.create(o):(c.prototype=o.prototype,new c)}),w=this&&this.__decorate||function(s,o,c,d){var g,x=arguments.length,T=x<3?o:d===null?d=Object.getOwnPropertyDescriptor(o,c):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(s,o,c,d);else for(var H=s.length-1;H>=0;H--)(g=s[H])&&(T=(x<3?g(T):x>3?g(o,c,T):g(o,c))||T);return x>3&&T&&Object.defineProperty(o,c,T),T},m=this&&this.__param||function(s,o){return function(c,d){o(c,d,s)}};Object.defineProperty(h,"__esModule",{value:!0}),h.CharacterJoinerService=h.JoinedCellData=void 0;var b=k(3734),S=k(643),u=k(511),f=k(2585),p=function(s){function o(c,d,g){var x=s.call(this)||this;return x.content=0,x.combinedData="",x.fg=c.fg,x.bg=c.bg,x.combinedData=d,x._width=g,x}return y(o,s),o.prototype.isCombined=function(){return 2097152},o.prototype.getWidth=function(){return this._width},o.prototype.getChars=function(){return this.combinedData},o.prototype.getCode=function(){return 2097151},o.prototype.setFromCharData=function(c){throw new Error("not implemented")},o.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},o}(b.AttributeData);h.JoinedCellData=p;var a=function(){function s(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new u.CellData}return s.prototype.register=function(o){var c={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(c),c.id},s.prototype.deregister=function(o){for(var c=0;c<this._characterJoiners.length;c++)if(this._characterJoiners[c].id===o)return this._characterJoiners.splice(c,1),!0;return!1},s.prototype.getJoinedCharacters=function(o){if(this._characterJoiners.length===0)return[];var c=this._bufferService.buffer.lines.get(o);if(!c||c.length===0)return[];for(var d=[],g=c.translateToString(!0),x=0,T=0,H=0,P=c.getFg(0),M=c.getBg(0),L=0;L<c.getTrimmedLength();L++)if(c.loadCell(L,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==P||this._workCell.bg!==M){if(L-x>1)for(var D=this._getJoinedRanges(g,H,T,c,x),E=0;E<D.length;E++)d.push(D[E]);x=L,H=T,P=this._workCell.fg,M=this._workCell.bg}T+=this._workCell.getChars().length||S.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-x>1)for(D=this._getJoinedRanges(g,H,T,c,x),E=0;E<D.length;E++)d.push(D[E]);return d},s.prototype._getJoinedRanges=function(o,c,d,g,x){var T=o.substring(c,d),H=[];try{H=this._characterJoiners[0].handler(T)}catch(D){console.error(D)}for(var P=1;P<this._characterJoiners.length;P++)try{for(var M=this._characterJoiners[P].handler(T),L=0;L<M.length;L++)s._mergeRanges(H,M[L])}catch(D){console.error(D)}return this._stringRangesToCellRanges(H,g,x),H},s.prototype._stringRangesToCellRanges=function(o,c,d){var g=0,x=!1,T=0,H=o[g];if(H){for(var P=d;P<this._bufferService.cols;P++){var M=c.getWidth(P),L=c.getString(P).length||S.WHITESPACE_CELL_CHAR.length;if(M!==0){if(!x&&H[0]<=T&&(H[0]=P,x=!0),H[1]<=T){if(H[1]=P,!(H=o[++g]))break;H[0]<=T?(H[0]=P,x=!0):x=!1}T+=L}}H&&(H[1]=this._bufferService.cols)}},s._mergeRanges=function(o,c){for(var d=!1,g=0;g<o.length;g++){var x=o[g];if(d){if(c[1]<=x[0])return o[g-1][1]=c[1],o;if(c[1]<=x[1])return o[g-1][1]=Math.max(c[1],x[1]),o.splice(g,1),o;o.splice(g,1),g--}else{if(c[1]<=x[0])return o.splice(g,0,c),o;if(c[1]<=x[1])return x[0]=Math.min(c[0],x[0]),o;c[0]<x[1]&&(x[0]=Math.min(c[0],x[0]),d=!0)}}return d?o[o.length-1][1]=c[1]:o.push(c),o},s=w([m(0,f.IBufferService)],s)}();h.CharacterJoinerService=a},5114:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.CoreBrowserService=void 0;var k=function(){function v(y){this._textarea=y}return Object.defineProperty(v.prototype,"isFocused",{get:function(){return(this._textarea.getRootNode?this._textarea.getRootNode():document).activeElement===this._textarea&&document.hasFocus()},enumerable:!1,configurable:!0}),v}();h.CoreBrowserService=k},8934:function($,h,k){var v=this&&this.__decorate||function(S,u,f,p){var a,s=arguments.length,o=s<3?u:p===null?p=Object.getOwnPropertyDescriptor(u,f):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(S,u,f,p);else for(var c=S.length-1;c>=0;c--)(a=S[c])&&(o=(s<3?a(o):s>3?a(u,f,o):a(u,f))||o);return s>3&&o&&Object.defineProperty(u,f,o),o},y=this&&this.__param||function(S,u){return function(f,p){u(f,p,S)}};Object.defineProperty(h,"__esModule",{value:!0}),h.MouseService=void 0;var w=k(4725),m=k(9806),b=function(){function S(u,f){this._renderService=u,this._charSizeService=f}return S.prototype.getCoords=function(u,f,p,a,s){return(0,m.getCoords)(u,f,p,a,this._charSizeService.hasValidSize,this._renderService.dimensions.actualCellWidth,this._renderService.dimensions.actualCellHeight,s)},S.prototype.getRawByteCoords=function(u,f,p,a){var s=this.getCoords(u,f,p,a);return(0,m.getRawByteCoords)(s)},v([y(0,w.IRenderService),y(1,w.ICharSizeService)],S)}();h.MouseService=b},3230:function($,h,k){var v,y=this&&this.__extends||(v=function(c,d){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,x){g.__proto__=x}||function(g,x){for(var T in x)Object.prototype.hasOwnProperty.call(x,T)&&(g[T]=x[T])},v(c,d)},function(c,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function g(){this.constructor=c}v(c,d),c.prototype=d===null?Object.create(d):(g.prototype=d.prototype,new g)}),w=this&&this.__decorate||function(c,d,g,x){var T,H=arguments.length,P=H<3?d:x===null?x=Object.getOwnPropertyDescriptor(d,g):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(c,d,g,x);else for(var M=c.length-1;M>=0;M--)(T=c[M])&&(P=(H<3?T(P):H>3?T(d,g,P):T(d,g))||P);return H>3&&P&&Object.defineProperty(d,g,P),P},m=this&&this.__param||function(c,d){return function(g,x){d(g,x,c)}};Object.defineProperty(h,"__esModule",{value:!0}),h.RenderService=void 0;var b=k(6193),S=k(8460),u=k(844),f=k(5596),p=k(3656),a=k(2585),s=k(4725),o=function(c){function d(g,x,T,H,P,M){var L=c.call(this)||this;if(L._renderer=g,L._rowCount=x,L._charSizeService=P,L._isPaused=!1,L._needsFullRefresh=!1,L._isNextRenderRedrawOnly=!0,L._needsSelectionRefresh=!1,L._canvasWidth=0,L._canvasHeight=0,L._selectionState={start:void 0,end:void 0,columnSelectMode:!1},L._onDimensionsChange=new S.EventEmitter,L._onRender=new S.EventEmitter,L._onRefreshRequest=new S.EventEmitter,L.register({dispose:function(){return L._renderer.dispose()}}),L._renderDebouncer=new b.RenderDebouncer(function(E,Y){return L._renderRows(E,Y)}),L.register(L._renderDebouncer),L._screenDprMonitor=new f.ScreenDprMonitor,L._screenDprMonitor.setListener(function(){return L.onDevicePixelRatioChange()}),L.register(L._screenDprMonitor),L.register(M.onResize(function(E){return L._fullRefresh()})),L.register(H.onOptionChange(function(){return L._renderer.onOptionsChanged()})),L.register(L._charSizeService.onCharSizeChange(function(){return L.onCharSizeChanged()})),L._renderer.onRequestRedraw(function(E){return L.refreshRows(E.start,E.end,!0)}),L.register((0,p.addDisposableDomListener)(window,"resize",function(){return L.onDevicePixelRatioChange()})),"IntersectionObserver"in window){var D=new IntersectionObserver(function(E){return L._onIntersectionChange(E[E.length-1])},{threshold:0});D.observe(T),L.register({dispose:function(){return D.disconnect()}})}return L}return y(d,c),Object.defineProperty(d.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onRenderedBufferChange",{get:function(){return this._onRender.event},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!1,configurable:!0}),d.prototype._onIntersectionChange=function(g){this._isPaused=g.isIntersecting===void 0?g.intersectionRatio===0:!g.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},d.prototype.refreshRows=function(g,x,T){T===void 0&&(T=!1),this._isPaused?this._needsFullRefresh=!0:(T||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(g,x,this._rowCount))},d.prototype._renderRows=function(g,x){this._renderer.renderRows(g,x),this._needsSelectionRefresh&&(this._renderer.onSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRender.fire({start:g,end:x}),this._isNextRenderRedrawOnly=!0},d.prototype.resize=function(g,x){this._rowCount=x,this._fireOnCanvasResize()},d.prototype.changeOptions=function(){this._renderer.onOptionsChanged(),this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize()},d.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},d.prototype.dispose=function(){c.prototype.dispose.call(this)},d.prototype.setRenderer=function(g){var x=this;this._renderer.dispose(),this._renderer=g,this._renderer.onRequestRedraw(function(T){return x.refreshRows(T.start,T.end,!0)}),this._needsSelectionRefresh=!0,this._fullRefresh()},d.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)},d.prototype.clearTextureAtlas=function(){var g,x;(x=(g=this._renderer)===null||g===void 0?void 0:g.clearTextureAtlas)===null||x===void 0||x.call(g),this._fullRefresh()},d.prototype.setColors=function(g){this._renderer.setColors(g),this._fullRefresh()},d.prototype.onDevicePixelRatioChange=function(){this._charSizeService.measure(),this._renderer.onDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1)},d.prototype.onResize=function(g,x){this._renderer.onResize(g,x),this._fullRefresh()},d.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},d.prototype.onBlur=function(){this._renderer.onBlur()},d.prototype.onFocus=function(){this._renderer.onFocus()},d.prototype.onSelectionChanged=function(g,x,T){this._selectionState.start=g,this._selectionState.end=x,this._selectionState.columnSelectMode=T,this._renderer.onSelectionChanged(g,x,T)},d.prototype.onCursorMove=function(){this._renderer.onCursorMove()},d.prototype.clear=function(){this._renderer.clear()},w([m(3,a.IOptionsService),m(4,s.ICharSizeService),m(5,a.IBufferService)],d)}(u.Disposable);h.RenderService=o},9312:function($,h,k){var v,y=this&&this.__extends||(v=function(H,P){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,L){M.__proto__=L}||function(M,L){for(var D in L)Object.prototype.hasOwnProperty.call(L,D)&&(M[D]=L[D])},v(H,P)},function(H,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");function M(){this.constructor=H}v(H,P),H.prototype=P===null?Object.create(P):(M.prototype=P.prototype,new M)}),w=this&&this.__decorate||function(H,P,M,L){var D,E=arguments.length,Y=E<3?P:L===null?L=Object.getOwnPropertyDescriptor(P,M):L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Y=Reflect.decorate(H,P,M,L);else for(var j=H.length-1;j>=0;j--)(D=H[j])&&(Y=(E<3?D(Y):E>3?D(P,M,Y):D(P,M))||Y);return E>3&&Y&&Object.defineProperty(P,M,Y),Y},m=this&&this.__param||function(H,P){return function(M,L){P(M,L,H)}};Object.defineProperty(h,"__esModule",{value:!0}),h.SelectionService=void 0;var b=k(6114),S=k(456),u=k(511),f=k(8460),p=k(4725),a=k(2585),s=k(9806),o=k(9504),c=k(844),d=k(4841),g=String.fromCharCode(160),x=new RegExp(g,"g"),T=function(H){function P(M,L,D,E,Y,j,I,F){var K=H.call(this)||this;return K._element=M,K._screenElement=L,K._linkifier=D,K._bufferService=E,K._coreService=Y,K._mouseService=j,K._optionsService=I,K._renderService=F,K._dragScrollAmount=0,K._enabled=!0,K._workCell=new u.CellData,K._mouseDownTimeStamp=0,K._oldHasSelection=!1,K._oldSelectionStart=void 0,K._oldSelectionEnd=void 0,K._onLinuxMouseSelection=K.register(new f.EventEmitter),K._onRedrawRequest=K.register(new f.EventEmitter),K._onSelectionChange=K.register(new f.EventEmitter),K._onRequestScrollLines=K.register(new f.EventEmitter),K._mouseMoveListener=function(Z){return K._onMouseMove(Z)},K._mouseUpListener=function(Z){return K._onMouseUp(Z)},K._coreService.onUserInput(function(){K.hasSelection&&K.clearSelection()}),K._trimListener=K._bufferService.buffer.lines.onTrim(function(Z){return K._onTrim(Z)}),K.register(K._bufferService.buffers.onBufferActivate(function(Z){return K._onBufferActivate(Z)})),K.enable(),K._model=new S.SelectionModel(K._bufferService),K._activeSelectionMode=0,K}return y(P,H),Object.defineProperty(P.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onRequestRedraw",{get:function(){return this._onRedrawRequest.event},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onRequestScrollLines",{get:function(){return this._onRequestScrollLines.event},enumerable:!1,configurable:!0}),P.prototype.dispose=function(){this._removeMouseDownListeners()},P.prototype.reset=function(){this.clearSelection()},P.prototype.disable=function(){this.clearSelection(),this._enabled=!1},P.prototype.enable=function(){this._enabled=!0},Object.defineProperty(P.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"hasSelection",{get:function(){var M=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;return!(!M||!L||M[0]===L[0]&&M[1]===L[1])},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"selectionText",{get:function(){var M=this._model.finalSelectionStart,L=this._model.finalSelectionEnd;if(!M||!L)return"";var D=this._bufferService.buffer,E=[];if(this._activeSelectionMode===3){if(M[0]===L[0])return"";for(var Y=M[1];Y<=L[1];Y++){var j=D.translateBufferLineToString(Y,!0,M[0],L[0]);E.push(j)}}else{var I=M[1]===L[1]?L[0]:void 0;for(E.push(D.translateBufferLineToString(M[1],!0,M[0],I)),Y=M[1]+1;Y<=L[1]-1;Y++){var F=D.lines.get(Y);j=D.translateBufferLineToString(Y,!0),(F==null?void 0:F.isWrapped)?E[E.length-1]+=j:E.push(j)}M[1]!==L[1]&&(F=D.lines.get(L[1]),j=D.translateBufferLineToString(L[1],!0,0,L[0]),F&&F.isWrapped?E[E.length-1]+=j:E.push(j))}return E.map(function(K){return K.replace(x," ")}).join(b.isWindows?`\r
`:`
`)},enumerable:!1,configurable:!0}),P.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},P.prototype.refresh=function(M){var L=this;this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(function(){return L._refresh()})),b.isLinux&&M&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)},P.prototype._refresh=function(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})},P.prototype._isClickInSelection=function(M){var L=this._getMouseBufferCoords(M),D=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!!(D&&E&&L)&&this._areCoordsInSelection(L,D,E)},P.prototype._areCoordsInSelection=function(M,L,D){return M[1]>L[1]&&M[1]<D[1]||L[1]===D[1]&&M[1]===L[1]&&M[0]>=L[0]&&M[0]<D[0]||L[1]<D[1]&&M[1]===D[1]&&M[0]<D[0]||L[1]<D[1]&&M[1]===L[1]&&M[0]>=L[0]},P.prototype._selectWordAtCursor=function(M,L){var D,E,Y=(E=(D=this._linkifier.currentLink)===null||D===void 0?void 0:D.link)===null||E===void 0?void 0:E.range;if(Y)return this._model.selectionStart=[Y.start.x-1,Y.start.y-1],this._model.selectionStartLength=(0,d.getRangeLength)(Y,this._bufferService.cols),this._model.selectionEnd=void 0,!0;var j=this._getMouseBufferCoords(M);return!!j&&(this._selectWordAt(j,L),this._model.selectionEnd=void 0,!0)},P.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},P.prototype.selectLines=function(M,L){this._model.clearSelection(),M=Math.max(M,0),L=Math.min(L,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,M],this._model.selectionEnd=[this._bufferService.cols,L],this.refresh(),this._onSelectionChange.fire()},P.prototype._onTrim=function(M){this._model.onTrim(M)&&this.refresh()},P.prototype._getMouseBufferCoords=function(M){var L=this._mouseService.getCoords(M,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(L)return L[0]--,L[1]--,L[1]+=this._bufferService.buffer.ydisp,L},P.prototype._getMouseEventScrollAmount=function(M){var L=(0,s.getCoordsRelativeToElement)(M,this._screenElement)[1],D=this._renderService.dimensions.canvasHeight;return L>=0&&L<=D?0:(L>D&&(L-=D),L=Math.min(Math.max(L,-50),50),(L/=50)/Math.abs(L)+Math.round(14*L))},P.prototype.shouldForceSelection=function(M){return b.isMac?M.altKey&&this._optionsService.options.macOptionClickForcesSelection:M.shiftKey},P.prototype.onMouseDown=function(M){if(this._mouseDownTimeStamp=M.timeStamp,(M.button!==2||!this.hasSelection)&&M.button===0){if(!this._enabled){if(!this.shouldForceSelection(M))return;M.stopPropagation()}M.preventDefault(),this._dragScrollAmount=0,this._enabled&&M.shiftKey?this._onIncrementalClick(M):M.detail===1?this._onSingleClick(M):M.detail===2?this._onDoubleClick(M):M.detail===3&&this._onTripleClick(M),this._addMouseDownListeners(),this.refresh(!0)}},P.prototype._addMouseDownListeners=function(){var M=this;this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=window.setInterval(function(){return M._dragScroll()},50)},P.prototype._removeMouseDownListeners=function(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0},P.prototype._onIncrementalClick=function(M){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(M))},P.prototype._onSingleClick=function(M){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(M)?3:0,this._model.selectionStart=this._getMouseBufferCoords(M),this._model.selectionStart){this._model.selectionEnd=void 0;var L=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);L&&L.length!==this._model.selectionStart[0]&&L.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}},P.prototype._onDoubleClick=function(M){this._selectWordAtCursor(M,!0)&&(this._activeSelectionMode=1)},P.prototype._onTripleClick=function(M){var L=this._getMouseBufferCoords(M);L&&(this._activeSelectionMode=2,this._selectLineAt(L[1]))},P.prototype.shouldColumnSelect=function(M){return M.altKey&&!(b.isMac&&this._optionsService.options.macOptionClickForcesSelection)},P.prototype._onMouseMove=function(M){if(M.stopImmediatePropagation(),this._model.selectionStart){var L=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(M),this._model.selectionEnd){this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(M),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));var D=this._bufferService.buffer;if(this._model.selectionEnd[1]<D.lines.length){var E=D.lines.get(this._model.selectionEnd[1]);E&&E.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}L&&L[0]===this._model.selectionEnd[0]&&L[1]===this._model.selectionEnd[1]||this.refresh(!0)}else this.refresh(!0)}},P.prototype._dragScroll=function(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});var M=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(M.ydisp+this._bufferService.rows,M.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=M.ydisp),this.refresh()}},P.prototype._onMouseUp=function(M){var L=M.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&L<500&&M.altKey&&this._optionsService.getOption("altClickMovesCursor")){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){var D=this._mouseService.getCoords(M,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(D&&D[0]!==void 0&&D[1]!==void 0){var E=(0,o.moveToCellSequence)(D[0]-1,D[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(E,!0)}}}else this._fireEventIfSelectionChanged()},P.prototype._fireEventIfSelectionChanged=function(){var M=this._model.finalSelectionStart,L=this._model.finalSelectionEnd,D=!(!M||!L||M[0]===L[0]&&M[1]===L[1]);D?M&&L&&(this._oldSelectionStart&&this._oldSelectionEnd&&M[0]===this._oldSelectionStart[0]&&M[1]===this._oldSelectionStart[1]&&L[0]===this._oldSelectionEnd[0]&&L[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(M,L,D)):this._oldHasSelection&&this._fireOnSelectionChange(M,L,D)},P.prototype._fireOnSelectionChange=function(M,L,D){this._oldSelectionStart=M,this._oldSelectionEnd=L,this._oldHasSelection=D,this._onSelectionChange.fire()},P.prototype._onBufferActivate=function(M){var L=this;this.clearSelection(),this._trimListener.dispose(),this._trimListener=M.activeBuffer.lines.onTrim(function(D){return L._onTrim(D)})},P.prototype._convertViewportColToCharacterIndex=function(M,L){for(var D=L[0],E=0;L[0]>=E;E++){var Y=M.loadCell(E,this._workCell).getChars().length;this._workCell.getWidth()===0?D--:Y>1&&L[0]!==E&&(D+=Y-1)}return D},P.prototype.setSelection=function(M,L,D){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[M,L],this._model.selectionStartLength=D,this.refresh()},P.prototype.rightClickSelect=function(M){this._isClickInSelection(M)||(this._selectWordAtCursor(M,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())},P.prototype._getWordAt=function(M,L,D,E){if(D===void 0&&(D=!0),E===void 0&&(E=!0),!(M[0]>=this._bufferService.cols)){var Y=this._bufferService.buffer,j=Y.lines.get(M[1]);if(j){var I=Y.translateBufferLineToString(M[1],!1),F=this._convertViewportColToCharacterIndex(j,M),K=F,Z=M[0]-F,ue=0,ae=0,Ce=0,we=0;if(I.charAt(F)===" "){for(;F>0&&I.charAt(F-1)===" ";)F--;for(;K<I.length&&I.charAt(K+1)===" ";)K++}else{var fe=M[0],B=M[0];j.getWidth(fe)===0&&(ue++,fe--),j.getWidth(B)===2&&(ae++,B++);var N=j.getString(B).length;for(N>1&&(we+=N-1,K+=N-1);fe>0&&F>0&&!this._isCharWordSeparator(j.loadCell(fe-1,this._workCell));){j.loadCell(fe-1,this._workCell);var U=this._workCell.getChars().length;this._workCell.getWidth()===0?(ue++,fe--):U>1&&(Ce+=U-1,F-=U-1),F--,fe--}for(;B<j.length&&K+1<I.length&&!this._isCharWordSeparator(j.loadCell(B+1,this._workCell));){j.loadCell(B+1,this._workCell);var se=this._workCell.getChars().length;this._workCell.getWidth()===2?(ae++,B++):se>1&&(we+=se-1,K+=se-1),K++,B++}}K++;var G=F+Z-ue+Ce,_e=Math.min(this._bufferService.cols,K-F+ue+ae-Ce-we);if(L||I.slice(F,K).trim()!==""){if(D&&G===0&&j.getCodePoint(0)!==32){var Le=Y.lines.get(M[1]-1);if(Le&&j.isWrapped&&Le.getCodePoint(this._bufferService.cols-1)!==32){var Be=this._getWordAt([this._bufferService.cols-1,M[1]-1],!1,!0,!1);if(Be){var Ee=this._bufferService.cols-Be.start;G-=Ee,_e+=Ee}}}if(E&&G+_e===this._bufferService.cols&&j.getCodePoint(this._bufferService.cols-1)!==32){var Ie=Y.lines.get(M[1]+1);if((Ie==null?void 0:Ie.isWrapped)&&Ie.getCodePoint(0)!==32){var be=this._getWordAt([0,M[1]+1],!1,!1,!0);be&&(_e+=be.length)}}return{start:G,length:_e}}}}},P.prototype._selectWordAt=function(M,L){var D=this._getWordAt(M,L);if(D){for(;D.start<0;)D.start+=this._bufferService.cols,M[1]--;this._model.selectionStart=[D.start,M[1]],this._model.selectionStartLength=D.length}},P.prototype._selectToWordAt=function(M){var L=this._getWordAt(M,!0);if(L){for(var D=M[1];L.start<0;)L.start+=this._bufferService.cols,D--;if(!this._model.areSelectionValuesReversed())for(;L.start+L.length>this._bufferService.cols;)L.length-=this._bufferService.cols,D++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?L.start:L.start+L.length,D]}},P.prototype._isCharWordSeparator=function(M){return M.getWidth()!==0&&this._optionsService.options.wordSeparator.indexOf(M.getChars())>=0},P.prototype._selectLineAt=function(M){var L=this._bufferService.buffer.getWrappedRangeForLine(M);this._model.selectionStart=[0,L.first],this._model.selectionEnd=[this._bufferService.cols,L.last],this._model.selectionStartLength=0},w([m(3,a.IBufferService),m(4,a.ICoreService),m(5,p.IMouseService),m(6,a.IOptionsService),m(7,p.IRenderService)],P)}(c.Disposable);h.SelectionService=T},4725:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ICharacterJoinerService=h.ISoundService=h.ISelectionService=h.IRenderService=h.IMouseService=h.ICoreBrowserService=h.ICharSizeService=void 0;var v=k(8343);h.ICharSizeService=(0,v.createDecorator)("CharSizeService"),h.ICoreBrowserService=(0,v.createDecorator)("CoreBrowserService"),h.IMouseService=(0,v.createDecorator)("MouseService"),h.IRenderService=(0,v.createDecorator)("RenderService"),h.ISelectionService=(0,v.createDecorator)("SelectionService"),h.ISoundService=(0,v.createDecorator)("SoundService"),h.ICharacterJoinerService=(0,v.createDecorator)("CharacterJoinerService")},357:function($,h,k){var v=this&&this.__decorate||function(b,S,u,f){var p,a=arguments.length,s=a<3?S:f===null?f=Object.getOwnPropertyDescriptor(S,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(b,S,u,f);else for(var o=b.length-1;o>=0;o--)(p=b[o])&&(s=(a<3?p(s):a>3?p(S,u,s):p(S,u))||s);return a>3&&s&&Object.defineProperty(S,u,s),s},y=this&&this.__param||function(b,S){return function(u,f){S(u,f,b)}};Object.defineProperty(h,"__esModule",{value:!0}),h.SoundService=void 0;var w=k(2585),m=function(){function b(S){this._optionsService=S}return Object.defineProperty(b,"audioContext",{get:function(){if(!b._audioContext){var S=window.AudioContext||window.webkitAudioContext;if(!S)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;b._audioContext=new S}return b._audioContext},enumerable:!1,configurable:!0}),b.prototype.playBellSound=function(){var S=b.audioContext;if(S){var u=S.createBufferSource();S.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._optionsService.options.bellSound)),function(f){u.buffer=f,u.connect(S.destination),u.start(0)})}},b.prototype._base64ToArrayBuffer=function(S){for(var u=window.atob(S),f=u.length,p=new Uint8Array(f),a=0;a<f;a++)p[a]=u.charCodeAt(a);return p.buffer},b.prototype._removeMimeType=function(S){return S.split(",")[1]},b=v([y(0,w.IOptionsService)],b)}();h.SoundService=m},6349:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.CircularList=void 0;var v=k(8460),y=function(){function w(m){this._maxLength=m,this.onDeleteEmitter=new v.EventEmitter,this.onInsertEmitter=new v.EventEmitter,this.onTrimEmitter=new v.EventEmitter,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(w.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"maxLength",{get:function(){return this._maxLength},set:function(m){if(this._maxLength!==m){for(var b=new Array(m),S=0;S<Math.min(m,this.length);S++)b[S]=this._array[this._getCyclicIndex(S)];this._array=b,this._maxLength=m,this._startIndex=0}},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"length",{get:function(){return this._length},set:function(m){if(m>this._length)for(var b=this._length;b<m;b++)this._array[b]=void 0;this._length=m},enumerable:!1,configurable:!0}),w.prototype.get=function(m){return this._array[this._getCyclicIndex(m)]},w.prototype.set=function(m,b){this._array[this._getCyclicIndex(m)]=b},w.prototype.push=function(m){this._array[this._getCyclicIndex(this._length)]=m,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},w.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(w.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!1,configurable:!0}),w.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},w.prototype.splice=function(m,b){for(var S=[],u=2;u<arguments.length;u++)S[u-2]=arguments[u];if(b){for(var f=m;f<this._length-b;f++)this._array[this._getCyclicIndex(f)]=this._array[this._getCyclicIndex(f+b)];this._length-=b,this.onDeleteEmitter.fire({index:m,amount:b})}for(f=this._length-1;f>=m;f--)this._array[this._getCyclicIndex(f+S.length)]=this._array[this._getCyclicIndex(f)];for(f=0;f<S.length;f++)this._array[this._getCyclicIndex(m+f)]=S[f];if(S.length&&this.onInsertEmitter.fire({index:m,amount:S.length}),this._length+S.length>this._maxLength){var p=this._length+S.length-this._maxLength;this._startIndex+=p,this._length=this._maxLength,this.onTrimEmitter.fire(p)}else this._length+=S.length},w.prototype.trimStart=function(m){m>this._length&&(m=this._length),this._startIndex+=m,this._length-=m,this.onTrimEmitter.fire(m)},w.prototype.shiftElements=function(m,b,S){if(!(b<=0)){if(m<0||m>=this._length)throw new Error("start argument out of range");if(m+S<0)throw new Error("Cannot shift elements in list beyond index 0");if(S>0){for(var u=b-1;u>=0;u--)this.set(m+u+S,this.get(m+u));var f=m+b+S-this._length;if(f>0)for(this._length+=f;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(u=0;u<b;u++)this.set(m+u+S,this.get(m+u))}},w.prototype._getCyclicIndex=function(m){return(this._startIndex+m)%this._maxLength},w}();h.CircularList=y},1439:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.clone=void 0,h.clone=function k(v,y){if(y===void 0&&(y=5),typeof v!="object")return v;var w=Array.isArray(v)?[]:{};for(var m in v)w[m]=y<=1?v[m]:v[m]&&k(v[m],y-1);return w}},8969:function($,h,k){var v,y=this&&this.__extends||(v=function(M,L){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,E){D.__proto__=E}||function(D,E){for(var Y in E)Object.prototype.hasOwnProperty.call(E,Y)&&(D[Y]=E[Y])},v(M,L)},function(M,L){if(typeof L!="function"&&L!==null)throw new TypeError("Class extends value "+String(L)+" is not a constructor or null");function D(){this.constructor=M}v(M,L),M.prototype=L===null?Object.create(L):(D.prototype=L.prototype,new D)});Object.defineProperty(h,"__esModule",{value:!0}),h.CoreTerminal=void 0;var w=k(844),m=k(2585),b=k(4348),S=k(7866),u=k(744),f=k(7302),p=k(6975),a=k(8460),s=k(1753),o=k(3730),c=k(1480),d=k(7994),g=k(9282),x=k(5435),T=k(5981),H=!1,P=function(M){function L(D){var E=M.call(this)||this;return E._onBinary=new a.EventEmitter,E._onData=new a.EventEmitter,E._onLineFeed=new a.EventEmitter,E._onResize=new a.EventEmitter,E._onScroll=new a.EventEmitter,E._instantiationService=new b.InstantiationService,E.optionsService=new f.OptionsService(D),E._instantiationService.setService(m.IOptionsService,E.optionsService),E._bufferService=E.register(E._instantiationService.createInstance(u.BufferService)),E._instantiationService.setService(m.IBufferService,E._bufferService),E._logService=E._instantiationService.createInstance(S.LogService),E._instantiationService.setService(m.ILogService,E._logService),E.coreService=E.register(E._instantiationService.createInstance(p.CoreService,function(){return E.scrollToBottom()})),E._instantiationService.setService(m.ICoreService,E.coreService),E.coreMouseService=E._instantiationService.createInstance(s.CoreMouseService),E._instantiationService.setService(m.ICoreMouseService,E.coreMouseService),E._dirtyRowService=E._instantiationService.createInstance(o.DirtyRowService),E._instantiationService.setService(m.IDirtyRowService,E._dirtyRowService),E.unicodeService=E._instantiationService.createInstance(c.UnicodeService),E._instantiationService.setService(m.IUnicodeService,E.unicodeService),E._charsetService=E._instantiationService.createInstance(d.CharsetService),E._instantiationService.setService(m.ICharsetService,E._charsetService),E._inputHandler=new x.InputHandler(E._bufferService,E._charsetService,E.coreService,E._dirtyRowService,E._logService,E.optionsService,E.coreMouseService,E.unicodeService),E.register((0,a.forwardEvent)(E._inputHandler.onLineFeed,E._onLineFeed)),E.register(E._inputHandler),E.register((0,a.forwardEvent)(E._bufferService.onResize,E._onResize)),E.register((0,a.forwardEvent)(E.coreService.onData,E._onData)),E.register((0,a.forwardEvent)(E.coreService.onBinary,E._onBinary)),E.register(E.optionsService.onOptionChange(function(Y){return E._updateOptions(Y)})),E.register(E._bufferService.onScroll(function(Y){E._onScroll.fire({position:E._bufferService.buffer.ydisp,source:0}),E._dirtyRowService.markRangeDirty(E._bufferService.buffer.scrollTop,E._bufferService.buffer.scrollBottom)})),E.register(E._inputHandler.onScroll(function(Y){E._onScroll.fire({position:E._bufferService.buffer.ydisp,source:0}),E._dirtyRowService.markRangeDirty(E._bufferService.buffer.scrollTop,E._bufferService.buffer.scrollBottom)})),E._writeBuffer=new T.WriteBuffer(function(Y,j){return E._inputHandler.parse(Y,j)}),E}return y(L,M),Object.defineProperty(L.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"onScroll",{get:function(){var D=this;return this._onScrollApi||(this._onScrollApi=new a.EventEmitter,this.register(this._onScroll.event(function(E){var Y;(Y=D._onScrollApi)===null||Y===void 0||Y.fire(E.position)}))),this._onScrollApi.event},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"cols",{get:function(){return this._bufferService.cols},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"rows",{get:function(){return this._bufferService.rows},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"buffers",{get:function(){return this._bufferService.buffers},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"options",{get:function(){return this.optionsService.options},set:function(D){for(var E in D)this.optionsService.options[E]=D[E]},enumerable:!1,configurable:!0}),L.prototype.dispose=function(){var D;this._isDisposed||(M.prototype.dispose.call(this),(D=this._windowsMode)===null||D===void 0||D.dispose(),this._windowsMode=void 0)},L.prototype.write=function(D,E){this._writeBuffer.write(D,E)},L.prototype.writeSync=function(D,E){this._logService.logLevel<=m.LogLevelEnum.WARN&&!H&&(this._logService.warn("writeSync is unreliable and will be removed soon."),H=!0),this._writeBuffer.writeSync(D,E)},L.prototype.resize=function(D,E){isNaN(D)||isNaN(E)||(D=Math.max(D,u.MINIMUM_COLS),E=Math.max(E,u.MINIMUM_ROWS),this._bufferService.resize(D,E))},L.prototype.scroll=function(D,E){E===void 0&&(E=!1),this._bufferService.scroll(D,E)},L.prototype.scrollLines=function(D,E,Y){this._bufferService.scrollLines(D,E,Y)},L.prototype.scrollPages=function(D){this._bufferService.scrollPages(D)},L.prototype.scrollToTop=function(){this._bufferService.scrollToTop()},L.prototype.scrollToBottom=function(){this._bufferService.scrollToBottom()},L.prototype.scrollToLine=function(D){this._bufferService.scrollToLine(D)},L.prototype.registerEscHandler=function(D,E){return this._inputHandler.registerEscHandler(D,E)},L.prototype.registerDcsHandler=function(D,E){return this._inputHandler.registerDcsHandler(D,E)},L.prototype.registerCsiHandler=function(D,E){return this._inputHandler.registerCsiHandler(D,E)},L.prototype.registerOscHandler=function(D,E){return this._inputHandler.registerOscHandler(D,E)},L.prototype._setup=function(){this.optionsService.options.windowsMode&&this._enableWindowsMode()},L.prototype.reset=function(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()},L.prototype._updateOptions=function(D){var E;switch(D){case"scrollback":this.buffers.resize(this.cols,this.rows);break;case"windowsMode":this.optionsService.options.windowsMode?this._enableWindowsMode():((E=this._windowsMode)===null||E===void 0||E.dispose(),this._windowsMode=void 0)}},L.prototype._enableWindowsMode=function(){var D=this;if(!this._windowsMode){var E=[];E.push(this.onLineFeed(g.updateWindowsModeWrappedState.bind(null,this._bufferService))),E.push(this.registerCsiHandler({final:"H"},function(){return(0,g.updateWindowsModeWrappedState)(D._bufferService),!1})),this._windowsMode={dispose:function(){for(var Y=0,j=E;Y<j.length;Y++)j[Y].dispose()}}}},L}(w.Disposable);h.CoreTerminal=P},8460:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.forwardEvent=h.EventEmitter=void 0;var k=function(){function v(){this._listeners=[],this._disposed=!1}return Object.defineProperty(v.prototype,"event",{get:function(){var y=this;return this._event||(this._event=function(w){return y._listeners.push(w),{dispose:function(){if(!y._disposed){for(var m=0;m<y._listeners.length;m++)if(y._listeners[m]===w)return void y._listeners.splice(m,1)}}}}),this._event},enumerable:!1,configurable:!0}),v.prototype.fire=function(y,w){for(var m=[],b=0;b<this._listeners.length;b++)m.push(this._listeners[b]);for(b=0;b<m.length;b++)m[b].call(void 0,y,w)},v.prototype.dispose=function(){this._listeners&&(this._listeners.length=0),this._disposed=!0},v}();h.EventEmitter=k,h.forwardEvent=function(v,y){return v(function(w){return y.fire(w)})}},5435:function($,h,k){var v,y=this&&this.__extends||(v=function(Y,j){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var K in F)Object.prototype.hasOwnProperty.call(F,K)&&(I[K]=F[K])},v(Y,j)},function(Y,j){if(typeof j!="function"&&j!==null)throw new TypeError("Class extends value "+String(j)+" is not a constructor or null");function I(){this.constructor=Y}v(Y,j),Y.prototype=j===null?Object.create(j):(I.prototype=j.prototype,new I)});Object.defineProperty(h,"__esModule",{value:!0}),h.InputHandler=h.WindowsOptionsReportType=void 0;var w,m=k(2584),b=k(7116),S=k(2015),u=k(844),f=k(8273),p=k(482),a=k(8437),s=k(8460),o=k(643),c=k(511),d=k(3734),g=k(2585),x=k(6242),T=k(6351),H=k(5941),P={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function L(Y,j){if(Y>24)return j.setWinLines||!1;switch(Y){case 1:return!!j.restoreWin;case 2:return!!j.minimizeWin;case 3:return!!j.setWinPosition;case 4:return!!j.setWinSizePixels;case 5:return!!j.raiseWin;case 6:return!!j.lowerWin;case 7:return!!j.refreshWin;case 8:return!!j.setWinSizeChars;case 9:return!!j.maximizeWin;case 10:return!!j.fullscreenWin;case 11:return!!j.getWinState;case 13:return!!j.getWinPosition;case 14:return!!j.getWinSizePixels;case 15:return!!j.getScreenSizePixels;case 16:return!!j.getCellSizePixels;case 18:return!!j.getWinSizeChars;case 19:return!!j.getScreenSizeChars;case 20:return!!j.getIconTitle;case 21:return!!j.getWinTitle;case 22:return!!j.pushTitle;case 23:return!!j.popTitle;case 24:return!!j.setWinLines}return!1}(function(Y){Y[Y.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",Y[Y.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(w=h.WindowsOptionsReportType||(h.WindowsOptionsReportType={}));var D=function(){function Y(j,I,F,K){this._bufferService=j,this._coreService=I,this._logService=F,this._optionsService=K,this._data=new Uint32Array(0)}return Y.prototype.hook=function(j){this._data=new Uint32Array(0)},Y.prototype.put=function(j,I,F){this._data=(0,f.concat)(this._data,j.subarray(I,F))},Y.prototype.unhook=function(j){if(!j)return this._data=new Uint32Array(0),!0;var I=(0,p.utf32ToString)(this._data);switch(this._data=new Uint32Array(0),I){case'"q':this._coreService.triggerDataEvent(m.C0.ESC+'P1$r0"q'+m.C0.ESC+"\\");break;case'"p':this._coreService.triggerDataEvent(m.C0.ESC+'P1$r61;1"p'+m.C0.ESC+"\\");break;case"r":var F=this._bufferService.buffer.scrollTop+1+";"+(this._bufferService.buffer.scrollBottom+1)+"r";this._coreService.triggerDataEvent(m.C0.ESC+"P1$r"+F+m.C0.ESC+"\\");break;case"m":this._coreService.triggerDataEvent(m.C0.ESC+"P1$r0m"+m.C0.ESC+"\\");break;case" q":var K={block:2,underline:4,bar:6}[this._optionsService.options.cursorStyle];K-=this._optionsService.options.cursorBlink?1:0,this._coreService.triggerDataEvent(m.C0.ESC+"P1$r"+K+" q"+m.C0.ESC+"\\");break;default:this._logService.debug("Unknown DCS $q %s",I),this._coreService.triggerDataEvent(m.C0.ESC+"P0$r"+m.C0.ESC+"\\")}return!0},Y}(),E=function(Y){function j(I,F,K,Z,ue,ae,Ce,we,fe){fe===void 0&&(fe=new S.EscapeSequenceParser);var B=Y.call(this)||this;B._bufferService=I,B._charsetService=F,B._coreService=K,B._dirtyRowService=Z,B._logService=ue,B._optionsService=ae,B._coreMouseService=Ce,B._unicodeService=we,B._parser=fe,B._parseBuffer=new Uint32Array(4096),B._stringDecoder=new p.StringToUtf32,B._utf8Decoder=new p.Utf8ToUtf32,B._workCell=new c.CellData,B._windowTitle="",B._iconName="",B._windowTitleStack=[],B._iconNameStack=[],B._curAttrData=a.DEFAULT_ATTR_DATA.clone(),B._eraseAttrDataInternal=a.DEFAULT_ATTR_DATA.clone(),B._onRequestBell=new s.EventEmitter,B._onRequestRefreshRows=new s.EventEmitter,B._onRequestReset=new s.EventEmitter,B._onRequestSendFocus=new s.EventEmitter,B._onRequestSyncScrollBar=new s.EventEmitter,B._onRequestWindowsOptionsReport=new s.EventEmitter,B._onA11yChar=new s.EventEmitter,B._onA11yTab=new s.EventEmitter,B._onCursorMove=new s.EventEmitter,B._onLineFeed=new s.EventEmitter,B._onScroll=new s.EventEmitter,B._onTitleChange=new s.EventEmitter,B._onColor=new s.EventEmitter,B._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},B._specialColors=[256,257,258],B.register(B._parser),B._activeBuffer=B._bufferService.buffer,B.register(B._bufferService.buffers.onBufferActivate(function(G){return B._activeBuffer=G.activeBuffer})),B._parser.setCsiHandlerFallback(function(G,_e){B._logService.debug("Unknown CSI code: ",{identifier:B._parser.identToString(G),params:_e.toArray()})}),B._parser.setEscHandlerFallback(function(G){B._logService.debug("Unknown ESC code: ",{identifier:B._parser.identToString(G)})}),B._parser.setExecuteHandlerFallback(function(G){B._logService.debug("Unknown EXECUTE code: ",{code:G})}),B._parser.setOscHandlerFallback(function(G,_e,Le){B._logService.debug("Unknown OSC code: ",{identifier:G,action:_e,data:Le})}),B._parser.setDcsHandlerFallback(function(G,_e,Le){_e==="HOOK"&&(Le=Le.toArray()),B._logService.debug("Unknown DCS code: ",{identifier:B._parser.identToString(G),action:_e,payload:Le})}),B._parser.setPrintHandler(function(G,_e,Le){return B.print(G,_e,Le)}),B._parser.registerCsiHandler({final:"@"},function(G){return B.insertChars(G)}),B._parser.registerCsiHandler({intermediates:" ",final:"@"},function(G){return B.scrollLeft(G)}),B._parser.registerCsiHandler({final:"A"},function(G){return B.cursorUp(G)}),B._parser.registerCsiHandler({intermediates:" ",final:"A"},function(G){return B.scrollRight(G)}),B._parser.registerCsiHandler({final:"B"},function(G){return B.cursorDown(G)}),B._parser.registerCsiHandler({final:"C"},function(G){return B.cursorForward(G)}),B._parser.registerCsiHandler({final:"D"},function(G){return B.cursorBackward(G)}),B._parser.registerCsiHandler({final:"E"},function(G){return B.cursorNextLine(G)}),B._parser.registerCsiHandler({final:"F"},function(G){return B.cursorPrecedingLine(G)}),B._parser.registerCsiHandler({final:"G"},function(G){return B.cursorCharAbsolute(G)}),B._parser.registerCsiHandler({final:"H"},function(G){return B.cursorPosition(G)}),B._parser.registerCsiHandler({final:"I"},function(G){return B.cursorForwardTab(G)}),B._parser.registerCsiHandler({final:"J"},function(G){return B.eraseInDisplay(G)}),B._parser.registerCsiHandler({prefix:"?",final:"J"},function(G){return B.eraseInDisplay(G)}),B._parser.registerCsiHandler({final:"K"},function(G){return B.eraseInLine(G)}),B._parser.registerCsiHandler({prefix:"?",final:"K"},function(G){return B.eraseInLine(G)}),B._parser.registerCsiHandler({final:"L"},function(G){return B.insertLines(G)}),B._parser.registerCsiHandler({final:"M"},function(G){return B.deleteLines(G)}),B._parser.registerCsiHandler({final:"P"},function(G){return B.deleteChars(G)}),B._parser.registerCsiHandler({final:"S"},function(G){return B.scrollUp(G)}),B._parser.registerCsiHandler({final:"T"},function(G){return B.scrollDown(G)}),B._parser.registerCsiHandler({final:"X"},function(G){return B.eraseChars(G)}),B._parser.registerCsiHandler({final:"Z"},function(G){return B.cursorBackwardTab(G)}),B._parser.registerCsiHandler({final:"`"},function(G){return B.charPosAbsolute(G)}),B._parser.registerCsiHandler({final:"a"},function(G){return B.hPositionRelative(G)}),B._parser.registerCsiHandler({final:"b"},function(G){return B.repeatPrecedingCharacter(G)}),B._parser.registerCsiHandler({final:"c"},function(G){return B.sendDeviceAttributesPrimary(G)}),B._parser.registerCsiHandler({prefix:">",final:"c"},function(G){return B.sendDeviceAttributesSecondary(G)}),B._parser.registerCsiHandler({final:"d"},function(G){return B.linePosAbsolute(G)}),B._parser.registerCsiHandler({final:"e"},function(G){return B.vPositionRelative(G)}),B._parser.registerCsiHandler({final:"f"},function(G){return B.hVPosition(G)}),B._parser.registerCsiHandler({final:"g"},function(G){return B.tabClear(G)}),B._parser.registerCsiHandler({final:"h"},function(G){return B.setMode(G)}),B._parser.registerCsiHandler({prefix:"?",final:"h"},function(G){return B.setModePrivate(G)}),B._parser.registerCsiHandler({final:"l"},function(G){return B.resetMode(G)}),B._parser.registerCsiHandler({prefix:"?",final:"l"},function(G){return B.resetModePrivate(G)}),B._parser.registerCsiHandler({final:"m"},function(G){return B.charAttributes(G)}),B._parser.registerCsiHandler({final:"n"},function(G){return B.deviceStatus(G)}),B._parser.registerCsiHandler({prefix:"?",final:"n"},function(G){return B.deviceStatusPrivate(G)}),B._parser.registerCsiHandler({intermediates:"!",final:"p"},function(G){return B.softReset(G)}),B._parser.registerCsiHandler({intermediates:" ",final:"q"},function(G){return B.setCursorStyle(G)}),B._parser.registerCsiHandler({final:"r"},function(G){return B.setScrollRegion(G)}),B._parser.registerCsiHandler({final:"s"},function(G){return B.saveCursor(G)}),B._parser.registerCsiHandler({final:"t"},function(G){return B.windowOptions(G)}),B._parser.registerCsiHandler({final:"u"},function(G){return B.restoreCursor(G)}),B._parser.registerCsiHandler({intermediates:"'",final:"}"},function(G){return B.insertColumns(G)}),B._parser.registerCsiHandler({intermediates:"'",final:"~"},function(G){return B.deleteColumns(G)}),B._parser.setExecuteHandler(m.C0.BEL,function(){return B.bell()}),B._parser.setExecuteHandler(m.C0.LF,function(){return B.lineFeed()}),B._parser.setExecuteHandler(m.C0.VT,function(){return B.lineFeed()}),B._parser.setExecuteHandler(m.C0.FF,function(){return B.lineFeed()}),B._parser.setExecuteHandler(m.C0.CR,function(){return B.carriageReturn()}),B._parser.setExecuteHandler(m.C0.BS,function(){return B.backspace()}),B._parser.setExecuteHandler(m.C0.HT,function(){return B.tab()}),B._parser.setExecuteHandler(m.C0.SO,function(){return B.shiftOut()}),B._parser.setExecuteHandler(m.C0.SI,function(){return B.shiftIn()}),B._parser.setExecuteHandler(m.C1.IND,function(){return B.index()}),B._parser.setExecuteHandler(m.C1.NEL,function(){return B.nextLine()}),B._parser.setExecuteHandler(m.C1.HTS,function(){return B.tabSet()}),B._parser.registerOscHandler(0,new x.OscHandler(function(G){return B.setTitle(G),B.setIconName(G),!0})),B._parser.registerOscHandler(1,new x.OscHandler(function(G){return B.setIconName(G)})),B._parser.registerOscHandler(2,new x.OscHandler(function(G){return B.setTitle(G)})),B._parser.registerOscHandler(4,new x.OscHandler(function(G){return B.setOrReportIndexedColor(G)})),B._parser.registerOscHandler(10,new x.OscHandler(function(G){return B.setOrReportFgColor(G)})),B._parser.registerOscHandler(11,new x.OscHandler(function(G){return B.setOrReportBgColor(G)})),B._parser.registerOscHandler(12,new x.OscHandler(function(G){return B.setOrReportCursorColor(G)})),B._parser.registerOscHandler(104,new x.OscHandler(function(G){return B.restoreIndexedColor(G)})),B._parser.registerOscHandler(110,new x.OscHandler(function(G){return B.restoreFgColor(G)})),B._parser.registerOscHandler(111,new x.OscHandler(function(G){return B.restoreBgColor(G)})),B._parser.registerOscHandler(112,new x.OscHandler(function(G){return B.restoreCursorColor(G)})),B._parser.registerEscHandler({final:"7"},function(){return B.saveCursor()}),B._parser.registerEscHandler({final:"8"},function(){return B.restoreCursor()}),B._parser.registerEscHandler({final:"D"},function(){return B.index()}),B._parser.registerEscHandler({final:"E"},function(){return B.nextLine()}),B._parser.registerEscHandler({final:"H"},function(){return B.tabSet()}),B._parser.registerEscHandler({final:"M"},function(){return B.reverseIndex()}),B._parser.registerEscHandler({final:"="},function(){return B.keypadApplicationMode()}),B._parser.registerEscHandler({final:">"},function(){return B.keypadNumericMode()}),B._parser.registerEscHandler({final:"c"},function(){return B.fullReset()}),B._parser.registerEscHandler({final:"n"},function(){return B.setgLevel(2)}),B._parser.registerEscHandler({final:"o"},function(){return B.setgLevel(3)}),B._parser.registerEscHandler({final:"|"},function(){return B.setgLevel(3)}),B._parser.registerEscHandler({final:"}"},function(){return B.setgLevel(2)}),B._parser.registerEscHandler({final:"~"},function(){return B.setgLevel(1)}),B._parser.registerEscHandler({intermediates:"%",final:"@"},function(){return B.selectDefaultCharset()}),B._parser.registerEscHandler({intermediates:"%",final:"G"},function(){return B.selectDefaultCharset()});var N=function(G){U._parser.registerEscHandler({intermediates:"(",final:G},function(){return B.selectCharset("("+G)}),U._parser.registerEscHandler({intermediates:")",final:G},function(){return B.selectCharset(")"+G)}),U._parser.registerEscHandler({intermediates:"*",final:G},function(){return B.selectCharset("*"+G)}),U._parser.registerEscHandler({intermediates:"+",final:G},function(){return B.selectCharset("+"+G)}),U._parser.registerEscHandler({intermediates:"-",final:G},function(){return B.selectCharset("-"+G)}),U._parser.registerEscHandler({intermediates:".",final:G},function(){return B.selectCharset("."+G)}),U._parser.registerEscHandler({intermediates:"/",final:G},function(){return B.selectCharset("/"+G)})},U=this;for(var se in b.CHARSETS)N(se);return B._parser.registerEscHandler({intermediates:"#",final:"8"},function(){return B.screenAlignmentPattern()}),B._parser.setErrorHandler(function(G){return B._logService.error("Parsing error: ",G),G}),B._parser.registerDcsHandler({intermediates:"$",final:"q"},new D(B._bufferService,B._coreService,B._logService,B._optionsService)),B}return y(j,Y),Object.defineProperty(j.prototype,"onRequestBell",{get:function(){return this._onRequestBell.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onRequestRefreshRows",{get:function(){return this._onRequestRefreshRows.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onRequestReset",{get:function(){return this._onRequestReset.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onRequestSendFocus",{get:function(){return this._onRequestSendFocus.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onRequestSyncScrollBar",{get:function(){return this._onRequestSyncScrollBar.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onRequestWindowsOptionsReport",{get:function(){return this._onRequestWindowsOptionsReport.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onA11yChar",{get:function(){return this._onA11yChar.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onA11yTab",{get:function(){return this._onA11yTab.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onColor",{get:function(){return this._onColor.event},enumerable:!1,configurable:!0}),j.prototype.dispose=function(){Y.prototype.dispose.call(this)},j.prototype._preserveStack=function(I,F,K,Z){this._parseStack.paused=!0,this._parseStack.cursorStartX=I,this._parseStack.cursorStartY=F,this._parseStack.decodedLength=K,this._parseStack.position=Z},j.prototype._logSlowResolvingAsync=function(I){this._logService.logLevel<=g.LogLevelEnum.WARN&&Promise.race([I,new Promise(function(F,K){return setTimeout(function(){return K("#SLOW_TIMEOUT")},5e3)})]).catch(function(F){if(F!=="#SLOW_TIMEOUT")throw F;console.warn("async parser handler taking longer than 5000 ms")})},j.prototype.parse=function(I,F){var K,Z=this._activeBuffer.x,ue=this._activeBuffer.y,ae=0,Ce=this._parseStack.paused;if(Ce){if(K=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,F))return this._logSlowResolvingAsync(K),K;Z=this._parseStack.cursorStartX,ue=this._parseStack.cursorStartY,this._parseStack.paused=!1,I.length>M&&(ae=this._parseStack.position+M)}if(this._logService.logLevel<=g.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof I=="string"?' "'+I+'"':""),typeof I=="string"?I.split("").map(function(N){return N.charCodeAt(0)}):I),this._parseBuffer.length<I.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(I.length,M))),Ce||this._dirtyRowService.clearRange(),I.length>M)for(var we=ae;we<I.length;we+=M){var fe=we+M<I.length?we+M:I.length,B=typeof I=="string"?this._stringDecoder.decode(I.substring(we,fe),this._parseBuffer):this._utf8Decoder.decode(I.subarray(we,fe),this._parseBuffer);if(K=this._parser.parse(this._parseBuffer,B))return this._preserveStack(Z,ue,B,we),this._logSlowResolvingAsync(K),K}else if(!Ce&&(B=typeof I=="string"?this._stringDecoder.decode(I,this._parseBuffer):this._utf8Decoder.decode(I,this._parseBuffer),K=this._parser.parse(this._parseBuffer,B)))return this._preserveStack(Z,ue,B,0),this._logSlowResolvingAsync(K),K;this._activeBuffer.x===Z&&this._activeBuffer.y===ue||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowService.start,this._dirtyRowService.end)},j.prototype.print=function(I,F,K){var Z,ue,ae=this._charsetService.charset,Ce=this._optionsService.options.screenReaderMode,we=this._bufferService.cols,fe=this._coreService.decPrivateModes.wraparound,B=this._coreService.modes.insertMode,N=this._curAttrData,U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowService.markDirty(this._activeBuffer.y),this._activeBuffer.x&&K-F>0&&U.getWidth(this._activeBuffer.x-1)===2&&U.setCellFromCodePoint(this._activeBuffer.x-1,0,1,N.fg,N.bg,N.extended);for(var se=F;se<K;++se){if(Z=I[se],ue=this._unicodeService.wcwidth(Z),Z<127&&ae){var G=ae[String.fromCharCode(Z)];G&&(Z=G.charCodeAt(0))}if(Ce&&this._onA11yChar.fire((0,p.stringFromCodePoint)(Z)),ue||!this._activeBuffer.x){if(this._activeBuffer.x+ue-1>=we){if(fe){for(;this._activeBuffer.x<we;)U.setCellFromCodePoint(this._activeBuffer.x++,0,1,N.fg,N.bg,N.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),U=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=we-1,ue===2)continue}if(B&&(U.insertCells(this._activeBuffer.x,ue,this._activeBuffer.getNullCell(N),N),U.getWidth(we-1)===2&&U.setCellFromCodePoint(we-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,N.fg,N.bg,N.extended)),U.setCellFromCodePoint(this._activeBuffer.x++,Z,ue,N.fg,N.bg,N.extended),ue>0)for(;--ue;)U.setCellFromCodePoint(this._activeBuffer.x++,0,0,N.fg,N.bg,N.extended)}else U.getWidth(this._activeBuffer.x-1)?U.addCodepointToCell(this._activeBuffer.x-1,Z):U.addCodepointToCell(this._activeBuffer.x-2,Z)}K-F>0&&(U.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<we&&K-F>0&&U.getWidth(this._activeBuffer.x)===0&&!U.hasContent(this._activeBuffer.x)&&U.setCellFromCodePoint(this._activeBuffer.x,0,1,N.fg,N.bg,N.extended),this._dirtyRowService.markDirty(this._activeBuffer.y)},j.prototype.registerCsiHandler=function(I,F){var K=this;return I.final!=="t"||I.prefix||I.intermediates?this._parser.registerCsiHandler(I,F):this._parser.registerCsiHandler(I,function(Z){return!L(Z.params[0],K._optionsService.options.windowOptions)||F(Z)})},j.prototype.registerDcsHandler=function(I,F){return this._parser.registerDcsHandler(I,new T.DcsHandler(F))},j.prototype.registerEscHandler=function(I,F){return this._parser.registerEscHandler(I,F)},j.prototype.registerOscHandler=function(I,F){return this._parser.registerOscHandler(I,new x.OscHandler(F))},j.prototype.bell=function(){return this._onRequestBell.fire(),!0},j.prototype.lineFeed=function(){return this._dirtyRowService.markDirty(this._activeBuffer.y),this._optionsService.options.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowService.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0},j.prototype.carriageReturn=function(){return this._activeBuffer.x=0,!0},j.prototype.backspace=function(){var I;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((I=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||I===void 0?void 0:I.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;var F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);F.hasWidth(this._activeBuffer.x)&&!F.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0},j.prototype.tab=function(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;var I=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.options.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-I),!0},j.prototype.shiftOut=function(){return this._charsetService.setgLevel(1),!0},j.prototype.shiftIn=function(){return this._charsetService.setgLevel(0),!0},j.prototype._restrictCursor=function(I){I===void 0&&(I=this._bufferService.cols-1),this._activeBuffer.x=Math.min(I,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowService.markDirty(this._activeBuffer.y)},j.prototype._setCursor=function(I,F){this._dirtyRowService.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=I,this._activeBuffer.y=this._activeBuffer.scrollTop+F):(this._activeBuffer.x=I,this._activeBuffer.y=F),this._restrictCursor(),this._dirtyRowService.markDirty(this._activeBuffer.y)},j.prototype._moveCursor=function(I,F){this._restrictCursor(),this._setCursor(this._activeBuffer.x+I,this._activeBuffer.y+F)},j.prototype.cursorUp=function(I){var F=this._activeBuffer.y-this._activeBuffer.scrollTop;return F>=0?this._moveCursor(0,-Math.min(F,I.params[0]||1)):this._moveCursor(0,-(I.params[0]||1)),!0},j.prototype.cursorDown=function(I){var F=this._activeBuffer.scrollBottom-this._activeBuffer.y;return F>=0?this._moveCursor(0,Math.min(F,I.params[0]||1)):this._moveCursor(0,I.params[0]||1),!0},j.prototype.cursorForward=function(I){return this._moveCursor(I.params[0]||1,0),!0},j.prototype.cursorBackward=function(I){return this._moveCursor(-(I.params[0]||1),0),!0},j.prototype.cursorNextLine=function(I){return this.cursorDown(I),this._activeBuffer.x=0,!0},j.prototype.cursorPrecedingLine=function(I){return this.cursorUp(I),this._activeBuffer.x=0,!0},j.prototype.cursorCharAbsolute=function(I){return this._setCursor((I.params[0]||1)-1,this._activeBuffer.y),!0},j.prototype.cursorPosition=function(I){return this._setCursor(I.length>=2?(I.params[1]||1)-1:0,(I.params[0]||1)-1),!0},j.prototype.charPosAbsolute=function(I){return this._setCursor((I.params[0]||1)-1,this._activeBuffer.y),!0},j.prototype.hPositionRelative=function(I){return this._moveCursor(I.params[0]||1,0),!0},j.prototype.linePosAbsolute=function(I){return this._setCursor(this._activeBuffer.x,(I.params[0]||1)-1),!0},j.prototype.vPositionRelative=function(I){return this._moveCursor(0,I.params[0]||1),!0},j.prototype.hVPosition=function(I){return this.cursorPosition(I),!0},j.prototype.tabClear=function(I){var F=I.params[0];return F===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:F===3&&(this._activeBuffer.tabs={}),!0},j.prototype.cursorForwardTab=function(I){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var F=I.params[0]||1;F--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0},j.prototype.cursorBackwardTab=function(I){if(this._activeBuffer.x>=this._bufferService.cols)return!0;for(var F=I.params[0]||1;F--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0},j.prototype._eraseInBufferLine=function(I,F,K,Z){Z===void 0&&(Z=!1);var ue=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);ue.replaceCells(F,K,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),Z&&(ue.isWrapped=!1)},j.prototype._resetBufferLine=function(I){var F=this._activeBuffer.lines.get(this._activeBuffer.ybase+I);F.fill(this._activeBuffer.getNullCell(this._eraseAttrData())),F.isWrapped=!1},j.prototype.eraseInDisplay=function(I){var F;switch(this._restrictCursor(this._bufferService.cols),I.params[0]){case 0:for(F=this._activeBuffer.y,this._dirtyRowService.markDirty(F),this._eraseInBufferLine(F++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0);F<this._bufferService.rows;F++)this._resetBufferLine(F);this._dirtyRowService.markDirty(F);break;case 1:for(F=this._activeBuffer.y,this._dirtyRowService.markDirty(F),this._eraseInBufferLine(F,0,this._activeBuffer.x+1,!0),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(F+1).isWrapped=!1);F--;)this._resetBufferLine(F);this._dirtyRowService.markDirty(0);break;case 2:for(F=this._bufferService.rows,this._dirtyRowService.markDirty(F-1);F--;)this._resetBufferLine(F);this._dirtyRowService.markDirty(0);break;case 3:var K=this._activeBuffer.lines.length-this._bufferService.rows;K>0&&(this._activeBuffer.lines.trimStart(K),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-K,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-K,0),this._onScroll.fire(0))}return!0},j.prototype.eraseInLine=function(I){switch(this._restrictCursor(this._bufferService.cols),I.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0)}return this._dirtyRowService.markDirty(this._activeBuffer.y),!0},j.prototype.insertLines=function(I){this._restrictCursor();var F=I.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var K=this._activeBuffer.ybase+this._activeBuffer.y,Z=this._bufferService.rows-1-this._activeBuffer.scrollBottom,ue=this._bufferService.rows-1+this._activeBuffer.ybase-Z+1;F--;)this._activeBuffer.lines.splice(ue-1,1),this._activeBuffer.lines.splice(K,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},j.prototype.deleteLines=function(I){this._restrictCursor();var F=I.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;var K,Z=this._activeBuffer.ybase+this._activeBuffer.y;for(K=this._bufferService.rows-1-this._activeBuffer.scrollBottom,K=this._bufferService.rows-1+this._activeBuffer.ybase-K;F--;)this._activeBuffer.lines.splice(Z,1),this._activeBuffer.lines.splice(K,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0},j.prototype.insertChars=function(I){this._restrictCursor();var F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.insertCells(this._activeBuffer.x,I.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},j.prototype.deleteChars=function(I){this._restrictCursor();var F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.deleteCells(this._activeBuffer.x,I.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},j.prototype.scrollUp=function(I){for(var F=I.params[0]||1;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},j.prototype.scrollDown=function(I){for(var F=I.params[0]||1;F--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(a.DEFAULT_ATTR_DATA));return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},j.prototype.scrollLeft=function(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var F=I.params[0]||1,K=this._activeBuffer.scrollTop;K<=this._activeBuffer.scrollBottom;++K){var Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+K);Z.deleteCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),Z.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},j.prototype.scrollRight=function(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var F=I.params[0]||1,K=this._activeBuffer.scrollTop;K<=this._activeBuffer.scrollBottom;++K){var Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+K);Z.insertCells(0,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),Z.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},j.prototype.insertColumns=function(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var F=I.params[0]||1,K=this._activeBuffer.scrollTop;K<=this._activeBuffer.scrollBottom;++K){var Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+K);Z.insertCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),Z.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},j.prototype.deleteColumns=function(I){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;for(var F=I.params[0]||1,K=this._activeBuffer.scrollTop;K<=this._activeBuffer.scrollBottom;++K){var Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+K);Z.deleteCells(this._activeBuffer.x,F,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),Z.isWrapped=!1}return this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0},j.prototype.eraseChars=function(I){this._restrictCursor();var F=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return F&&(F.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(I.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowService.markDirty(this._activeBuffer.y)),!0},j.prototype.repeatPrecedingCharacter=function(I){if(!this._parser.precedingCodepoint)return!0;for(var F=I.params[0]||1,K=new Uint32Array(F),Z=0;Z<F;++Z)K[Z]=this._parser.precedingCodepoint;return this.print(K,0,K.length),!0},j.prototype.sendDeviceAttributesPrimary=function(I){return I.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(m.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(m.C0.ESC+"[?6c")),!0},j.prototype.sendDeviceAttributesSecondary=function(I){return I.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(m.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(m.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(I.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(m.C0.ESC+"[>83;40003;0c")),!0},j.prototype._is=function(I){return(this._optionsService.options.termName+"").indexOf(I)===0},j.prototype.setMode=function(I){for(var F=0;F<I.length;F++)I.params[F]===4&&(this._coreService.modes.insertMode=!0);return!0},j.prototype.setModePrivate=function(I){for(var F=0;F<I.length;F++)switch(I.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,b.DEFAULT_CHARSET),this._charsetService.setgCharset(1,b.DEFAULT_CHARSET),this._charsetService.setgCharset(2,b.DEFAULT_CHARSET),this._charsetService.setgCharset(3,b.DEFAULT_CHARSET);break;case 3:this._optionsService.options.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0},j.prototype.resetMode=function(I){for(var F=0;F<I.length;F++)I.params[F]===4&&(this._coreService.modes.insertMode=!1);return!0},j.prototype.resetModePrivate=function(I){for(var F=0;F<I.length;F++)switch(I.params[F]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.options.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),I.params[F]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0},j.prototype._updateAttrColor=function(I,F,K,Z,ue){return F===2?(I|=50331648,I&=-16777216,I|=d.AttributeData.fromColorRGB([K,Z,ue])):F===5&&(I&=-50331904,I|=33554432|255&K),I},j.prototype._extractColor=function(I,F,K){var Z=[0,0,-1,0,0,0],ue=0,ae=0;do{if(Z[ae+ue]=I.params[F+ae],I.hasSubParams(F+ae)){var Ce=I.getSubParams(F+ae),we=0;do Z[1]===5&&(ue=1),Z[ae+we+1+ue]=Ce[we];while(++we<Ce.length&&we+ae+1+ue<Z.length);break}if(Z[1]===5&&ae+ue>=2||Z[1]===2&&ae+ue>=5)break;Z[1]&&(ue=1)}while(++ae+F<I.length&&ae+ue<Z.length);for(we=2;we<Z.length;++we)Z[we]===-1&&(Z[we]=0);switch(Z[0]){case 38:K.fg=this._updateAttrColor(K.fg,Z[1],Z[3],Z[4],Z[5]);break;case 48:K.bg=this._updateAttrColor(K.bg,Z[1],Z[3],Z[4],Z[5]);break;case 58:K.extended=K.extended.clone(),K.extended.underlineColor=this._updateAttrColor(K.extended.underlineColor,Z[1],Z[3],Z[4],Z[5])}return ae},j.prototype._processUnderline=function(I,F){F.extended=F.extended.clone(),(!~I||I>5)&&(I=1),F.extended.underlineStyle=I,F.fg|=268435456,I===0&&(F.fg&=-268435457),F.updateExtended()},j.prototype.charAttributes=function(I){if(I.length===1&&I.params[0]===0)return this._curAttrData.fg=a.DEFAULT_ATTR_DATA.fg,this._curAttrData.bg=a.DEFAULT_ATTR_DATA.bg,!0;for(var F,K=I.length,Z=this._curAttrData,ue=0;ue<K;ue++)(F=I.params[ue])>=30&&F<=37?(Z.fg&=-50331904,Z.fg|=16777216|F-30):F>=40&&F<=47?(Z.bg&=-50331904,Z.bg|=16777216|F-40):F>=90&&F<=97?(Z.fg&=-50331904,Z.fg|=16777224|F-90):F>=100&&F<=107?(Z.bg&=-50331904,Z.bg|=16777224|F-100):F===0?(Z.fg=a.DEFAULT_ATTR_DATA.fg,Z.bg=a.DEFAULT_ATTR_DATA.bg):F===1?Z.fg|=134217728:F===3?Z.bg|=67108864:F===4?(Z.fg|=268435456,this._processUnderline(I.hasSubParams(ue)?I.getSubParams(ue)[0]:1,Z)):F===5?Z.fg|=536870912:F===7?Z.fg|=67108864:F===8?Z.fg|=1073741824:F===9?Z.fg|=2147483648:F===2?Z.bg|=134217728:F===21?this._processUnderline(2,Z):F===22?(Z.fg&=-134217729,Z.bg&=-134217729):F===23?Z.bg&=-67108865:F===24?Z.fg&=-268435457:F===25?Z.fg&=-536870913:F===27?Z.fg&=-67108865:F===28?Z.fg&=-1073741825:F===29?Z.fg&=2147483647:F===39?(Z.fg&=-67108864,Z.fg|=16777215&a.DEFAULT_ATTR_DATA.fg):F===49?(Z.bg&=-67108864,Z.bg|=16777215&a.DEFAULT_ATTR_DATA.bg):F===38||F===48||F===58?ue+=this._extractColor(I,ue,Z):F===59?(Z.extended=Z.extended.clone(),Z.extended.underlineColor=-1,Z.updateExtended()):F===100?(Z.fg&=-67108864,Z.fg|=16777215&a.DEFAULT_ATTR_DATA.fg,Z.bg&=-67108864,Z.bg|=16777215&a.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",F);return!0},j.prototype.deviceStatus=function(I){switch(I.params[0]){case 5:this._coreService.triggerDataEvent(m.C0.ESC+"[0n");break;case 6:var F=this._activeBuffer.y+1,K=this._activeBuffer.x+1;this._coreService.triggerDataEvent(m.C0.ESC+"["+F+";"+K+"R")}return!0},j.prototype.deviceStatusPrivate=function(I){if(I.params[0]===6){var F=this._activeBuffer.y+1,K=this._activeBuffer.x+1;this._coreService.triggerDataEvent(m.C0.ESC+"[?"+F+";"+K+"R")}return!0},j.prototype.softReset=function(I){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0},j.prototype.setCursorStyle=function(I){var F=I.params[0]||1;switch(F){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}var K=F%2==1;return this._optionsService.options.cursorBlink=K,!0},j.prototype.setScrollRegion=function(I){var F,K=I.params[0]||1;return(I.length<2||(F=I.params[1])>this._bufferService.rows||F===0)&&(F=this._bufferService.rows),F>K&&(this._activeBuffer.scrollTop=K-1,this._activeBuffer.scrollBottom=F-1,this._setCursor(0,0)),!0},j.prototype.windowOptions=function(I){if(!L(I.params[0],this._optionsService.options.windowOptions))return!0;var F=I.length>1?I.params[1]:0;switch(I.params[0]){case 14:F!==2&&this._onRequestWindowsOptionsReport.fire(w.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(w.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(m.C0.ESC+"[8;"+this._bufferService.rows+";"+this._bufferService.cols+"t");break;case 22:F!==0&&F!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),F!==0&&F!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:F!==0&&F!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),F!==0&&F!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0},j.prototype.saveCursor=function(I){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0},j.prototype.restoreCursor=function(I){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0},j.prototype.setTitle=function(I){return this._windowTitle=I,this._onTitleChange.fire(I),!0},j.prototype.setIconName=function(I){return this._iconName=I,!0},j.prototype.setOrReportIndexedColor=function(I){for(var F=[],K=I.split(";");K.length>1;){var Z=K.shift(),ue=K.shift();if(/^\d+$/.exec(Z)){var ae=parseInt(Z);if(0<=ae&&ae<256)if(ue==="?")F.push({type:0,index:ae});else{var Ce=(0,H.parseColor)(ue);Ce&&F.push({type:1,index:ae,color:Ce})}}}return F.length&&this._onColor.fire(F),!0},j.prototype._setOrReportSpecialColor=function(I,F){for(var K=I.split(";"),Z=0;Z<K.length&&!(F>=this._specialColors.length);++Z,++F)if(K[Z]==="?")this._onColor.fire([{type:0,index:this._specialColors[F]}]);else{var ue=(0,H.parseColor)(K[Z]);ue&&this._onColor.fire([{type:1,index:this._specialColors[F],color:ue}])}return!0},j.prototype.setOrReportFgColor=function(I){return this._setOrReportSpecialColor(I,0)},j.prototype.setOrReportBgColor=function(I){return this._setOrReportSpecialColor(I,1)},j.prototype.setOrReportCursorColor=function(I){return this._setOrReportSpecialColor(I,2)},j.prototype.restoreIndexedColor=function(I){if(!I)return this._onColor.fire([{type:2}]),!0;for(var F=[],K=I.split(";"),Z=0;Z<K.length;++Z)if(/^\d+$/.exec(K[Z])){var ue=parseInt(K[Z]);0<=ue&&ue<256&&F.push({type:2,index:ue})}return F.length&&this._onColor.fire(F),!0},j.prototype.restoreFgColor=function(I){return this._onColor.fire([{type:2,index:256}]),!0},j.prototype.restoreBgColor=function(I){return this._onColor.fire([{type:2,index:257}]),!0},j.prototype.restoreCursorColor=function(I){return this._onColor.fire([{type:2,index:258}]),!0},j.prototype.nextLine=function(){return this._activeBuffer.x=0,this.index(),!0},j.prototype.keypadApplicationMode=function(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0},j.prototype.keypadNumericMode=function(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0},j.prototype.selectDefaultCharset=function(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,b.DEFAULT_CHARSET),!0},j.prototype.selectCharset=function(I){return I.length!==2?(this.selectDefaultCharset(),!0):(I[0]==="/"||this._charsetService.setgCharset(P[I[0]],b.CHARSETS[I[1]]||b.DEFAULT_CHARSET),!0)},j.prototype.index=function(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0},j.prototype.tabSet=function(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0},j.prototype.reverseIndex=function(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){var I=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,I,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowService.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0},j.prototype.fullReset=function(){return this._parser.reset(),this._onRequestReset.fire(),!0},j.prototype.reset=function(){this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=a.DEFAULT_ATTR_DATA.clone()},j.prototype._eraseAttrData=function(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal},j.prototype.setgLevel=function(I){return this._charsetService.setgLevel(I),!0},j.prototype.screenAlignmentPattern=function(){var I=new c.CellData;I.content=1<<22|"E".charCodeAt(0),I.fg=this._curAttrData.fg,I.bg=this._curAttrData.bg,this._setCursor(0,0);for(var F=0;F<this._bufferService.rows;++F){var K=this._activeBuffer.ybase+this._activeBuffer.y+F,Z=this._activeBuffer.lines.get(K);Z&&(Z.fill(I),Z.isWrapped=!1)}return this._dirtyRowService.markAllDirty(),this._setCursor(0,0),!0},j}(u.Disposable);h.InputHandler=E},844:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getDisposeArrayDisposable=h.disposeArray=h.Disposable=void 0;var k=function(){function y(){this._disposables=[],this._isDisposed=!1}return y.prototype.dispose=function(){this._isDisposed=!0;for(var w=0,m=this._disposables;w<m.length;w++)m[w].dispose();this._disposables.length=0},y.prototype.register=function(w){return this._disposables.push(w),w},y.prototype.unregister=function(w){var m=this._disposables.indexOf(w);m!==-1&&this._disposables.splice(m,1)},y}();function v(y){for(var w=0,m=y;w<m.length;w++)m[w].dispose();y.length=0}h.Disposable=k,h.disposeArray=v,h.getDisposeArrayDisposable=function(y){return{dispose:function(){return v(y)}}}},6114:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.isLinux=h.isWindows=h.isIphone=h.isIpad=h.isMac=h.isSafari=h.isFirefox=void 0;var k=typeof navigator=="undefined",v=k?"node":navigator.userAgent,y=k?"node":navigator.platform;h.isFirefox=v.includes("Firefox"),h.isSafari=/^((?!chrome|android).)*safari/i.test(v),h.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(y),h.isIpad=y==="iPad",h.isIphone=y==="iPhone",h.isWindows=["Windows","Win16","Win32","WinCE"].includes(y),h.isLinux=y.indexOf("Linux")>=0},8273:($,h)=>{function k(v,y,w,m){if(w===void 0&&(w=0),m===void 0&&(m=v.length),w>=v.length)return v;w=(v.length+w)%v.length,m=m>=v.length?v.length:(v.length+m)%v.length;for(var b=w;b<m;++b)v[b]=y;return v}Object.defineProperty(h,"__esModule",{value:!0}),h.concat=h.fillFallback=h.fill=void 0,h.fill=function(v,y,w,m){return v.fill?v.fill(y,w,m):k(v,y,w,m)},h.fillFallback=k,h.concat=function(v,y){var w=new v.constructor(v.length+y.length);return w.set(v),w.set(y,v.length),w}},9282:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.updateWindowsModeWrappedState=void 0;var v=k(643);h.updateWindowsModeWrappedState=function(y){var w=y.buffer.lines.get(y.buffer.ybase+y.buffer.y-1),m=w==null?void 0:w.get(y.cols-1),b=y.buffer.lines.get(y.buffer.ybase+y.buffer.y);b&&m&&(b.isWrapped=m[v.CHAR_DATA_CODE_INDEX]!==v.NULL_CELL_CODE&&m[v.CHAR_DATA_CODE_INDEX]!==v.WHITESPACE_CELL_CODE)}},3734:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ExtendedAttrs=h.AttributeData=void 0;var k=function(){function y(){this.fg=0,this.bg=0,this.extended=new v}return y.toColorRGB=function(w){return[w>>>16&255,w>>>8&255,255&w]},y.fromColorRGB=function(w){return(255&w[0])<<16|(255&w[1])<<8|255&w[2]},y.prototype.clone=function(){var w=new y;return w.fg=this.fg,w.bg=this.bg,w.extended=this.extended.clone(),w},y.prototype.isInverse=function(){return 67108864&this.fg},y.prototype.isBold=function(){return 134217728&this.fg},y.prototype.isUnderline=function(){return 268435456&this.fg},y.prototype.isBlink=function(){return 536870912&this.fg},y.prototype.isInvisible=function(){return 1073741824&this.fg},y.prototype.isItalic=function(){return 67108864&this.bg},y.prototype.isDim=function(){return 134217728&this.bg},y.prototype.isStrikethrough=function(){return 2147483648&this.fg},y.prototype.getFgColorMode=function(){return 50331648&this.fg},y.prototype.getBgColorMode=function(){return 50331648&this.bg},y.prototype.isFgRGB=function(){return(50331648&this.fg)==50331648},y.prototype.isBgRGB=function(){return(50331648&this.bg)==50331648},y.prototype.isFgPalette=function(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432},y.prototype.isBgPalette=function(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432},y.prototype.isFgDefault=function(){return(50331648&this.fg)==0},y.prototype.isBgDefault=function(){return(50331648&this.bg)==0},y.prototype.isAttributeDefault=function(){return this.fg===0&&this.bg===0},y.prototype.getFgColor=function(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}},y.prototype.getBgColor=function(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}},y.prototype.hasExtendedAttrs=function(){return 268435456&this.bg},y.prototype.updateExtended=function(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456},y.prototype.getUnderlineColor=function(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()},y.prototype.getUnderlineColorMode=function(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()},y.prototype.isUnderlineColorRGB=function(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()},y.prototype.isUnderlineColorPalette=function(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()},y.prototype.isUnderlineColorDefault=function(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()},y.prototype.getUnderlineStyle=function(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0},y}();h.AttributeData=k;var v=function(){function y(w,m){w===void 0&&(w=0),m===void 0&&(m=-1),this.underlineStyle=w,this.underlineColor=m}return y.prototype.clone=function(){return new y(this.underlineStyle,this.underlineColor)},y.prototype.isEmpty=function(){return this.underlineStyle===0},y}();h.ExtendedAttrs=v},9092:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BufferStringIterator=h.Buffer=h.MAX_BUFFER_SIZE=void 0;var v=k(6349),y=k(8437),w=k(511),m=k(643),b=k(4634),S=k(4863),u=k(7116),f=k(3734);h.MAX_BUFFER_SIZE=4294967295;var p=function(){function s(o,c,d){this._hasScrollback=o,this._optionsService=c,this._bufferService=d,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.savedY=0,this.savedX=0,this.savedCurAttrData=y.DEFAULT_ATTR_DATA.clone(),this.savedCharset=u.DEFAULT_CHARSET,this.markers=[],this._nullCell=w.CellData.fromCharData([0,m.NULL_CELL_CHAR,m.NULL_CELL_WIDTH,m.NULL_CELL_CODE]),this._whitespaceCell=w.CellData.fromCharData([0,m.WHITESPACE_CELL_CHAR,m.WHITESPACE_CELL_WIDTH,m.WHITESPACE_CELL_CODE]),this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new v.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}return s.prototype.getNullCell=function(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg,this._nullCell.extended=o.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new f.ExtendedAttrs),this._nullCell},s.prototype.getWhitespaceCell=function(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg,this._whitespaceCell.extended=o.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new f.ExtendedAttrs),this._whitespaceCell},s.prototype.getBlankLine=function(o,c){return new y.BufferLine(this._bufferService.cols,this.getNullCell(o),c)},Object.defineProperty(s.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isCursorInViewport",{get:function(){var o=this.ybase+this.y-this.ydisp;return o>=0&&o<this._rows},enumerable:!1,configurable:!0}),s.prototype._getCorrectBufferLength=function(o){if(!this._hasScrollback)return o;var c=o+this._optionsService.options.scrollback;return c>h.MAX_BUFFER_SIZE?h.MAX_BUFFER_SIZE:c},s.prototype.fillViewportRows=function(o){if(this.lines.length===0){o===void 0&&(o=y.DEFAULT_ATTR_DATA);for(var c=this._rows;c--;)this.lines.push(this.getBlankLine(o))}},s.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new v.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},s.prototype.resize=function(o,c){var d=this.getNullCell(y.DEFAULT_ATTR_DATA),g=this._getCorrectBufferLength(c);if(g>this.lines.maxLength&&(this.lines.maxLength=g),this.lines.length>0){if(this._cols<o)for(var x=0;x<this.lines.length;x++)this.lines.get(x).resize(o,d);var T=0;if(this._rows<c)for(var H=this._rows;H<c;H++)this.lines.length<c+this.ybase&&(this._optionsService.options.windowsMode?this.lines.push(new y.BufferLine(o,d)):this.ybase>0&&this.lines.length<=this.ybase+this.y+T+1?(this.ybase--,T++,this.ydisp>0&&this.ydisp--):this.lines.push(new y.BufferLine(o,d)));else for(H=this._rows;H>c;H--)this.lines.length>c+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(g<this.lines.maxLength){var P=this.lines.length-g;P>0&&(this.lines.trimStart(P),this.ybase=Math.max(this.ybase-P,0),this.ydisp=Math.max(this.ydisp-P,0),this.savedY=Math.max(this.savedY-P,0)),this.lines.maxLength=g}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,c-1),T&&(this.y+=T),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=c-1,this._isReflowEnabled&&(this._reflow(o,c),this._cols>o))for(x=0;x<this.lines.length;x++)this.lines.get(x).resize(o,d);this._cols=o,this._rows=c},Object.defineProperty(s.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._optionsService.options.windowsMode},enumerable:!1,configurable:!0}),s.prototype._reflow=function(o,c){this._cols!==o&&(o>this._cols?this._reflowLarger(o,c):this._reflowSmaller(o,c))},s.prototype._reflowLarger=function(o,c){var d=(0,b.reflowLargerGetLinesToRemove)(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(y.DEFAULT_ATTR_DATA));if(d.length>0){var g=(0,b.reflowLargerCreateNewLayout)(this.lines,d);(0,b.reflowLargerApplyNewLayout)(this.lines,g.layout),this._reflowLargerAdjustViewport(o,c,g.countRemoved)}},s.prototype._reflowLargerAdjustViewport=function(o,c,d){for(var g=this.getNullCell(y.DEFAULT_ATTR_DATA),x=d;x-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<c&&this.lines.push(new y.BufferLine(o,g))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-d,0)},s.prototype._reflowSmaller=function(o,c){for(var d=this.getNullCell(y.DEFAULT_ATTR_DATA),g=[],x=0,T=this.lines.length-1;T>=0;T--){var H=this.lines.get(T);if(!(!H||!H.isWrapped&&H.getTrimmedLength()<=o)){for(var P=[H];H.isWrapped&&T>0;)H=this.lines.get(--T),P.unshift(H);var M=this.ybase+this.y;if(!(M>=T&&M<T+P.length)){var L,D=P[P.length-1].getTrimmedLength(),E=(0,b.reflowSmallerGetNewLineLengths)(P,this._cols,o),Y=E.length-P.length;L=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+Y):Math.max(0,this.lines.length-this.lines.maxLength+Y);for(var j=[],I=0;I<Y;I++){var F=this.getBlankLine(y.DEFAULT_ATTR_DATA,!0);j.push(F)}j.length>0&&(g.push({start:T+P.length+x,newLines:j}),x+=j.length),P.push.apply(P,j);var K=E.length-1,Z=E[K];Z===0&&(Z=E[--K]);for(var ue=P.length-Y-1,ae=D;ue>=0;){var Ce=Math.min(ae,Z);if(P[K].copyCellsFrom(P[ue],ae-Ce,Z-Ce,Ce,!0),(Z-=Ce)==0&&(Z=E[--K]),(ae-=Ce)==0){ue--;var we=Math.max(ue,0);ae=(0,b.getWrappedLineTrimmedLength)(P,we,this._cols)}}for(I=0;I<P.length;I++)E[I]<o&&P[I].setCell(E[I],d);for(var fe=Y-L;fe-- >0;)this.ybase===0?this.y<c-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+x)-c&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+Y,this.ybase+c-1)}}}if(g.length>0){var B=[],N=[];for(I=0;I<this.lines.length;I++)N.push(this.lines.get(I));var U=this.lines.length,se=U-1,G=0,_e=g[G];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+x);var Le=0;for(I=Math.min(this.lines.maxLength-1,U+x-1);I>=0;I--)if(_e&&_e.start>se+Le){for(var Be=_e.newLines.length-1;Be>=0;Be--)this.lines.set(I--,_e.newLines[Be]);I++,B.push({index:se+1,amount:_e.newLines.length}),Le+=_e.newLines.length,_e=g[++G]}else this.lines.set(I,N[se--]);var Ee=0;for(I=B.length-1;I>=0;I--)B[I].index+=Ee,this.lines.onInsertEmitter.fire(B[I]),Ee+=B[I].amount;var Ie=Math.max(0,U+x-this.lines.maxLength);Ie>0&&this.lines.onTrimEmitter.fire(Ie)}},s.prototype.stringIndexToBufferIndex=function(o,c,d){for(d===void 0&&(d=!1);c;){var g=this.lines.get(o);if(!g)return[-1,-1];for(var x=d?g.getTrimmedLength():g.length,T=0;T<x;++T)if(g.get(T)[m.CHAR_DATA_WIDTH_INDEX]&&(c-=g.get(T)[m.CHAR_DATA_CHAR_INDEX].length||1),c<0)return[o,T];o++}return[o,0]},s.prototype.translateBufferLineToString=function(o,c,d,g){d===void 0&&(d=0);var x=this.lines.get(o);return x?x.translateToString(c,d,g):""},s.prototype.getWrappedRangeForLine=function(o){for(var c=o,d=o;c>0&&this.lines.get(c).isWrapped;)c--;for(;d+1<this.lines.length&&this.lines.get(d+1).isWrapped;)d++;return{first:c,last:d}},s.prototype.setupTabStops=function(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._optionsService.options.tabStopWidth)this.tabs[o]=!0},s.prototype.prevStop=function(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o},s.prototype.nextStop=function(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o},s.prototype.addMarker=function(o){var c=this,d=new S.Marker(o);return this.markers.push(d),d.register(this.lines.onTrim(function(g){d.line-=g,d.line<0&&d.dispose()})),d.register(this.lines.onInsert(function(g){d.line>=g.index&&(d.line+=g.amount)})),d.register(this.lines.onDelete(function(g){d.line>=g.index&&d.line<g.index+g.amount&&d.dispose(),d.line>g.index&&(d.line-=g.amount)})),d.register(d.onDispose(function(){return c._removeMarker(d)})),d},s.prototype._removeMarker=function(o){this.markers.splice(this.markers.indexOf(o),1)},s.prototype.iterator=function(o,c,d,g,x){return new a(this,o,c,d,g,x)},s}();h.Buffer=p;var a=function(){function s(o,c,d,g,x,T){d===void 0&&(d=0),g===void 0&&(g=o.lines.length),x===void 0&&(x=0),T===void 0&&(T=0),this._buffer=o,this._trimRight=c,this._startIndex=d,this._endIndex=g,this._startOverscan=x,this._endOverscan=T,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return s.prototype.hasNext=function(){return this._current<this._endIndex},s.prototype.next=function(){var o=this._buffer.getWrappedRangeForLine(this._current);o.first<this._startIndex-this._startOverscan&&(o.first=this._startIndex-this._startOverscan),o.last>this._endIndex+this._endOverscan&&(o.last=this._endIndex+this._endOverscan),o.first=Math.max(o.first,0),o.last=Math.min(o.last,this._buffer.lines.length);for(var c="",d=o.first;d<=o.last;++d)c+=this._buffer.translateBufferLineToString(d,this._trimRight);return this._current=o.last+1,{range:o,content:c}},s}();h.BufferStringIterator=a},8437:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BufferLine=h.DEFAULT_ATTR_DATA=void 0;var v=k(482),y=k(643),w=k(511),m=k(3734);h.DEFAULT_ATTR_DATA=Object.freeze(new m.AttributeData);var b=function(){function S(u,f,p){p===void 0&&(p=!1),this.isWrapped=p,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*u);for(var a=f||w.CellData.fromCharData([0,y.NULL_CELL_CHAR,y.NULL_CELL_WIDTH,y.NULL_CELL_CODE]),s=0;s<u;++s)this.setCell(s,a);this.length=u}return S.prototype.get=function(u){var f=this._data[3*u+0],p=2097151&f;return[this._data[3*u+1],2097152&f?this._combined[u]:p?(0,v.stringFromCodePoint)(p):"",f>>22,2097152&f?this._combined[u].charCodeAt(this._combined[u].length-1):p]},S.prototype.set=function(u,f){this._data[3*u+1]=f[y.CHAR_DATA_ATTR_INDEX],f[y.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[u]=f[1],this._data[3*u+0]=2097152|u|f[y.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*u+0]=f[y.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|f[y.CHAR_DATA_WIDTH_INDEX]<<22},S.prototype.getWidth=function(u){return this._data[3*u+0]>>22},S.prototype.hasWidth=function(u){return 12582912&this._data[3*u+0]},S.prototype.getFg=function(u){return this._data[3*u+1]},S.prototype.getBg=function(u){return this._data[3*u+2]},S.prototype.hasContent=function(u){return 4194303&this._data[3*u+0]},S.prototype.getCodePoint=function(u){var f=this._data[3*u+0];return 2097152&f?this._combined[u].charCodeAt(this._combined[u].length-1):2097151&f},S.prototype.isCombined=function(u){return 2097152&this._data[3*u+0]},S.prototype.getString=function(u){var f=this._data[3*u+0];return 2097152&f?this._combined[u]:2097151&f?(0,v.stringFromCodePoint)(2097151&f):""},S.prototype.loadCell=function(u,f){var p=3*u;return f.content=this._data[p+0],f.fg=this._data[p+1],f.bg=this._data[p+2],2097152&f.content&&(f.combinedData=this._combined[u]),268435456&f.bg&&(f.extended=this._extendedAttrs[u]),f},S.prototype.setCell=function(u,f){2097152&f.content&&(this._combined[u]=f.combinedData),268435456&f.bg&&(this._extendedAttrs[u]=f.extended),this._data[3*u+0]=f.content,this._data[3*u+1]=f.fg,this._data[3*u+2]=f.bg},S.prototype.setCellFromCodePoint=function(u,f,p,a,s,o){268435456&s&&(this._extendedAttrs[u]=o),this._data[3*u+0]=f|p<<22,this._data[3*u+1]=a,this._data[3*u+2]=s},S.prototype.addCodepointToCell=function(u,f){var p=this._data[3*u+0];2097152&p?this._combined[u]+=(0,v.stringFromCodePoint)(f):(2097151&p?(this._combined[u]=(0,v.stringFromCodePoint)(2097151&p)+(0,v.stringFromCodePoint)(f),p&=-2097152,p|=2097152):p=f|1<<22,this._data[3*u+0]=p)},S.prototype.insertCells=function(u,f,p,a){if((u%=this.length)&&this.getWidth(u-1)===2&&this.setCellFromCodePoint(u-1,0,1,(a==null?void 0:a.fg)||0,(a==null?void 0:a.bg)||0,(a==null?void 0:a.extended)||new m.ExtendedAttrs),f<this.length-u){for(var s=new w.CellData,o=this.length-u-f-1;o>=0;--o)this.setCell(u+f+o,this.loadCell(u+o,s));for(o=0;o<f;++o)this.setCell(u+o,p)}else for(o=u;o<this.length;++o)this.setCell(o,p);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,(a==null?void 0:a.fg)||0,(a==null?void 0:a.bg)||0,(a==null?void 0:a.extended)||new m.ExtendedAttrs)},S.prototype.deleteCells=function(u,f,p,a){if(u%=this.length,f<this.length-u){for(var s=new w.CellData,o=0;o<this.length-u-f;++o)this.setCell(u+o,this.loadCell(u+f+o,s));for(o=this.length-f;o<this.length;++o)this.setCell(o,p)}else for(o=u;o<this.length;++o)this.setCell(o,p);u&&this.getWidth(u-1)===2&&this.setCellFromCodePoint(u-1,0,1,(a==null?void 0:a.fg)||0,(a==null?void 0:a.bg)||0,(a==null?void 0:a.extended)||new m.ExtendedAttrs),this.getWidth(u)!==0||this.hasContent(u)||this.setCellFromCodePoint(u,0,1,(a==null?void 0:a.fg)||0,(a==null?void 0:a.bg)||0,(a==null?void 0:a.extended)||new m.ExtendedAttrs)},S.prototype.replaceCells=function(u,f,p,a){for(u&&this.getWidth(u-1)===2&&this.setCellFromCodePoint(u-1,0,1,(a==null?void 0:a.fg)||0,(a==null?void 0:a.bg)||0,(a==null?void 0:a.extended)||new m.ExtendedAttrs),f<this.length&&this.getWidth(f-1)===2&&this.setCellFromCodePoint(f,0,1,(a==null?void 0:a.fg)||0,(a==null?void 0:a.bg)||0,(a==null?void 0:a.extended)||new m.ExtendedAttrs);u<f&&u<this.length;)this.setCell(u++,p)},S.prototype.resize=function(u,f){if(u!==this.length){if(u>this.length){var p=new Uint32Array(3*u);this.length&&(3*u<this._data.length?p.set(this._data.subarray(0,3*u)):p.set(this._data)),this._data=p;for(var a=this.length;a<u;++a)this.setCell(a,f)}else if(u){(p=new Uint32Array(3*u)).set(this._data.subarray(0,3*u)),this._data=p;var s=Object.keys(this._combined);for(a=0;a<s.length;a++){var o=parseInt(s[a],10);o>=u&&delete this._combined[o]}}else this._data=new Uint32Array(0),this._combined={};this.length=u}},S.prototype.fill=function(u){this._combined={},this._extendedAttrs={};for(var f=0;f<this.length;++f)this.setCell(f,u)},S.prototype.copyFrom=function(u){for(var f in this.length!==u.length?this._data=new Uint32Array(u._data):this._data.set(u._data),this.length=u.length,this._combined={},u._combined)this._combined[f]=u._combined[f];for(var f in this._extendedAttrs={},u._extendedAttrs)this._extendedAttrs[f]=u._extendedAttrs[f];this.isWrapped=u.isWrapped},S.prototype.clone=function(){var u=new S(0);for(var f in u._data=new Uint32Array(this._data),u.length=this.length,this._combined)u._combined[f]=this._combined[f];for(var f in this._extendedAttrs)u._extendedAttrs[f]=this._extendedAttrs[f];return u.isWrapped=this.isWrapped,u},S.prototype.getTrimmedLength=function(){for(var u=this.length-1;u>=0;--u)if(4194303&this._data[3*u+0])return u+(this._data[3*u+0]>>22);return 0},S.prototype.copyCellsFrom=function(u,f,p,a,s){var o=u._data;if(s)for(var c=a-1;c>=0;c--)for(var d=0;d<3;d++)this._data[3*(p+c)+d]=o[3*(f+c)+d];else for(c=0;c<a;c++)for(d=0;d<3;d++)this._data[3*(p+c)+d]=o[3*(f+c)+d];var g=Object.keys(u._combined);for(d=0;d<g.length;d++){var x=parseInt(g[d],10);x>=f&&(this._combined[x-f+p]=u._combined[x])}},S.prototype.translateToString=function(u,f,p){u===void 0&&(u=!1),f===void 0&&(f=0),p===void 0&&(p=this.length),u&&(p=Math.min(p,this.getTrimmedLength()));for(var a="";f<p;){var s=this._data[3*f+0],o=2097151&s;a+=2097152&s?this._combined[f]:o?(0,v.stringFromCodePoint)(o):y.WHITESPACE_CELL_CHAR,f+=s>>22||1}return a},S}();h.BufferLine=b},4841:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getRangeLength=void 0,h.getRangeLength=function(k,v){if(k.start.y>k.end.y)throw new Error("Buffer range end ("+k.end.x+", "+k.end.y+") cannot be before start ("+k.start.x+", "+k.start.y+")");return v*(k.end.y-k.start.y)+(k.end.x-k.start.x+1)}},4634:($,h)=>{function k(v,y,w){if(y===v.length-1)return v[y].getTrimmedLength();var m=!v[y].hasContent(w-1)&&v[y].getWidth(w-1)===1,b=v[y+1].getWidth(0)===2;return m&&b?w-1:w}Object.defineProperty(h,"__esModule",{value:!0}),h.getWrappedLineTrimmedLength=h.reflowSmallerGetNewLineLengths=h.reflowLargerApplyNewLayout=h.reflowLargerCreateNewLayout=h.reflowLargerGetLinesToRemove=void 0,h.reflowLargerGetLinesToRemove=function(v,y,w,m,b){for(var S=[],u=0;u<v.length-1;u++){var f=u,p=v.get(++f);if(p.isWrapped){for(var a=[v.get(u)];f<v.length&&p.isWrapped;)a.push(p),p=v.get(++f);if(m>=u&&m<f)u+=a.length-1;else{for(var s=0,o=k(a,s,y),c=1,d=0;c<a.length;){var g=k(a,c,y),x=g-d,T=w-o,H=Math.min(x,T);a[s].copyCellsFrom(a[c],d,o,H,!1),(o+=H)===w&&(s++,o=0),(d+=H)===g&&(c++,d=0),o===0&&s!==0&&a[s-1].getWidth(w-1)===2&&(a[s].copyCellsFrom(a[s-1],w-1,o++,1,!1),a[s-1].setCell(w-1,b))}a[s].replaceCells(o,w,b);for(var P=0,M=a.length-1;M>0&&(M>s||a[M].getTrimmedLength()===0);M--)P++;P>0&&(S.push(u+a.length-P),S.push(P)),u+=a.length-1}}}return S},h.reflowLargerCreateNewLayout=function(v,y){for(var w=[],m=0,b=y[m],S=0,u=0;u<v.length;u++)if(b===u){var f=y[++m];v.onDeleteEmitter.fire({index:u-S,amount:f}),u+=f-1,S+=f,b=y[++m]}else w.push(u);return{layout:w,countRemoved:S}},h.reflowLargerApplyNewLayout=function(v,y){for(var w=[],m=0;m<y.length;m++)w.push(v.get(y[m]));for(m=0;m<w.length;m++)v.set(m,w[m]);v.length=y.length},h.reflowSmallerGetNewLineLengths=function(v,y,w){for(var m=[],b=v.map(function(o,c){return k(v,c,y)}).reduce(function(o,c){return o+c}),S=0,u=0,f=0;f<b;){if(b-f<w){m.push(b-f);break}S+=w;var p=k(v,u,y);S>p&&(S-=p,u++);var a=v[u].getWidth(S-1)===2;a&&S--;var s=a?w-1:w;m.push(s),f+=s}return m},h.getWrappedLineTrimmedLength=k},5295:function($,h,k){var v,y=this&&this.__extends||(v=function(S,u){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,p){f.__proto__=p}||function(f,p){for(var a in p)Object.prototype.hasOwnProperty.call(p,a)&&(f[a]=p[a])},v(S,u)},function(S,u){if(typeof u!="function"&&u!==null)throw new TypeError("Class extends value "+String(u)+" is not a constructor or null");function f(){this.constructor=S}v(S,u),S.prototype=u===null?Object.create(u):(f.prototype=u.prototype,new f)});Object.defineProperty(h,"__esModule",{value:!0}),h.BufferSet=void 0;var w=k(9092),m=k(8460),b=function(S){function u(f,p){var a=S.call(this)||this;return a._optionsService=f,a._bufferService=p,a._onBufferActivate=a.register(new m.EventEmitter),a.reset(),a}return y(u,S),Object.defineProperty(u.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!1,configurable:!0}),u.prototype.reset=function(){this._normal=new w.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new w.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()},Object.defineProperty(u.prototype,"alt",{get:function(){return this._alt},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),u.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},u.prototype.activateAltBuffer=function(f){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(f),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},u.prototype.resize=function(f,p){this._normal.resize(f,p),this._alt.resize(f,p)},u.prototype.setupTabStops=function(f){this._normal.setupTabStops(f),this._alt.setupTabStops(f)},u}(k(844).Disposable);h.BufferSet=b},511:function($,h,k){var v,y=this&&this.__extends||(v=function(u,f){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,a){p.__proto__=a}||function(p,a){for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(p[s]=a[s])},v(u,f)},function(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function p(){this.constructor=u}v(u,f),u.prototype=f===null?Object.create(f):(p.prototype=f.prototype,new p)});Object.defineProperty(h,"__esModule",{value:!0}),h.CellData=void 0;var w=k(482),m=k(643),b=k(3734),S=function(u){function f(){var p=u!==null&&u.apply(this,arguments)||this;return p.content=0,p.fg=0,p.bg=0,p.extended=new b.ExtendedAttrs,p.combinedData="",p}return y(f,u),f.fromCharData=function(p){var a=new f;return a.setFromCharData(p),a},f.prototype.isCombined=function(){return 2097152&this.content},f.prototype.getWidth=function(){return this.content>>22},f.prototype.getChars=function(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,w.stringFromCodePoint)(2097151&this.content):""},f.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content},f.prototype.setFromCharData=function(p){this.fg=p[m.CHAR_DATA_ATTR_INDEX],this.bg=0;var a=!1;if(p[m.CHAR_DATA_CHAR_INDEX].length>2)a=!0;else if(p[m.CHAR_DATA_CHAR_INDEX].length===2){var s=p[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=s&&s<=56319){var o=p[m.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=o&&o<=57343?this.content=1024*(s-55296)+o-56320+65536|p[m.CHAR_DATA_WIDTH_INDEX]<<22:a=!0}else a=!0}else this.content=p[m.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[m.CHAR_DATA_WIDTH_INDEX]<<22;a&&(this.combinedData=p[m.CHAR_DATA_CHAR_INDEX],this.content=2097152|p[m.CHAR_DATA_WIDTH_INDEX]<<22)},f.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},f}(b.AttributeData);h.CellData=S},643:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.WHITESPACE_CELL_CODE=h.WHITESPACE_CELL_WIDTH=h.WHITESPACE_CELL_CHAR=h.NULL_CELL_CODE=h.NULL_CELL_WIDTH=h.NULL_CELL_CHAR=h.CHAR_DATA_CODE_INDEX=h.CHAR_DATA_WIDTH_INDEX=h.CHAR_DATA_CHAR_INDEX=h.CHAR_DATA_ATTR_INDEX=h.DEFAULT_ATTR=h.DEFAULT_COLOR=void 0,h.DEFAULT_COLOR=256,h.DEFAULT_ATTR=256|h.DEFAULT_COLOR<<9,h.CHAR_DATA_ATTR_INDEX=0,h.CHAR_DATA_CHAR_INDEX=1,h.CHAR_DATA_WIDTH_INDEX=2,h.CHAR_DATA_CODE_INDEX=3,h.NULL_CELL_CHAR="",h.NULL_CELL_WIDTH=1,h.NULL_CELL_CODE=0,h.WHITESPACE_CELL_CHAR=" ",h.WHITESPACE_CELL_WIDTH=1,h.WHITESPACE_CELL_CODE=32},4863:function($,h,k){var v,y=this&&this.__extends||(v=function(b,S){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,f){u.__proto__=f}||function(u,f){for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(u[p]=f[p])},v(b,S)},function(b,S){if(typeof S!="function"&&S!==null)throw new TypeError("Class extends value "+String(S)+" is not a constructor or null");function u(){this.constructor=b}v(b,S),b.prototype=S===null?Object.create(S):(u.prototype=S.prototype,new u)});Object.defineProperty(h,"__esModule",{value:!0}),h.Marker=void 0;var w=k(8460),m=function(b){function S(u){var f=b.call(this)||this;return f.line=u,f._id=S._nextId++,f.isDisposed=!1,f._onDispose=new w.EventEmitter,f}return y(S,b),Object.defineProperty(S.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(S.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!1,configurable:!0}),S.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),b.prototype.dispose.call(this))},S._nextId=1,S}(k(844).Disposable);h.Marker=m},7116:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.DEFAULT_CHARSET=h.CHARSETS=void 0,h.CHARSETS={},h.DEFAULT_CHARSET=h.CHARSETS.B,h.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},h.CHARSETS.A={"#":"\xA3"},h.CHARSETS.B=void 0,h.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},h.CHARSETS.C=h.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},h.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},h.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},h.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},h.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},h.CHARSETS.E=h.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},h.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},h.CHARSETS.H=h.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},h.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:($,h)=>{var k,v;Object.defineProperty(h,"__esModule",{value:!0}),h.C1=h.C0=void 0,(v=h.C0||(h.C0={})).NUL="\0",v.SOH="",v.STX="",v.ETX="",v.EOT="",v.ENQ="",v.ACK="",v.BEL="\x07",v.BS="\b",v.HT="	",v.LF=`
`,v.VT="\v",v.FF="\f",v.CR="\r",v.SO="",v.SI="",v.DLE="",v.DC1="",v.DC2="",v.DC3="",v.DC4="",v.NAK="",v.SYN="",v.ETB="",v.CAN="",v.EM="",v.SUB="",v.ESC="",v.FS="",v.GS="",v.RS="",v.US="",v.SP=" ",v.DEL="\x7F",(k=h.C1||(h.C1={})).PAD="\x80",k.HOP="\x81",k.BPH="\x82",k.NBH="\x83",k.IND="\x84",k.NEL="\x85",k.SSA="\x86",k.ESA="\x87",k.HTS="\x88",k.HTJ="\x89",k.VTS="\x8A",k.PLD="\x8B",k.PLU="\x8C",k.RI="\x8D",k.SS2="\x8E",k.SS3="\x8F",k.DCS="\x90",k.PU1="\x91",k.PU2="\x92",k.STS="\x93",k.CCH="\x94",k.MW="\x95",k.SPA="\x96",k.EPA="\x97",k.SOS="\x98",k.SGCI="\x99",k.SCI="\x9A",k.CSI="\x9B",k.ST="\x9C",k.OSC="\x9D",k.PM="\x9E",k.APC="\x9F"},7399:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.evaluateKeyboardEvent=void 0;var v=k(2584),y={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};h.evaluateKeyboardEvent=function(w,m,b,S){var u={type:0,cancel:!1,key:void 0},f=(w.shiftKey?1:0)|(w.altKey?2:0)|(w.ctrlKey?4:0)|(w.metaKey?8:0);switch(w.keyCode){case 0:w.key==="UIKeyInputUpArrow"?u.key=m?v.C0.ESC+"OA":v.C0.ESC+"[A":w.key==="UIKeyInputLeftArrow"?u.key=m?v.C0.ESC+"OD":v.C0.ESC+"[D":w.key==="UIKeyInputRightArrow"?u.key=m?v.C0.ESC+"OC":v.C0.ESC+"[C":w.key==="UIKeyInputDownArrow"&&(u.key=m?v.C0.ESC+"OB":v.C0.ESC+"[B");break;case 8:if(w.shiftKey){u.key=v.C0.BS;break}if(w.altKey){u.key=v.C0.ESC+v.C0.DEL;break}u.key=v.C0.DEL;break;case 9:if(w.shiftKey){u.key=v.C0.ESC+"[Z";break}u.key=v.C0.HT,u.cancel=!0;break;case 13:u.key=w.altKey?v.C0.ESC+v.C0.CR:v.C0.CR,u.cancel=!0;break;case 27:u.key=v.C0.ESC,w.altKey&&(u.key=v.C0.ESC+v.C0.ESC),u.cancel=!0;break;case 37:if(w.metaKey)break;f?(u.key=v.C0.ESC+"[1;"+(f+1)+"D",u.key===v.C0.ESC+"[1;3D"&&(u.key=v.C0.ESC+(b?"b":"[1;5D"))):u.key=m?v.C0.ESC+"OD":v.C0.ESC+"[D";break;case 39:if(w.metaKey)break;f?(u.key=v.C0.ESC+"[1;"+(f+1)+"C",u.key===v.C0.ESC+"[1;3C"&&(u.key=v.C0.ESC+(b?"f":"[1;5C"))):u.key=m?v.C0.ESC+"OC":v.C0.ESC+"[C";break;case 38:if(w.metaKey)break;f?(u.key=v.C0.ESC+"[1;"+(f+1)+"A",b||u.key!==v.C0.ESC+"[1;3A"||(u.key=v.C0.ESC+"[1;5A")):u.key=m?v.C0.ESC+"OA":v.C0.ESC+"[A";break;case 40:if(w.metaKey)break;f?(u.key=v.C0.ESC+"[1;"+(f+1)+"B",b||u.key!==v.C0.ESC+"[1;3B"||(u.key=v.C0.ESC+"[1;5B")):u.key=m?v.C0.ESC+"OB":v.C0.ESC+"[B";break;case 45:w.shiftKey||w.ctrlKey||(u.key=v.C0.ESC+"[2~");break;case 46:u.key=f?v.C0.ESC+"[3;"+(f+1)+"~":v.C0.ESC+"[3~";break;case 36:u.key=f?v.C0.ESC+"[1;"+(f+1)+"H":m?v.C0.ESC+"OH":v.C0.ESC+"[H";break;case 35:u.key=f?v.C0.ESC+"[1;"+(f+1)+"F":m?v.C0.ESC+"OF":v.C0.ESC+"[F";break;case 33:w.shiftKey?u.type=2:u.key=v.C0.ESC+"[5~";break;case 34:w.shiftKey?u.type=3:u.key=v.C0.ESC+"[6~";break;case 112:u.key=f?v.C0.ESC+"[1;"+(f+1)+"P":v.C0.ESC+"OP";break;case 113:u.key=f?v.C0.ESC+"[1;"+(f+1)+"Q":v.C0.ESC+"OQ";break;case 114:u.key=f?v.C0.ESC+"[1;"+(f+1)+"R":v.C0.ESC+"OR";break;case 115:u.key=f?v.C0.ESC+"[1;"+(f+1)+"S":v.C0.ESC+"OS";break;case 116:u.key=f?v.C0.ESC+"[15;"+(f+1)+"~":v.C0.ESC+"[15~";break;case 117:u.key=f?v.C0.ESC+"[17;"+(f+1)+"~":v.C0.ESC+"[17~";break;case 118:u.key=f?v.C0.ESC+"[18;"+(f+1)+"~":v.C0.ESC+"[18~";break;case 119:u.key=f?v.C0.ESC+"[19;"+(f+1)+"~":v.C0.ESC+"[19~";break;case 120:u.key=f?v.C0.ESC+"[20;"+(f+1)+"~":v.C0.ESC+"[20~";break;case 121:u.key=f?v.C0.ESC+"[21;"+(f+1)+"~":v.C0.ESC+"[21~";break;case 122:u.key=f?v.C0.ESC+"[23;"+(f+1)+"~":v.C0.ESC+"[23~";break;case 123:u.key=f?v.C0.ESC+"[24;"+(f+1)+"~":v.C0.ESC+"[24~";break;default:if(!w.ctrlKey||w.shiftKey||w.altKey||w.metaKey)if(b&&!S||!w.altKey||w.metaKey)!b||w.altKey||w.ctrlKey||w.shiftKey||!w.metaKey?w.key&&!w.ctrlKey&&!w.altKey&&!w.metaKey&&w.keyCode>=48&&w.key.length===1?u.key=w.key:w.key&&w.ctrlKey&&w.key==="_"&&(u.key=v.C0.US):w.keyCode===65&&(u.type=1);else{var p=y[w.keyCode],a=p==null?void 0:p[w.shiftKey?1:0];if(a)u.key=v.C0.ESC+a;else if(w.keyCode>=65&&w.keyCode<=90){var s=w.ctrlKey?w.keyCode-64:w.keyCode+32;u.key=v.C0.ESC+String.fromCharCode(s)}}else w.keyCode>=65&&w.keyCode<=90?u.key=String.fromCharCode(w.keyCode-64):w.keyCode===32?u.key=v.C0.NUL:w.keyCode>=51&&w.keyCode<=55?u.key=String.fromCharCode(w.keyCode-51+27):w.keyCode===56?u.key=v.C0.DEL:w.keyCode===219?u.key=v.C0.ESC:w.keyCode===220?u.key=v.C0.FS:w.keyCode===221&&(u.key=v.C0.GS)}return u}},482:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.Utf8ToUtf32=h.StringToUtf32=h.utf32ToString=h.stringFromCodePoint=void 0,h.stringFromCodePoint=function(y){return y>65535?(y-=65536,String.fromCharCode(55296+(y>>10))+String.fromCharCode(y%1024+56320)):String.fromCharCode(y)},h.utf32ToString=function(y,w,m){w===void 0&&(w=0),m===void 0&&(m=y.length);for(var b="",S=w;S<m;++S){var u=y[S];u>65535?(u-=65536,b+=String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):b+=String.fromCharCode(u)}return b};var k=function(){function y(){this._interim=0}return y.prototype.clear=function(){this._interim=0},y.prototype.decode=function(w,m){var b=w.length;if(!b)return 0;var S=0,u=0;this._interim&&(56320<=(a=w.charCodeAt(u++))&&a<=57343?m[S++]=1024*(this._interim-55296)+a-56320+65536:(m[S++]=this._interim,m[S++]=a),this._interim=0);for(var f=u;f<b;++f){var p=w.charCodeAt(f);if(55296<=p&&p<=56319){if(++f>=b)return this._interim=p,S;var a;56320<=(a=w.charCodeAt(f))&&a<=57343?m[S++]=1024*(p-55296)+a-56320+65536:(m[S++]=p,m[S++]=a)}else p!==65279&&(m[S++]=p)}return S},y}();h.StringToUtf32=k;var v=function(){function y(){this.interim=new Uint8Array(3)}return y.prototype.clear=function(){this.interim.fill(0)},y.prototype.decode=function(w,m){var b=w.length;if(!b)return 0;var S,u,f,p,a=0,s=0,o=0;if(this.interim[0]){var c=!1,d=this.interim[0];d&=(224&d)==192?31:(240&d)==224?15:7;for(var g=0,x=void 0;(x=63&this.interim[++g])&&g<4;)d<<=6,d|=x;for(var T=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,H=T-g;o<H;){if(o>=b)return 0;if((192&(x=w[o++]))!=128){o--,c=!0;break}this.interim[g++]=x,d<<=6,d|=63&x}c||(T===2?d<128?o--:m[a++]=d:T===3?d<2048||d>=55296&&d<=57343||d===65279||(m[a++]=d):d<65536||d>1114111||(m[a++]=d)),this.interim.fill(0)}for(var P=b-4,M=o;M<b;){for(;!(!(M<P)||128&(S=w[M])||128&(u=w[M+1])||128&(f=w[M+2])||128&(p=w[M+3]));)m[a++]=S,m[a++]=u,m[a++]=f,m[a++]=p,M+=4;if((S=w[M++])<128)m[a++]=S;else if((224&S)==192){if(M>=b)return this.interim[0]=S,a;if((192&(u=w[M++]))!=128){M--;continue}if((s=(31&S)<<6|63&u)<128){M--;continue}m[a++]=s}else if((240&S)==224){if(M>=b)return this.interim[0]=S,a;if((192&(u=w[M++]))!=128){M--;continue}if(M>=b)return this.interim[0]=S,this.interim[1]=u,a;if((192&(f=w[M++]))!=128){M--;continue}if((s=(15&S)<<12|(63&u)<<6|63&f)<2048||s>=55296&&s<=57343||s===65279)continue;m[a++]=s}else if((248&S)==240){if(M>=b)return this.interim[0]=S,a;if((192&(u=w[M++]))!=128){M--;continue}if(M>=b)return this.interim[0]=S,this.interim[1]=u,a;if((192&(f=w[M++]))!=128){M--;continue}if(M>=b)return this.interim[0]=S,this.interim[1]=u,this.interim[2]=f,a;if((192&(p=w[M++]))!=128){M--;continue}if((s=(7&S)<<18|(63&u)<<12|(63&f)<<6|63&p)<65536||s>1114111)continue;m[a++]=s}}return a},y}();h.Utf8ToUtf32=v},225:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.UnicodeV6=void 0;var v,y=k(8273),w=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],m=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],b=function(){function S(){if(this.version="6",!v){v=new Uint8Array(65536),(0,y.fill)(v,1),v[0]=0,(0,y.fill)(v,0,1,32),(0,y.fill)(v,0,127,160),(0,y.fill)(v,2,4352,4448),v[9001]=2,v[9002]=2,(0,y.fill)(v,2,11904,42192),v[12351]=1,(0,y.fill)(v,2,44032,55204),(0,y.fill)(v,2,63744,64256),(0,y.fill)(v,2,65040,65050),(0,y.fill)(v,2,65072,65136),(0,y.fill)(v,2,65280,65377),(0,y.fill)(v,2,65504,65511);for(var u=0;u<w.length;++u)(0,y.fill)(v,0,w[u][0],w[u][1]+1)}}return S.prototype.wcwidth=function(u){return u<32?0:u<127?1:u<65536?v[u]:function(f,p){var a,s=0,o=p.length-1;if(f<p[0][0]||f>p[o][1])return!1;for(;o>=s;)if(f>p[a=s+o>>1][1])s=a+1;else{if(!(f<p[a][0]))return!0;o=a-1}return!1}(u,m)?0:u>=131072&&u<=196605||u>=196608&&u<=262141?2:1},S}();h.UnicodeV6=b},5981:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.WriteBuffer=void 0;var k=typeof queueMicrotask=="undefined"?function(y){Promise.resolve().then(y)}:queueMicrotask,v=function(){function y(w){this._action=w,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0}return y.prototype.writeSync=function(w,m){if(m!==void 0&&this._syncCalls>m)this._syncCalls=0;else if(this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(void 0),this._syncCalls++,!this._isSyncWriting){var b;for(this._isSyncWriting=!0;b=this._writeBuffer.shift();){this._action(b);var S=this._callbacks.shift();S&&S()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}},y.prototype.write=function(w,m){var b=this;if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");this._writeBuffer.length||(this._bufferOffset=0,setTimeout(function(){return b._innerWrite()})),this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(m)},y.prototype._innerWrite=function(w,m){var b=this;w===void 0&&(w=0),m===void 0&&(m=!0);for(var S=w||Date.now();this._writeBuffer.length>this._bufferOffset;){var u=this._writeBuffer[this._bufferOffset],f=this._action(u,m);if(f)return void f.catch(function(a){return k(function(){throw a}),Promise.resolve(!1)}).then(function(a){return Date.now()-S>=12?setTimeout(function(){return b._innerWrite(0,a)}):b._innerWrite(S,a)});var p=this._callbacks[this._bufferOffset];if(p&&p(),this._bufferOffset++,this._pendingData-=u.length,Date.now()-S>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(function(){return b._innerWrite()})):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0)},y}();h.WriteBuffer=v},5941:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.toRgbString=h.parseColor=void 0;var k=/^([\da-f]{1})\/([\da-f]{1})\/([\da-f]{1})$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,v=/^[\da-f]+$/;function y(w,m){var b=w.toString(16),S=b.length<2?"0"+b:b;switch(m){case 4:return b[0];case 8:return S;case 12:return(S+S).slice(0,3);default:return S+S}}h.parseColor=function(w){if(w){var m=w.toLowerCase();if(m.indexOf("rgb:")===0){m=m.slice(4);var b=k.exec(m);if(b){var S=b[1]?15:b[4]?255:b[7]?4095:65535;return[Math.round(parseInt(b[1]||b[4]||b[7]||b[10],16)/S*255),Math.round(parseInt(b[2]||b[5]||b[8]||b[11],16)/S*255),Math.round(parseInt(b[3]||b[6]||b[9]||b[12],16)/S*255)]}}else if(m.indexOf("#")===0&&(m=m.slice(1),v.exec(m)&&[3,6,9,12].includes(m.length))){for(var u=m.length/3,f=[0,0,0],p=0;p<3;++p){var a=parseInt(m.slice(u*p,u*p+u),16);f[p]=u===1?a<<4:u===2?a:u===3?a>>4:a>>8}return f}}},h.toRgbString=function(w,m){m===void 0&&(m=16);var b=w[0],S=w[1],u=w[2];return"rgb:"+y(b,m)+"/"+y(S,m)+"/"+y(u,m)}},5770:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.PAYLOAD_LIMIT=void 0,h.PAYLOAD_LIMIT=1e7},6351:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.DcsHandler=h.DcsParser=void 0;var v=k(482),y=k(8742),w=k(5770),m=[],b=function(){function f(){this._handlers=Object.create(null),this._active=m,this._ident=0,this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return f.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=m},f.prototype.registerHandler=function(p,a){this._handlers[p]===void 0&&(this._handlers[p]=[]);var s=this._handlers[p];return s.push(a),{dispose:function(){var o=s.indexOf(a);o!==-1&&s.splice(o,1)}}},f.prototype.clearHandler=function(p){this._handlers[p]&&delete this._handlers[p]},f.prototype.setHandlerFallback=function(p){this._handlerFb=p},f.prototype.reset=function(){if(this._active.length)for(var p=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;p>=0;--p)this._active[p].unhook(!1);this._stack.paused=!1,this._active=m,this._ident=0},f.prototype.hook=function(p,a){if(this.reset(),this._ident=p,this._active=this._handlers[p]||m,this._active.length)for(var s=this._active.length-1;s>=0;s--)this._active[s].hook(a);else this._handlerFb(this._ident,"HOOK",a)},f.prototype.put=function(p,a,s){if(this._active.length)for(var o=this._active.length-1;o>=0;o--)this._active[o].put(p,a,s);else this._handlerFb(this._ident,"PUT",(0,v.utf32ToString)(p,a,s))},f.prototype.unhook=function(p,a){if(a===void 0&&(a=!0),this._active.length){var s=!1,o=this._active.length-1,c=!1;if(this._stack.paused&&(o=this._stack.loopPosition-1,s=a,c=this._stack.fallThrough,this._stack.paused=!1),!c&&s===!1){for(;o>=0&&(s=this._active[o].unhook(p))!==!0;o--)if(s instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!1,s;o--}for(;o>=0;o--)if((s=this._active[o].unhook(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=o,this._stack.fallThrough=!0,s}else this._handlerFb(this._ident,"UNHOOK",p);this._active=m,this._ident=0},f}();h.DcsParser=b;var S=new y.Params;S.addParam(0);var u=function(){function f(p){this._handler=p,this._data="",this._params=S,this._hitLimit=!1}return f.prototype.hook=function(p){this._params=p.length>1||p.params[0]?p.clone():S,this._data="",this._hitLimit=!1},f.prototype.put=function(p,a,s){this._hitLimit||(this._data+=(0,v.utf32ToString)(p,a,s),this._data.length>w.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},f.prototype.unhook=function(p){var a=this,s=!1;if(this._hitLimit)s=!1;else if(p&&(s=this._handler(this._data,this._params))instanceof Promise)return s.then(function(o){return a._params=S,a._data="",a._hitLimit=!1,o});return this._params=S,this._data="",this._hitLimit=!1,s},f}();h.DcsHandler=u},2015:function($,h,k){var v,y=this&&this.__extends||(v=function(s,o){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g])},v(s,o)},function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function c(){this.constructor=s}v(s,o),s.prototype=o===null?Object.create(o):(c.prototype=o.prototype,new c)});Object.defineProperty(h,"__esModule",{value:!0}),h.EscapeSequenceParser=h.VT500_TRANSITION_TABLE=h.TransitionTable=void 0;var w=k(844),m=k(8273),b=k(8742),S=k(6242),u=k(6351),f=function(){function s(o){this.table=new Uint8Array(o)}return s.prototype.setDefault=function(o,c){(0,m.fill)(this.table,o<<4|c)},s.prototype.add=function(o,c,d,g){this.table[c<<8|o]=d<<4|g},s.prototype.addMany=function(o,c,d,g){for(var x=0;x<o.length;x++)this.table[c<<8|o[x]]=d<<4|g},s}();h.TransitionTable=f;var p=160;h.VT500_TRANSITION_TABLE=function(){var s=new f(4095),o=Array.apply(null,Array(256)).map(function(H,P){return P}),c=function(H,P){return o.slice(H,P)},d=c(32,127),g=c(0,24);g.push(25),g.push.apply(g,c(28,32));var x,T=c(0,14);for(x in s.setDefault(1,0),s.addMany(d,0,2,0),T)s.addMany([24,26,153,154],x,3,0),s.addMany(c(128,144),x,3,0),s.addMany(c(144,152),x,3,0),s.add(156,x,0,0),s.add(27,x,11,1),s.add(157,x,4,8),s.addMany([152,158,159],x,0,7),s.add(155,x,11,3),s.add(144,x,11,9);return s.addMany(g,0,3,0),s.addMany(g,1,3,1),s.add(127,1,0,1),s.addMany(g,8,0,8),s.addMany(g,3,3,3),s.add(127,3,0,3),s.addMany(g,4,3,4),s.add(127,4,0,4),s.addMany(g,6,3,6),s.addMany(g,5,3,5),s.add(127,5,0,5),s.addMany(g,2,3,2),s.add(127,2,0,2),s.add(93,1,4,8),s.addMany(d,8,5,8),s.add(127,8,5,8),s.addMany([156,27,24,26,7],8,6,0),s.addMany(c(28,32),8,0,8),s.addMany([88,94,95],1,0,7),s.addMany(d,7,0,7),s.addMany(g,7,0,7),s.add(156,7,0,0),s.add(127,7,0,7),s.add(91,1,11,3),s.addMany(c(64,127),3,7,0),s.addMany(c(48,60),3,8,4),s.addMany([60,61,62,63],3,9,4),s.addMany(c(48,60),4,8,4),s.addMany(c(64,127),4,7,0),s.addMany([60,61,62,63],4,0,6),s.addMany(c(32,64),6,0,6),s.add(127,6,0,6),s.addMany(c(64,127),6,0,0),s.addMany(c(32,48),3,9,5),s.addMany(c(32,48),5,9,5),s.addMany(c(48,64),5,0,6),s.addMany(c(64,127),5,7,0),s.addMany(c(32,48),4,9,5),s.addMany(c(32,48),1,9,2),s.addMany(c(32,48),2,9,2),s.addMany(c(48,127),2,10,0),s.addMany(c(48,80),1,10,0),s.addMany(c(81,88),1,10,0),s.addMany([89,90,92],1,10,0),s.addMany(c(96,127),1,10,0),s.add(80,1,11,9),s.addMany(g,9,0,9),s.add(127,9,0,9),s.addMany(c(28,32),9,0,9),s.addMany(c(32,48),9,9,12),s.addMany(c(48,60),9,8,10),s.addMany([60,61,62,63],9,9,10),s.addMany(g,11,0,11),s.addMany(c(32,128),11,0,11),s.addMany(c(28,32),11,0,11),s.addMany(g,10,0,10),s.add(127,10,0,10),s.addMany(c(28,32),10,0,10),s.addMany(c(48,60),10,8,10),s.addMany([60,61,62,63],10,0,11),s.addMany(c(32,48),10,9,12),s.addMany(g,12,0,12),s.add(127,12,0,12),s.addMany(c(28,32),12,0,12),s.addMany(c(32,48),12,9,12),s.addMany(c(48,64),12,0,11),s.addMany(c(64,127),12,12,13),s.addMany(c(64,127),10,12,13),s.addMany(c(64,127),9,12,13),s.addMany(g,13,13,13),s.addMany(d,13,13,13),s.add(127,13,0,13),s.addMany([27,156,24,26],13,14,0),s.add(p,0,2,0),s.add(p,8,5,8),s.add(p,6,0,6),s.add(p,11,0,11),s.add(p,13,13,13),s}();var a=function(s){function o(c){c===void 0&&(c=h.VT500_TRANSITION_TABLE);var d=s.call(this)||this;return d._transitions=c,d._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},d.initialState=0,d.currentState=d.initialState,d._params=new b.Params,d._params.addParam(0),d._collect=0,d.precedingCodepoint=0,d._printHandlerFb=function(g,x,T){},d._executeHandlerFb=function(g){},d._csiHandlerFb=function(g,x){},d._escHandlerFb=function(g){},d._errorHandlerFb=function(g){return g},d._printHandler=d._printHandlerFb,d._executeHandlers=Object.create(null),d._csiHandlers=Object.create(null),d._escHandlers=Object.create(null),d._oscParser=new S.OscParser,d._dcsParser=new u.DcsParser,d._errorHandler=d._errorHandlerFb,d.registerEscHandler({final:"\\"},function(){return!0}),d}return y(o,s),o.prototype._identifier=function(c,d){d===void 0&&(d=[64,126]);var g=0;if(c.prefix){if(c.prefix.length>1)throw new Error("only one byte as prefix supported");if((g=c.prefix.charCodeAt(0))&&60>g||g>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(c.intermediates){if(c.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(var x=0;x<c.intermediates.length;++x){var T=c.intermediates.charCodeAt(x);if(32>T||T>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");g<<=8,g|=T}}if(c.final.length!==1)throw new Error("final must be a single byte");var H=c.final.charCodeAt(0);if(d[0]>H||H>d[1])throw new Error("final must be in range "+d[0]+" .. "+d[1]);return(g<<=8)|H},o.prototype.identToString=function(c){for(var d=[];c;)d.push(String.fromCharCode(255&c)),c>>=8;return d.reverse().join("")},o.prototype.dispose=function(){this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null),this._oscParser.dispose(),this._dcsParser.dispose()},o.prototype.setPrintHandler=function(c){this._printHandler=c},o.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},o.prototype.registerEscHandler=function(c,d){var g=this._identifier(c,[48,126]);this._escHandlers[g]===void 0&&(this._escHandlers[g]=[]);var x=this._escHandlers[g];return x.push(d),{dispose:function(){var T=x.indexOf(d);T!==-1&&x.splice(T,1)}}},o.prototype.clearEscHandler=function(c){this._escHandlers[this._identifier(c,[48,126])]&&delete this._escHandlers[this._identifier(c,[48,126])]},o.prototype.setEscHandlerFallback=function(c){this._escHandlerFb=c},o.prototype.setExecuteHandler=function(c,d){this._executeHandlers[c.charCodeAt(0)]=d},o.prototype.clearExecuteHandler=function(c){this._executeHandlers[c.charCodeAt(0)]&&delete this._executeHandlers[c.charCodeAt(0)]},o.prototype.setExecuteHandlerFallback=function(c){this._executeHandlerFb=c},o.prototype.registerCsiHandler=function(c,d){var g=this._identifier(c);this._csiHandlers[g]===void 0&&(this._csiHandlers[g]=[]);var x=this._csiHandlers[g];return x.push(d),{dispose:function(){var T=x.indexOf(d);T!==-1&&x.splice(T,1)}}},o.prototype.clearCsiHandler=function(c){this._csiHandlers[this._identifier(c)]&&delete this._csiHandlers[this._identifier(c)]},o.prototype.setCsiHandlerFallback=function(c){this._csiHandlerFb=c},o.prototype.registerDcsHandler=function(c,d){return this._dcsParser.registerHandler(this._identifier(c),d)},o.prototype.clearDcsHandler=function(c){this._dcsParser.clearHandler(this._identifier(c))},o.prototype.setDcsHandlerFallback=function(c){this._dcsParser.setHandlerFallback(c)},o.prototype.registerOscHandler=function(c,d){return this._oscParser.registerHandler(c,d)},o.prototype.clearOscHandler=function(c){this._oscParser.clearHandler(c)},o.prototype.setOscHandlerFallback=function(c){this._oscParser.setHandlerFallback(c)},o.prototype.setErrorHandler=function(c){this._errorHandler=c},o.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},o.prototype.reset=function(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])},o.prototype._preserveStack=function(c,d,g,x,T){this._parseStack.state=c,this._parseStack.handlers=d,this._parseStack.handlerPos=g,this._parseStack.transition=x,this._parseStack.chunkPos=T},o.prototype.parse=function(c,d,g){var x,T=0,H=0,P=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,P=this._parseStack.chunkPos+1;else{if(g===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");var M=this._parseStack.handlers,L=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(g===!1&&L>-1){for(;L>=0&&(x=M[L](this._params))!==!0;L--)if(x instanceof Promise)return this._parseStack.handlerPos=L,x}this._parseStack.handlers=[];break;case 4:if(g===!1&&L>-1){for(;L>=0&&(x=M[L]())!==!0;L--)if(x instanceof Promise)return this._parseStack.handlerPos=L,x}this._parseStack.handlers=[];break;case 6:if(T=c[this._parseStack.chunkPos],x=this._dcsParser.unhook(T!==24&&T!==26,g))return x;T===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(T=c[this._parseStack.chunkPos],x=this._oscParser.end(T!==24&&T!==26,g))return x;T===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,P=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(var D=P;D<d;++D){switch(T=c[D],(H=this._transitions.table[this.currentState<<8|(T<160?T:p)])>>4){case 2:for(var E=D+1;;++E){if(E>=d||(T=c[E])<32||T>126&&T<p){this._printHandler(c,D,E),D=E-1;break}if(++E>=d||(T=c[E])<32||T>126&&T<p){this._printHandler(c,D,E),D=E-1;break}if(++E>=d||(T=c[E])<32||T>126&&T<p){this._printHandler(c,D,E),D=E-1;break}if(++E>=d||(T=c[E])<32||T>126&&T<p){this._printHandler(c,D,E),D=E-1;break}}break;case 3:this._executeHandlers[T]?this._executeHandlers[T]():this._executeHandlerFb(T),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:D,code:T,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:for(var Y=(M=this._csiHandlers[this._collect<<8|T])?M.length-1:-1;Y>=0&&(x=M[Y](this._params))!==!0;Y--)if(x instanceof Promise)return this._preserveStack(3,M,Y,H,D),x;Y<0&&this._csiHandlerFb(this._collect<<8|T,this._params),this.precedingCodepoint=0;break;case 8:do switch(T){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(T-48)}while(++D<d&&(T=c[D])>47&&T<60);D--;break;case 9:this._collect<<=8,this._collect|=T;break;case 10:for(var j=this._escHandlers[this._collect<<8|T],I=j?j.length-1:-1;I>=0&&(x=j[I]())!==!0;I--)if(x instanceof Promise)return this._preserveStack(4,j,I,H,D),x;I<0&&this._escHandlerFb(this._collect<<8|T),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|T,this._params);break;case 13:for(var F=D+1;;++F)if(F>=d||(T=c[F])===24||T===26||T===27||T>127&&T<p){this._dcsParser.put(c,D,F),D=F-1;break}break;case 14:if(x=this._dcsParser.unhook(T!==24&&T!==26))return this._preserveStack(6,[],0,H,D),x;T===27&&(H|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(var K=D+1;;K++)if(K>=d||(T=c[K])<32||T>127&&T<p){this._oscParser.put(c,D,K),D=K-1;break}break;case 6:if(x=this._oscParser.end(T!==24&&T!==26))return this._preserveStack(5,[],0,H,D),x;T===27&&(H|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&H}},o}(w.Disposable);h.EscapeSequenceParser=a},6242:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.OscHandler=h.OscParser=void 0;var v=k(5770),y=k(482),w=[],m=function(){function S(){this._state=0,this._active=w,this._id=-1,this._handlers=Object.create(null),this._handlerFb=function(){},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}return S.prototype.registerHandler=function(u,f){this._handlers[u]===void 0&&(this._handlers[u]=[]);var p=this._handlers[u];return p.push(f),{dispose:function(){var a=p.indexOf(f);a!==-1&&p.splice(a,1)}}},S.prototype.clearHandler=function(u){this._handlers[u]&&delete this._handlers[u]},S.prototype.setHandlerFallback=function(u){this._handlerFb=u},S.prototype.dispose=function(){this._handlers=Object.create(null),this._handlerFb=function(){},this._active=w},S.prototype.reset=function(){if(this._state===2)for(var u=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;u>=0;--u)this._active[u].end(!1);this._stack.paused=!1,this._active=w,this._id=-1,this._state=0},S.prototype._start=function(){if(this._active=this._handlers[this._id]||w,this._active.length)for(var u=this._active.length-1;u>=0;u--)this._active[u].start();else this._handlerFb(this._id,"START")},S.prototype._put=function(u,f,p){if(this._active.length)for(var a=this._active.length-1;a>=0;a--)this._active[a].put(u,f,p);else this._handlerFb(this._id,"PUT",(0,y.utf32ToString)(u,f,p))},S.prototype.start=function(){this.reset(),this._state=1},S.prototype.put=function(u,f,p){if(this._state!==3){if(this._state===1)for(;f<p;){var a=u[f++];if(a===59){this._state=2,this._start();break}if(a<48||57<a)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+a-48}this._state===2&&p-f>0&&this._put(u,f,p)}},S.prototype.end=function(u,f){if(f===void 0&&(f=!0),this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){var p=!1,a=this._active.length-1,s=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,p=f,s=this._stack.fallThrough,this._stack.paused=!1),!s&&p===!1){for(;a>=0&&(p=this._active[a].end(u))!==!0;a--)if(p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,p;a--}for(;a>=0;a--)if((p=this._active[a].end(!1))instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,p}else this._handlerFb(this._id,"END",u);this._active=w,this._id=-1,this._state=0}},S}();h.OscParser=m;var b=function(){function S(u){this._handler=u,this._data="",this._hitLimit=!1}return S.prototype.start=function(){this._data="",this._hitLimit=!1},S.prototype.put=function(u,f,p){this._hitLimit||(this._data+=(0,y.utf32ToString)(u,f,p),this._data.length>v.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))},S.prototype.end=function(u){var f=this,p=!1;if(this._hitLimit)p=!1;else if(u&&(p=this._handler(this._data))instanceof Promise)return p.then(function(a){return f._data="",f._hitLimit=!1,a});return this._data="",this._hitLimit=!1,p},S}();h.OscHandler=b},8742:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.Params=void 0;var k=2147483647,v=function(){function y(w,m){if(w===void 0&&(w=32),m===void 0&&(m=32),this.maxLength=w,this.maxSubParamsLength=m,m>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(w),this.length=0,this._subParams=new Int32Array(m),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(w),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}return y.fromArray=function(w){var m=new y;if(!w.length)return m;for(var b=Array.isArray(w[0])?1:0;b<w.length;++b){var S=w[b];if(Array.isArray(S))for(var u=0;u<S.length;++u)m.addSubParam(S[u]);else m.addParam(S)}return m},y.prototype.clone=function(){var w=new y(this.maxLength,this.maxSubParamsLength);return w.params.set(this.params),w.length=this.length,w._subParams.set(this._subParams),w._subParamsLength=this._subParamsLength,w._subParamsIdx.set(this._subParamsIdx),w._rejectDigits=this._rejectDigits,w._rejectSubDigits=this._rejectSubDigits,w._digitIsSub=this._digitIsSub,w},y.prototype.toArray=function(){for(var w=[],m=0;m<this.length;++m){w.push(this.params[m]);var b=this._subParamsIdx[m]>>8,S=255&this._subParamsIdx[m];S-b>0&&w.push(Array.prototype.slice.call(this._subParams,b,S))}return w},y.prototype.reset=function(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1},y.prototype.addParam=function(w){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(w<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=w>k?k:w}},y.prototype.addSubParam=function(w){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(w<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=w>k?k:w,this._subParamsIdx[this.length-1]++}},y.prototype.hasSubParams=function(w){return(255&this._subParamsIdx[w])-(this._subParamsIdx[w]>>8)>0},y.prototype.getSubParams=function(w){var m=this._subParamsIdx[w]>>8,b=255&this._subParamsIdx[w];return b-m>0?this._subParams.subarray(m,b):null},y.prototype.getSubParamsAll=function(){for(var w={},m=0;m<this.length;++m){var b=this._subParamsIdx[m]>>8,S=255&this._subParamsIdx[m];S-b>0&&(w[m]=this._subParams.slice(b,S))}return w},y.prototype.addDigit=function(w){var m;if(!(this._rejectDigits||!(m=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)){var b=this._digitIsSub?this._subParams:this.params,S=b[m-1];b[m-1]=~S?Math.min(10*S+w,k):w}},y}();h.Params=v},5741:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.AddonManager=void 0;var k=function(){function v(){this._addons=[]}return v.prototype.dispose=function(){for(var y=this._addons.length-1;y>=0;y--)this._addons[y].instance.dispose()},v.prototype.loadAddon=function(y,w){var m=this,b={instance:w,dispose:w.dispose,isDisposed:!1};this._addons.push(b),w.dispose=function(){return m._wrappedAddonDispose(b)},w.activate(y)},v.prototype._wrappedAddonDispose=function(y){if(!y.isDisposed){for(var w=-1,m=0;m<this._addons.length;m++)if(this._addons[m]===y){w=m;break}if(w===-1)throw new Error("Could not dispose an addon that has not been loaded");y.isDisposed=!0,y.dispose.apply(y.instance),this._addons.splice(w,1)}},v}();h.AddonManager=k},8771:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BufferApiView=void 0;var v=k(3785),y=k(511),w=function(){function m(b,S){this._buffer=b,this.type=S}return m.prototype.init=function(b){return this._buffer=b,this},Object.defineProperty(m.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!1,configurable:!0}),m.prototype.getLine=function(b){var S=this._buffer.lines.get(b);if(S)return new v.BufferLineApiView(S)},m.prototype.getNullCell=function(){return new y.CellData},m}();h.BufferApiView=w},3785:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BufferLineApiView=void 0;var v=k(511),y=function(){function w(m){this._line=m}return Object.defineProperty(w.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"length",{get:function(){return this._line.length},enumerable:!1,configurable:!0}),w.prototype.getCell=function(m,b){if(!(m<0||m>=this._line.length))return b?(this._line.loadCell(m,b),b):this._line.loadCell(m,new v.CellData)},w.prototype.translateToString=function(m,b,S){return this._line.translateToString(m,b,S)},w}();h.BufferLineApiView=y},8285:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.BufferNamespaceApi=void 0;var v=k(8771),y=k(8460),w=function(){function m(b){var S=this;this._core=b,this._onBufferChange=new y.EventEmitter,this._normal=new v.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new v.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(function(){return S._onBufferChange.fire(S.active)})}return Object.defineProperty(m.prototype,"onBufferChange",{get:function(){return this._onBufferChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"active",{get:function(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"normal",{get:function(){return this._normal.init(this._core.buffers.normal)},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"alternate",{get:function(){return this._alternate.init(this._core.buffers.alt)},enumerable:!1,configurable:!0}),m}();h.BufferNamespaceApi=w},7975:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.ParserApi=void 0;var k=function(){function v(y){this._core=y}return v.prototype.registerCsiHandler=function(y,w){return this._core.registerCsiHandler(y,function(m){return w(m.toArray())})},v.prototype.addCsiHandler=function(y,w){return this.registerCsiHandler(y,w)},v.prototype.registerDcsHandler=function(y,w){return this._core.registerDcsHandler(y,function(m,b){return w(m,b.toArray())})},v.prototype.addDcsHandler=function(y,w){return this.registerDcsHandler(y,w)},v.prototype.registerEscHandler=function(y,w){return this._core.registerEscHandler(y,w)},v.prototype.addEscHandler=function(y,w){return this.registerEscHandler(y,w)},v.prototype.registerOscHandler=function(y,w){return this._core.registerOscHandler(y,w)},v.prototype.addOscHandler=function(y,w){return this.registerOscHandler(y,w)},v}();h.ParserApi=k},7090:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.UnicodeApi=void 0;var k=function(){function v(y){this._core=y}return v.prototype.register=function(y){this._core.unicodeService.register(y)},Object.defineProperty(v.prototype,"versions",{get:function(){return this._core.unicodeService.versions},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"activeVersion",{get:function(){return this._core.unicodeService.activeVersion},set:function(y){this._core.unicodeService.activeVersion=y},enumerable:!1,configurable:!0}),v}();h.UnicodeApi=k},744:function($,h,k){var v,y=this&&this.__extends||(v=function(a,s){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(o[d]=c[d])},v(a,s)},function(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");function o(){this.constructor=a}v(a,s),a.prototype=s===null?Object.create(s):(o.prototype=s.prototype,new o)}),w=this&&this.__decorate||function(a,s,o,c){var d,g=arguments.length,x=g<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(a,s,o,c);else for(var T=a.length-1;T>=0;T--)(d=a[T])&&(x=(g<3?d(x):g>3?d(s,o,x):d(s,o))||x);return g>3&&x&&Object.defineProperty(s,o,x),x},m=this&&this.__param||function(a,s){return function(o,c){s(o,c,a)}};Object.defineProperty(h,"__esModule",{value:!0}),h.BufferService=h.MINIMUM_ROWS=h.MINIMUM_COLS=void 0;var b=k(2585),S=k(5295),u=k(8460),f=k(844);h.MINIMUM_COLS=2,h.MINIMUM_ROWS=1;var p=function(a){function s(o){var c=a.call(this)||this;return c._optionsService=o,c.isUserScrolling=!1,c._onResize=new u.EventEmitter,c._onScroll=new u.EventEmitter,c.cols=Math.max(o.options.cols||0,h.MINIMUM_COLS),c.rows=Math.max(o.options.rows||0,h.MINIMUM_ROWS),c.buffers=new S.BufferSet(o,c),c}return y(s,a),Object.defineProperty(s.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!1,configurable:!0}),s.prototype.dispose=function(){a.prototype.dispose.call(this),this.buffers.dispose()},s.prototype.resize=function(o,c){this.cols=o,this.rows=c,this.buffers.resize(o,c),this.buffers.setupTabStops(this.cols),this._onResize.fire({cols:o,rows:c})},s.prototype.reset=function(){this.buffers.reset(),this.isUserScrolling=!1},s.prototype.scroll=function(o,c){c===void 0&&(c=!1);var d,g=this.buffer;(d=this._cachedBlankLine)&&d.length===this.cols&&d.getFg(0)===o.fg&&d.getBg(0)===o.bg||(d=g.getBlankLine(o,c),this._cachedBlankLine=d),d.isWrapped=c;var x=g.ybase+g.scrollTop,T=g.ybase+g.scrollBottom;if(g.scrollTop===0){var H=g.lines.isFull;T===g.lines.length-1?H?g.lines.recycle().copyFrom(d):g.lines.push(d.clone()):g.lines.splice(T+1,0,d.clone()),H?this.isUserScrolling&&(g.ydisp=Math.max(g.ydisp-1,0)):(g.ybase++,this.isUserScrolling||g.ydisp++)}else{var P=T-x+1;g.lines.shiftElements(x+1,P-1,-1),g.lines.set(T,d.clone())}this.isUserScrolling||(g.ydisp=g.ybase),this._onScroll.fire(g.ydisp)},s.prototype.scrollLines=function(o,c,d){var g=this.buffer;if(o<0){if(g.ydisp===0)return;this.isUserScrolling=!0}else o+g.ydisp>=g.ybase&&(this.isUserScrolling=!1);var x=g.ydisp;g.ydisp=Math.max(Math.min(g.ydisp+o,g.ybase),0),x!==g.ydisp&&(c||this._onScroll.fire(g.ydisp))},s.prototype.scrollPages=function(o){this.scrollLines(o*(this.rows-1))},s.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},s.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},s.prototype.scrollToLine=function(o){var c=o-this.buffer.ydisp;c!==0&&this.scrollLines(c)},w([m(0,b.IOptionsService)],s)}(f.Disposable);h.BufferService=p},7994:($,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.CharsetService=void 0;var k=function(){function v(){this.glevel=0,this._charsets=[]}return v.prototype.reset=function(){this.charset=void 0,this._charsets=[],this.glevel=0},v.prototype.setgLevel=function(y){this.glevel=y,this.charset=this._charsets[y]},v.prototype.setgCharset=function(y,w){this._charsets[y]=w,this.glevel===y&&(this.charset=w)},v}();h.CharsetService=k},1753:function($,h,k){var v=this&&this.__decorate||function(a,s,o,c){var d,g=arguments.length,x=g<3?s:c===null?c=Object.getOwnPropertyDescriptor(s,o):c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(a,s,o,c);else for(var T=a.length-1;T>=0;T--)(d=a[T])&&(x=(g<3?d(x):g>3?d(s,o,x):d(s,o))||x);return g>3&&x&&Object.defineProperty(s,o,x),x},y=this&&this.__param||function(a,s){return function(o,c){s(o,c,a)}};Object.defineProperty(h,"__esModule",{value:!0}),h.CoreMouseService=void 0;var w=k(2585),m=k(8460),b={NONE:{events:0,restrict:function(){return!1}},X10:{events:1,restrict:function(a){return a.button!==4&&a.action===1&&(a.ctrl=!1,a.alt=!1,a.shift=!1,!0)}},VT200:{events:19,restrict:function(a){return a.action!==32}},DRAG:{events:23,restrict:function(a){return a.action!==32||a.button!==3}},ANY:{events:31,restrict:function(a){return!0}}};function S(a,s){var o=(a.ctrl?16:0)|(a.shift?4:0)|(a.alt?8:0);return a.button===4?(o|=64,o|=a.action):(o|=3&a.button,4&a.button&&(o|=64),8&a.button&&(o|=128),a.action===32?o|=32:a.action!==0||s||(o|=3)),o}var u=String.fromCharCode,f={DEFAULT:function(a){var s=[S(a,!1)+32,a.col+32,a.row+32];return s[0]>255||s[1]>255||s[2]>255?"":"[M"+u(s[0])+u(s[1])+u(s[2])},SGR:function(a){var s=a.action===0&&a.button!==4?"m":"M";return"[<"+S(a,!0)+";"+a.col+";"+a.row+s}},p=function(){function a(s,o){this._bufferService=s,this._coreService=o,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._onProtocolChange=new m.EventEmitter,this._lastEvent=null;for(var c=0,d=Object.keys(b);c<d.length;c++){var g=d[c];this.addProtocol(g,b[g])}for(var x=0,T=Object.keys(f);x<T.length;x++){var H=T[x];this.addEncoding(H,f[H])}this.reset()}return a.prototype.addProtocol=function(s,o){this._protocols[s]=o},a.prototype.addEncoding=function(s,o){this._encodings[s]=o},Object.defineProperty(a.prototype,"activeProtocol",{get:function(){return this._activeProtocol},set:function(s){if(!this._protocols[s])throw new Error('unknown protocol "'+s+'"');this._activeProtocol=s,this._onProtocolChange.fire(this._protocols[s].events)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"areMouseEventsActive",{get:function(){return this._protocols[this._activeProtocol].events!==0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"activeEncoding",{get:function(){return this._activeEncoding},set:function(s){if(!this._encodings[s])throw new Error('unknown encoding "'+s+'"');this._activeEncoding=s},enumerable:!1,configurable:!0}),a.prototype.reset=function(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null},Object.defineProperty(a.prototype,"onProtocolChange",{get:function(){return this._onProtocolChange.event},enumerable:!1,configurable:!0}),a.prototype.triggerMouseEvent=function(s){if(s.col<0||s.col>=this._bufferService.cols||s.row<0||s.row>=this._bufferService.rows||s.button===4&&s.action===32||s.button===3&&s.action!==32||s.button!==4&&(s.action===2||s.action===3)||(s.col++,s.row++,s.action===32&&this._lastEvent&&this._compareEvents(this._lastEvent,s))||!this._protocols[this._activeProtocol].restrict(s))return!1;var o=this._encodings[this._activeEncoding](s);return o&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(o):this._coreService.triggerDataEvent(o,!0)),this._lastEvent=s,!0},a.prototype.explainEvents=function(s){return{down:!!(1&s),up:!!(2&s),drag:!!(4&s),move:!!(8&s),wheel:!!(16&s)}},a.prototype._compareEvents=function(s,o){return s.col===o.col&&s.row===o.row&&s.button===o.button&&s.action===o.action&&s.ctrl===o.ctrl&&s.alt===o.alt&&s.shift===o.shift},v([y(0,w.IBufferService),y(1,w.ICoreService)],a)}();h.CoreMouseService=p},6975:function($,h,k){var v,y=this&&this.__extends||(v=function(o,c){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,g){d.__proto__=g}||function(d,g){for(var x in g)Object.prototype.hasOwnProperty.call(g,x)&&(d[x]=g[x])},v(o,c)},function(o,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");function d(){this.constructor=o}v(o,c),o.prototype=c===null?Object.create(c):(d.prototype=c.prototype,new d)}),w=this&&this.__decorate||function(o,c,d,g){var x,T=arguments.length,H=T<3?c:g===null?g=Object.getOwnPropertyDescriptor(c,d):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(o,c,d,g);else for(var P=o.length-1;P>=0;P--)(x=o[P])&&(H=(T<3?x(H):T>3?x(c,d,H):x(c,d))||H);return T>3&&H&&Object.defineProperty(c,d,H),H},m=this&&this.__param||function(o,c){return function(d,g){c(d,g,o)}};Object.defineProperty(h,"__esModule",{value:!0}),h.CoreService=void 0;var b=k(2585),S=k(8460),u=k(1439),f=k(844),p=Object.freeze({insertMode:!1}),a=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),s=function(o){function c(d,g,x,T){var H=o.call(this)||this;return H._bufferService=g,H._logService=x,H._optionsService=T,H.isCursorInitialized=!1,H.isCursorHidden=!1,H._onData=H.register(new S.EventEmitter),H._onUserInput=H.register(new S.EventEmitter),H._onBinary=H.register(new S.EventEmitter),H._scrollToBottom=d,H.register({dispose:function(){return H._scrollToBottom=void 0}}),H.modes=(0,u.clone)(p),H.decPrivateModes=(0,u.clone)(a),H}return y(c,o),Object.defineProperty(c.prototype,"onData",{get:function(){return this._onData.event},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onUserInput",{get:function(){return this._onUserInput.event},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"onBinary",{get:function(){return this._onBinary.event},enumerable:!1,configurable:!0}),c.prototype.reset=function(){this.modes=(0,u.clone)(p),this.decPrivateModes=(0,u.clone)(a)},c.prototype.triggerDataEvent=function(d,g){if(g===void 0&&(g=!1),!this._optionsService.options.disableStdin){var x=this._bufferService.buffer;x.ybase!==x.ydisp&&this._scrollToBottom(),g&&this._onUserInput.fire(),this._logService.debug('sending data "'+d+'"',function(){return d.split("").map(function(T){return T.charCodeAt(0)})}),this._onData.fire(d)}},c.prototype.triggerBinaryEvent=function(d){this._optionsService.options.disableStdin||(this._logService.debug('sending binary "'+d+'"',function(){return d.split("").map(function(g){return g.charCodeAt(0)})}),this._onBinary.fire(d))},w([m(1,b.IBufferService),m(2,b.ILogService),m(3,b.IOptionsService)],c)}(f.Disposable);h.CoreService=s},3730:function($,h,k){var v=this&&this.__decorate||function(b,S,u,f){var p,a=arguments.length,s=a<3?S:f===null?f=Object.getOwnPropertyDescriptor(S,u):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(b,S,u,f);else for(var o=b.length-1;o>=0;o--)(p=b[o])&&(s=(a<3?p(s):a>3?p(S,u,s):p(S,u))||s);return a>3&&s&&Object.defineProperty(S,u,s),s},y=this&&this.__param||function(b,S){return function(u,f){S(u,f,b)}};Object.defineProperty(h,"__esModule",{value:!0}),h.DirtyRowService=void 0;var w=k(2585),m=function(){function b(S){this._bufferService=S,this.clearRange()}return Object.defineProperty(b.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"end",{get:function(){return this._end},enumerable:!1,configurable:!0}),b.prototype.clearRange=function(){this._start=this._bufferService.buffer.y,this._end=this._bufferService.buffer.y},b.prototype.markDirty=function(S){S<this._start?this._start=S:S>this._end&&(this._end=S)},b.prototype.markRangeDirty=function(S,u){if(S>u){var f=S;S=u,u=f}S<this._start&&(this._start=S),u>this._end&&(this._end=u)},b.prototype.markAllDirty=function(){this.markRangeDirty(0,this._bufferService.rows-1)},v([y(0,w.IBufferService)],b)}();h.DirtyRowService=m},4348:function($,h,k){var v=this&&this.__spreadArray||function(S,u,f){if(f||arguments.length===2)for(var p,a=0,s=u.length;a<s;a++)!p&&a in u||(p||(p=Array.prototype.slice.call(u,0,a)),p[a]=u[a]);return S.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(h,"__esModule",{value:!0}),h.InstantiationService=h.ServiceCollection=void 0;var y=k(2585),w=k(8343),m=function(){function S(){for(var u=[],f=0;f<arguments.length;f++)u[f]=arguments[f];this._entries=new Map;for(var p=0,a=u;p<a.length;p++){var s=a[p],o=s[0],c=s[1];this.set(o,c)}}return S.prototype.set=function(u,f){var p=this._entries.get(u);return this._entries.set(u,f),p},S.prototype.forEach=function(u){this._entries.forEach(function(f,p){return u(p,f)})},S.prototype.has=function(u){return this._entries.has(u)},S.prototype.get=function(u){return this._entries.get(u)},S}();h.ServiceCollection=m;var b=function(){function S(){this._services=new m,this._services.set(y.IInstantiationService,this)}return S.prototype.setService=function(u,f){this._services.set(u,f)},S.prototype.getService=function(u){return this._services.get(u)},S.prototype.createInstance=function(u){for(var f=[],p=1;p<arguments.length;p++)f[p-1]=arguments[p];for(var a=(0,w.getServiceDependencies)(u).sort(function(T,H){return T.index-H.index}),s=[],o=0,c=a;o<c.length;o++){var d=c[o],g=this._services.get(d.id);if(!g)throw new Error("[createInstance] "+u.name+" depends on UNKNOWN service "+d.id+".");s.push(g)}var x=a.length>0?a[0].index:f.length;if(f.length!==x)throw new Error("[createInstance] First service dependency of "+u.name+" at position "+(x+1)+" conflicts with "+f.length+" static arguments");return new(u.bind.apply(u,v([void 0],v(v([],f,!0),s,!0),!1)))},S}();h.InstantiationService=b},7866:function($,h,k){var v=this&&this.__decorate||function(u,f,p,a){var s,o=arguments.length,c=o<3?f:a===null?a=Object.getOwnPropertyDescriptor(f,p):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(u,f,p,a);else for(var d=u.length-1;d>=0;d--)(s=u[d])&&(c=(o<3?s(c):o>3?s(f,p,c):s(f,p))||c);return o>3&&c&&Object.defineProperty(f,p,c),c},y=this&&this.__param||function(u,f){return function(p,a){f(p,a,u)}},w=this&&this.__spreadArray||function(u,f,p){if(p||arguments.length===2)for(var a,s=0,o=f.length;s<o;s++)!a&&s in f||(a||(a=Array.prototype.slice.call(f,0,s)),a[s]=f[s]);return u.concat(a||Array.prototype.slice.call(f))};Object.defineProperty(h,"__esModule",{value:!0}),h.LogService=void 0;var m=k(2585),b={debug:m.LogLevelEnum.DEBUG,info:m.LogLevelEnum.INFO,warn:m.LogLevelEnum.WARN,error:m.LogLevelEnum.ERROR,off:m.LogLevelEnum.OFF},S=function(){function u(f){var p=this;this._optionsService=f,this.logLevel=m.LogLevelEnum.OFF,this._updateLogLevel(),this._optionsService.onOptionChange(function(a){a==="logLevel"&&p._updateLogLevel()})}return u.prototype._updateLogLevel=function(){this.logLevel=b[this._optionsService.options.logLevel]},u.prototype._evalLazyOptionalParams=function(f){for(var p=0;p<f.length;p++)typeof f[p]=="function"&&(f[p]=f[p]())},u.prototype._log=function(f,p,a){this._evalLazyOptionalParams(a),f.call.apply(f,w([console,"xterm.js: "+p],a,!1))},u.prototype.debug=function(f){for(var p=[],a=1;a<arguments.length;a++)p[a-1]=arguments[a];this.logLevel<=m.LogLevelEnum.DEBUG&&this._log(console.log,f,p)},u.prototype.info=function(f){for(var p=[],a=1;a<arguments.length;a++)p[a-1]=arguments[a];this.logLevel<=m.LogLevelEnum.INFO&&this._log(console.info,f,p)},u.prototype.warn=function(f){for(var p=[],a=1;a<arguments.length;a++)p[a-1]=arguments[a];this.logLevel<=m.LogLevelEnum.WARN&&this._log(console.warn,f,p)},u.prototype.error=function(f){for(var p=[],a=1;a<arguments.length;a++)p[a-1]=arguments[a];this.logLevel<=m.LogLevelEnum.ERROR&&this._log(console.error,f,p)},v([y(0,m.IOptionsService)],u)}();h.LogService=S},7302:function($,h,k){var v=this&&this.__assign||function(){return v=Object.assign||function(S){for(var u,f=1,p=arguments.length;f<p;f++)for(var a in u=arguments[f])Object.prototype.hasOwnProperty.call(u,a)&&(S[a]=u[a]);return S},v.apply(this,arguments)};Object.defineProperty(h,"__esModule",{value:!0}),h.OptionsService=h.DEFAULT_OPTIONS=h.DEFAULT_BELL_SOUND=void 0;var y=k(8460),w=k(6114);h.DEFAULT_BELL_SOUND="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjMyLjEwNAAAAAAAAAAAAAAA//tQxAADB8AhSmxhIIEVCSiJrDCQBTcu3UrAIwUdkRgQbFAZC1CQEwTJ9mjRvBA4UOLD8nKVOWfh+UlK3z/177OXrfOdKl7pyn3Xf//WreyTRUoAWgBgkOAGbZHBgG1OF6zM82DWbZaUmMBptgQhGjsyYqc9ae9XFz280948NMBWInljyzsNRFLPWdnZGWrddDsjK1unuSrVN9jJsK8KuQtQCtMBjCEtImISdNKJOopIpBFpNSMbIHCSRpRR5iakjTiyzLhchUUBwCgyKiweBv/7UsQbg8isVNoMPMjAAAA0gAAABEVFGmgqK////9bP/6XCykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",h.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,bellSound:h.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,linkTooltipHoverDuration:500,letterSpacing:0,logLevel:"info",scrollback:1e3,scrollSensitivity:1,screenReaderMode:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!0,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:w.isMac,rendererType:"canvas",windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1};var m=["normal","bold","100","200","300","400","500","600","700","800","900"],b=function(){function S(u){for(var f in this._onOptionChange=new y.EventEmitter,this._options=v({},h.DEFAULT_OPTIONS),u)if(f in this._options)try{var p=u[f];this._options[f]=this._sanitizeAndValidateOption(f,p)}catch(a){console.error(a)}this.options=this._setupOptions(this._options)}return Object.defineProperty(S.prototype,"onOptionChange",{get:function(){return this._onOptionChange.event},enumerable:!1,configurable:!0}),S.prototype._setupOptions=function(u){var f=this,p=v({},u),a=function(o){Object.defineProperty(p,o,{get:function(){if(!(o in h.DEFAULT_OPTIONS))throw new Error('No option with key "'+o+'"');return f._options[o]},set:function(c){if(!(o in h.DEFAULT_OPTIONS))throw new Error('No option with key "'+o+'"');c=f._sanitizeAndValidateOption(o,c),f._options[o]!==c&&(f._options[o]=c,f._onOptionChange.fire(o))}})};for(var s in p)a(s);return p},S.prototype.setOption=function(u,f){this.options[u]=f},S.prototype._sanitizeAndValidateOption=function(u,f){switch(u){case"bellStyle":case"cursorStyle":case"rendererType":case"wordSeparator":f||(f=h.DEFAULT_OPTIONS[u]);break;case"fontWeight":case"fontWeightBold":if(typeof f=="number"&&1<=f&&f<=1e3)break;f=m.includes(f)?f:h.DEFAULT_OPTIONS[u];break;case"cursorWidth":f=Math.floor(f);case"lineHeight":case"tabStopWidth":if(f<1)throw new Error(u+" cannot be less than 1, value: "+f);break;case"minimumContrastRatio":f=Math.max(1,Math.min(21,Math.round(10*f)/10));break;case"scrollback":if((f=Math.min(f,4294967295))<0)throw new Error(u+" cannot be less than 0, value: "+f);break;case"fastScrollSensitivity":case"scrollSensitivity":if(f<=0)throw new Error(u+" cannot be less than or equal to 0, value: "+f);case"rows":case"cols":if(!f&&f!==0)throw new Error(u+" must be numeric, value: "+f)}return f},S.prototype.getOption=function(u){return this.options[u]},S}();h.OptionsService=b},8343:($,h)=>{function k(v,y,w){y.di$target===y?y.di$dependencies.push({id:v,index:w}):(y.di$dependencies=[{id:v,index:w}],y.di$target=y)}Object.defineProperty(h,"__esModule",{value:!0}),h.createDecorator=h.getServiceDependencies=h.serviceRegistry=void 0,h.serviceRegistry=new Map,h.getServiceDependencies=function(v){return v.di$dependencies||[]},h.createDecorator=function(v){if(h.serviceRegistry.has(v))return h.serviceRegistry.get(v);var y=function(w,m,b){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");k(y,w,b)};return y.toString=function(){return v},h.serviceRegistry.set(v,y),y}},2585:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.IUnicodeService=h.IOptionsService=h.ILogService=h.LogLevelEnum=h.IInstantiationService=h.IDirtyRowService=h.ICharsetService=h.ICoreService=h.ICoreMouseService=h.IBufferService=void 0;var v,y=k(8343);h.IBufferService=(0,y.createDecorator)("BufferService"),h.ICoreMouseService=(0,y.createDecorator)("CoreMouseService"),h.ICoreService=(0,y.createDecorator)("CoreService"),h.ICharsetService=(0,y.createDecorator)("CharsetService"),h.IDirtyRowService=(0,y.createDecorator)("DirtyRowService"),h.IInstantiationService=(0,y.createDecorator)("InstantiationService"),(v=h.LogLevelEnum||(h.LogLevelEnum={}))[v.DEBUG=0]="DEBUG",v[v.INFO=1]="INFO",v[v.WARN=2]="WARN",v[v.ERROR=3]="ERROR",v[v.OFF=4]="OFF",h.ILogService=(0,y.createDecorator)("LogService"),h.IOptionsService=(0,y.createDecorator)("OptionsService"),h.IUnicodeService=(0,y.createDecorator)("UnicodeService")},1480:($,h,k)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.UnicodeService=void 0;var v=k(8460),y=k(225),w=function(){function m(){this._providers=Object.create(null),this._active="",this._onChange=new v.EventEmitter;var b=new y.UnicodeV6;this.register(b),this._active=b.version,this._activeProvider=b}return Object.defineProperty(m.prototype,"onChange",{get:function(){return this._onChange.event},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"versions",{get:function(){return Object.keys(this._providers)},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"activeVersion",{get:function(){return this._active},set:function(b){if(!this._providers[b])throw new Error('unknown Unicode version "'+b+'"');this._active=b,this._activeProvider=this._providers[b],this._onChange.fire(b)},enumerable:!1,configurable:!0}),m.prototype.register=function(b){this._providers[b.version]=b},m.prototype.wcwidth=function(b){return this._activeProvider.wcwidth(b)},m.prototype.getStringCellWidth=function(b){for(var S=0,u=b.length,f=0;f<u;++f){var p=b.charCodeAt(f);if(55296<=p&&p<=56319){if(++f>=u)return S+this.wcwidth(p);var a=b.charCodeAt(f);56320<=a&&a<=57343?p=1024*(p-55296)+a-56320+65536:S+=this.wcwidth(a)}S+=this.wcwidth(p)}return S},m}();h.UnicodeService=w}},V={};function Q($){var h=V[$];if(h!==void 0)return h.exports;var k=V[$]={exports:{}};return oe[$].call(k.exports,k,k.exports,Q),k.exports}var ve={};return(()=>{var $=ve;Object.defineProperty($,"__esModule",{value:!0}),$.Terminal=void 0;var h=Q(3236),k=Q(9042),v=Q(7975),y=Q(7090),w=Q(5741),m=Q(8285),b=["cols","rows"],S=function(){function u(f){var p=this;this._core=new h.Terminal(f),this._addonManager=new w.AddonManager,this._publicOptions={};var a=function(c){Object.defineProperty(s._publicOptions,c,{get:function(){return p._core.options[c]},set:function(d){p._checkReadonlyOptions(c),p._core.options[c]=d}})},s=this;for(var o in this._core.options)a(o)}return u.prototype._checkReadonlyOptions=function(f){if(b.includes(f))throw new Error('Option "'+f+'" can only be set in the constructor')},u.prototype._checkProposedApi=function(){if(!this._core.optionsService.options.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")},Object.defineProperty(u.prototype,"onBell",{get:function(){return this._core.onBell},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onBinary",{get:function(){return this._core.onBinary},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onData",{get:function(){return this._core.onData},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"element",{get:function(){return this._core.element},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"parser",{get:function(){return this._checkProposedApi(),this._parser||(this._parser=new v.ParserApi(this._core)),this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"unicode",{get:function(){return this._checkProposedApi(),new y.UnicodeApi(this._core)},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"rows",{get:function(){return this._core.rows},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"cols",{get:function(){return this._core.cols},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"buffer",{get:function(){return this._checkProposedApi(),this._buffer||(this._buffer=new m.BufferNamespaceApi(this._core)),this._buffer},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"markers",{get:function(){return this._checkProposedApi(),this._core.markers},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"modes",{get:function(){var f=this._core.coreService.decPrivateModes,p="none";switch(this._core.coreMouseService.activeProtocol){case"X10":p="x10";break;case"VT200":p="vt200";break;case"DRAG":p="drag";break;case"ANY":p="any"}return{applicationCursorKeysMode:f.applicationCursorKeys,applicationKeypadMode:f.applicationKeypad,bracketedPasteMode:f.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:p,originMode:f.origin,reverseWraparoundMode:f.reverseWraparound,sendFocusMode:f.sendFocus,wraparoundMode:f.wraparound}},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"options",{get:function(){return this._publicOptions},set:function(f){for(var p in f)this._publicOptions[p]=f[p]},enumerable:!1,configurable:!0}),u.prototype.blur=function(){this._core.blur()},u.prototype.focus=function(){this._core.focus()},u.prototype.resize=function(f,p){this._verifyIntegers(f,p),this._core.resize(f,p)},u.prototype.open=function(f){this._core.open(f)},u.prototype.attachCustomKeyEventHandler=function(f){this._core.attachCustomKeyEventHandler(f)},u.prototype.registerLinkMatcher=function(f,p,a){return this._checkProposedApi(),this._core.registerLinkMatcher(f,p,a)},u.prototype.deregisterLinkMatcher=function(f){this._checkProposedApi(),this._core.deregisterLinkMatcher(f)},u.prototype.registerLinkProvider=function(f){return this._checkProposedApi(),this._core.registerLinkProvider(f)},u.prototype.registerCharacterJoiner=function(f){return this._checkProposedApi(),this._core.registerCharacterJoiner(f)},u.prototype.deregisterCharacterJoiner=function(f){this._checkProposedApi(),this._core.deregisterCharacterJoiner(f)},u.prototype.registerMarker=function(f){return this._checkProposedApi(),this._verifyIntegers(f),this._core.addMarker(f)},u.prototype.addMarker=function(f){return this.registerMarker(f)},u.prototype.hasSelection=function(){return this._core.hasSelection()},u.prototype.select=function(f,p,a){this._verifyIntegers(f,p,a),this._core.select(f,p,a)},u.prototype.getSelection=function(){return this._core.getSelection()},u.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},u.prototype.clearSelection=function(){this._core.clearSelection()},u.prototype.selectAll=function(){this._core.selectAll()},u.prototype.selectLines=function(f,p){this._verifyIntegers(f,p),this._core.selectLines(f,p)},u.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},u.prototype.scrollLines=function(f){this._verifyIntegers(f),this._core.scrollLines(f)},u.prototype.scrollPages=function(f){this._verifyIntegers(f),this._core.scrollPages(f)},u.prototype.scrollToTop=function(){this._core.scrollToTop()},u.prototype.scrollToBottom=function(){this._core.scrollToBottom()},u.prototype.scrollToLine=function(f){this._verifyIntegers(f),this._core.scrollToLine(f)},u.prototype.clear=function(){this._core.clear()},u.prototype.write=function(f,p){this._core.write(f,p)},u.prototype.writeUtf8=function(f,p){this._core.write(f,p)},u.prototype.writeln=function(f,p){this._core.write(f),this._core.write(`\r
`,p)},u.prototype.paste=function(f){this._core.paste(f)},u.prototype.getOption=function(f){return this._core.optionsService.getOption(f)},u.prototype.setOption=function(f,p){this._checkReadonlyOptions(f),this._core.optionsService.setOption(f,p)},u.prototype.refresh=function(f,p){this._verifyIntegers(f,p),this._core.refresh(f,p)},u.prototype.reset=function(){this._core.reset()},u.prototype.clearTextureAtlas=function(){this._core.clearTextureAtlas()},u.prototype.loadAddon=function(f){return this._addonManager.loadAddon(this,f)},Object.defineProperty(u,"strings",{get:function(){return k},enumerable:!1,configurable:!0}),u.prototype._verifyIntegers=function(){for(var f=[],p=0;p<arguments.length;p++)f[p]=arguments[p];for(var a=0,s=f;a<s.length;a++){var o=s[a];if(o===1/0||isNaN(o)||o%1!=0)throw new Error("This API only accepts integers")}},u}();$.Terminal=S})(),ve})()})});var Qa=ki((Ja,$a)=>{(function(oe){typeof Ja=="object"&&typeof $a=="object"?oe(Ai()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],oe):oe(CodeMirror)})(function(oe){oe.defineOption("placeholder","",function(v,y,w){var m=w&&w!=oe.Init;if(y&&!m)v.on("blur",$),v.on("change",h),v.on("swapDoc",h),oe.on(v.getInputField(),"compositionupdate",v.state.placeholderCompose=function(){ve(v)}),h(v);else if(!y&&m){v.off("blur",$),v.off("change",h),v.off("swapDoc",h),oe.off(v.getInputField(),"compositionupdate",v.state.placeholderCompose),V(v);var b=v.getWrapperElement();b.className=b.className.replace(" CodeMirror-empty","")}y&&!v.hasFocus()&&$(v)});function V(v){v.state.placeholder&&(v.state.placeholder.parentNode.removeChild(v.state.placeholder),v.state.placeholder=null)}function Q(v){V(v);var y=v.state.placeholder=document.createElement("pre");y.style.cssText="height: 0; overflow: visible",y.style.direction=v.getOption("direction"),y.className="CodeMirror-placeholder CodeMirror-line-like";var w=v.getOption("placeholder");typeof w=="string"&&(w=document.createTextNode(w)),y.appendChild(w),v.display.lineSpace.insertBefore(y,v.display.lineSpace.firstChild)}function ve(v){setTimeout(function(){var y=!1;if(v.lineCount()==1){var w=v.getInputField();y=w.nodeName=="TEXTAREA"?!v.getLine(0).length:!/[^\u200b]/.test(w.querySelector(".CodeMirror-line").textContent)}y?Q(v):V(v)},20)}function $(v){k(v)&&Q(v)}function h(v){var y=v.getWrapperElement(),w=k(v);y.className=y.className.replace(" CodeMirror-empty","")+(w?" CodeMirror-empty":""),w?Q(v):V(v)}function k(v){return v.lineCount()===1&&v.getLine(0)===""}})});var rl=ki((el,tl)=>{(function(oe){typeof el=="object"&&typeof tl=="object"?oe(Ai()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],oe):oe(CodeMirror)})(function(oe){var V={pairs:`()[]{}''""`,closeBefore:`)]}'":;>`,triples:"",explode:"[]{}"},Q=oe.Pos;oe.defineOption("autoCloseBrackets",!1,function(p,a,s){s&&s!=oe.Init&&(p.removeKeyMap($),p.state.closeBrackets=null),a&&(h(ve(a,"pairs")),p.state.closeBrackets=a,p.addKeyMap($))});function ve(p,a){return a=="pairs"&&typeof p=="string"?p:typeof p=="object"&&p[a]!=null?p[a]:V[a]}var $={Backspace:y,Enter:w};function h(p){for(var a=0;a<p.length;a++){var s=p.charAt(a),o="'"+s+"'";$[o]||($[o]=k(s))}}h(V.pairs+"`");function k(p){return function(a){return S(a,p)}}function v(p){var a=p.state.closeBrackets;if(!a||a.override)return a;var s=p.getModeAt(p.getCursor());return s.closeBrackets||a}function y(p){var a=v(p);if(!a||p.getOption("disableInput"))return oe.Pass;for(var s=ve(a,"pairs"),o=p.listSelections(),c=0;c<o.length;c++){if(!o[c].empty())return oe.Pass;var d=u(p,o[c].head);if(!d||s.indexOf(d)%2!=0)return oe.Pass}for(var c=o.length-1;c>=0;c--){var g=o[c].head;p.replaceRange("",Q(g.line,g.ch-1),Q(g.line,g.ch+1),"+delete")}}function w(p){var a=v(p),s=a&&ve(a,"explode");if(!s||p.getOption("disableInput"))return oe.Pass;for(var o=p.listSelections(),c=0;c<o.length;c++){if(!o[c].empty())return oe.Pass;var d=u(p,o[c].head);if(!d||s.indexOf(d)%2!=0)return oe.Pass}p.operation(function(){var g=p.lineSeparator()||`
`;p.replaceSelection(g+g,null),m(p,-1),o=p.listSelections();for(var x=0;x<o.length;x++){var T=o[x].head.line;p.indentLine(T,null,!0),p.indentLine(T+1,null,!0)}})}function m(p,a){for(var s=[],o=p.listSelections(),c=0,d=0;d<o.length;d++){var g=o[d];g.head==p.getCursor()&&(c=d);var x=g.head.ch||a>0?{line:g.head.line,ch:g.head.ch+a}:{line:g.head.line-1};s.push({anchor:x,head:x})}p.setSelections(s,c)}function b(p){var a=oe.cmpPos(p.anchor,p.head)>0;return{anchor:new Q(p.anchor.line,p.anchor.ch+(a?-1:1)),head:new Q(p.head.line,p.head.ch+(a?1:-1))}}function S(p,a){var s=v(p);if(!s||p.getOption("disableInput"))return oe.Pass;var o=ve(s,"pairs"),c=o.indexOf(a);if(c==-1)return oe.Pass;for(var d=ve(s,"closeBefore"),g=ve(s,"triples"),x=o.charAt(c+1)==a,T=p.listSelections(),H=c%2==0,P,M=0;M<T.length;M++){var L=T[M],D=L.head,E,Y=p.getRange(D,Q(D.line,D.ch+1));if(H&&!L.empty())E="surround";else if((x||!H)&&Y==a)x&&f(p,D)?E="both":g.indexOf(a)>=0&&p.getRange(D,Q(D.line,D.ch+3))==a+a+a?E="skipThree":E="skip";else if(x&&D.ch>1&&g.indexOf(a)>=0&&p.getRange(Q(D.line,D.ch-2),D)==a+a){if(D.ch>2&&/\bstring/.test(p.getTokenTypeAt(Q(D.line,D.ch-2))))return oe.Pass;E="addFour"}else if(x){var j=D.ch==0?" ":p.getRange(Q(D.line,D.ch-1),D);if(!oe.isWordChar(Y)&&j!=a&&!oe.isWordChar(j))E="both";else return oe.Pass}else if(H&&(Y.length===0||/\s/.test(Y)||d.indexOf(Y)>-1))E="both";else return oe.Pass;if(!P)P=E;else if(P!=E)return oe.Pass}var I=c%2?o.charAt(c-1):a,F=c%2?a:o.charAt(c+1);p.operation(function(){if(P=="skip")m(p,1);else if(P=="skipThree")m(p,3);else if(P=="surround"){for(var K=p.getSelections(),Z=0;Z<K.length;Z++)K[Z]=I+K[Z]+F;p.replaceSelections(K,"around"),K=p.listSelections().slice();for(var Z=0;Z<K.length;Z++)K[Z]=b(K[Z]);p.setSelections(K)}else P=="both"?(p.replaceSelection(I+F,null),p.triggerElectric(I+F),m(p,-1)):P=="addFour"&&(p.replaceSelection(I+I+I+I,"before"),m(p,1))})}function u(p,a){var s=p.getRange(Q(a.line,a.ch-1),Q(a.line,a.ch+1));return s.length==2?s:null}function f(p,a){var s=p.getTokenAt(Q(a.line,a.ch+1));return/\bstring/.test(s.type)&&s.start==a.ch&&(a.ch==0||!/\bstring/.test(p.getTokenTypeAt(a)))}})});var ol=ki((il,nl)=>{(function(oe){typeof il=="object"&&typeof nl=="object"?oe(Ai()):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],oe):oe(CodeMirror)})(function(oe){var V=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8),Q=oe.Pos,ve={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function $(m){return m&&m.bracketRegex||/[(){}[\]]/}function h(m,b,S){var u=m.getLineHandle(b.line),f=b.ch-1,p=S&&S.afterCursor;p==null&&(p=/(^| )cm-fat-cursor($| )/.test(m.getWrapperElement().className));var a=$(S),s=!p&&f>=0&&a.test(u.text.charAt(f))&&ve[u.text.charAt(f)]||a.test(u.text.charAt(f+1))&&ve[u.text.charAt(++f)];if(!s)return null;var o=s.charAt(1)==">"?1:-1;if(S&&S.strict&&o>0!=(f==b.ch))return null;var c=m.getTokenTypeAt(Q(b.line,f+1)),d=k(m,Q(b.line,f+(o>0?1:0)),o,c,S);return d==null?null:{from:Q(b.line,f),to:d&&d.pos,match:d&&d.ch==s.charAt(0),forward:o>0}}function k(m,b,S,u,f){for(var p=f&&f.maxScanLineLength||1e4,a=f&&f.maxScanLines||1e3,s=[],o=$(f),c=S>0?Math.min(b.line+a,m.lastLine()+1):Math.max(m.firstLine()-1,b.line-a),d=b.line;d!=c;d+=S){var g=m.getLine(d);if(!!g){var x=S>0?0:g.length-1,T=S>0?g.length:-1;if(!(g.length>p))for(d==b.line&&(x=b.ch-(S<0?1:0));x!=T;x+=S){var H=g.charAt(x);if(o.test(H)&&(u===void 0||(m.getTokenTypeAt(Q(d,x+1))||"")==(u||""))){var P=ve[H];if(P&&P.charAt(1)==">"==S>0)s.push(H);else if(s.length)s.pop();else return{pos:Q(d,x),ch:H}}}}}return d-S==(S>0?m.lastLine():m.firstLine())?!1:null}function v(m,b,S){for(var u=m.state.matchBrackets.maxHighlightLineLength||1e3,f=S&&S.highlightNonMatching,p=[],a=m.listSelections(),s=0;s<a.length;s++){var o=a[s].empty()&&h(m,a[s].head,S);if(o&&(o.match||f!==!1)&&m.getLine(o.from.line).length<=u){var c=o.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";p.push(m.markText(o.from,Q(o.from.line,o.from.ch+1),{className:c})),o.to&&m.getLine(o.to.line).length<=u&&p.push(m.markText(o.to,Q(o.to.line,o.to.ch+1),{className:c}))}}if(p.length){V&&m.state.focused&&m.focus();var d=function(){m.operation(function(){for(var g=0;g<p.length;g++)p[g].clear()})};if(b)setTimeout(d,800);else return d}}function y(m){m.operation(function(){m.state.matchBrackets.currentlyHighlighted&&(m.state.matchBrackets.currentlyHighlighted(),m.state.matchBrackets.currentlyHighlighted=null),m.state.matchBrackets.currentlyHighlighted=v(m,!1,m.state.matchBrackets)})}function w(m){m.state.matchBrackets&&m.state.matchBrackets.currentlyHighlighted&&(m.state.matchBrackets.currentlyHighlighted(),m.state.matchBrackets.currentlyHighlighted=null)}oe.defineOption("matchBrackets",!1,function(m,b,S){S&&S!=oe.Init&&(m.off("cursorActivity",y),m.off("focus",y),m.off("blur",w),w(m)),b&&(m.state.matchBrackets=typeof b=="object"?b:{},m.on("cursorActivity",y),m.on("focus",y),m.on("blur",w))}),oe.defineExtension("matchBrackets",function(){v(this,!0)}),oe.defineExtension("findMatchingBracket",function(m,b,S){return(S||typeof b=="boolean")&&(S?(S.strict=b,b=S):b=b?{strict:!0}:null),h(this,m,b)}),oe.defineExtension("scanForBracket",function(m,b,S,u){return k(this,m,b,S,u)})})});var Ba=class{name(){return"base64"}matches(V){try{return atob(V),!0}catch{return!1}}decode(V){return Array.from(atob(V)).map(Q=>Q.charCodeAt(0))}},Pa=Ba;var Ha=class{name(){return"default"}matches(){return!0}decode(V){return Array.from(V).map(Q=>Q.charCodeAt(0))}},Ia=Ha;var An=class{constructor(V,Q,ve,$=null,h=null,k=V){this.id=V;this.name=Q;this.runner=ve;this.url=$;this.args=h;this.highlighterRef=k}getId(){return this.id}getName(){return this.name}getURL(){return this.url}getArgs(){return this.args}getHighlighterRef(){return this.highlighterRef}run(V,Q,ve){return this.runner(V,ve,Q)}};var cu=Ei(Na()),ja=class extends An{constructor(){super("javascript-browser","JavaScript (Browser)",(V,Q,ve)=>{let $=new Worker("dist/js/langs/javascript-browser/worker.js");return $.postMessage({type:"run",code:V,args:ve,input:Q}),$},"https://www.ecma-international.org/publications-and-standards/standards/ecma-262/",null,"javascript")}},Ua=ja;var hu=Ei(Ka()),Ga=class extends An{constructor(){super("webperl-5.28.1","Perl 5.28.1 (webperl)",(V,Q,ve)=>{let $=new Worker("dist/js/langs/webperl-5.28.1/worker.js");return $.postMessage({type:"run",code:V,args:ve,input:Q}),$},"https://www.perl.org/",["-M5.10.0","-F","-l","-p"],"perl")}},Xa=Ga;var sl=Ei(Ai()),al=Ei(Ya());var ru=2,iu=1,Zo=class{constructor(){}activate(V){this._terminal=V}dispose(){}fit(){let V=this.proposeDimensions();if(!V||!this._terminal)return;let Q=this._terminal._core;(this._terminal.rows!==V.rows||this._terminal.cols!==V.cols)&&(Q._renderService.clear(),this._terminal.resize(V.cols,V.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let V=this._terminal._core;if(V._renderService.dimensions.actualCellWidth===0||V._renderService.dimensions.actualCellHeight===0)return;let Q=window.getComputedStyle(this._terminal.element.parentElement),ve=parseInt(Q.getPropertyValue("height")),$=Math.max(0,parseInt(Q.getPropertyValue("width"))),h=window.getComputedStyle(this._terminal.element),k={top:parseInt(h.getPropertyValue("padding-top")),bottom:parseInt(h.getPropertyValue("padding-bottom")),right:parseInt(h.getPropertyValue("padding-right")),left:parseInt(h.getPropertyValue("padding-left"))},v=k.top+k.bottom,y=k.right+k.left,w=ve-v,m=$-y-V.viewport.scrollBarWidth;return{cols:Math.max(ru,Math.floor(m/V._renderService.dimensions.actualCellWidth)),rows:Math.max(iu,Math.floor(w/V._renderService.dimensions.actualCellHeight))}}};var Za=class{constructor(){this.registered=[]}register(...V){this.registered.push(...V)}decoder(V){let[Q]=this.registered.filter(ve=>ve.matches(V));return Q}};var ai=new Za;var Rr=class{constructor(V,Q,ve,$,h,k,v,y){this.languageSelector=V;this.header=Q;this.code=ve;this.footer=$;this.stdin=h;this.stdout=k;this.stderr=v;this.args=y}writeStdout(V){this.stdout.write(V.replace(/(?<!\r)\n/g,`\r
`))}writeStderr(V){this.stderr.write(V.replace(/(?<!\r)\n/g,`\r
`))}clearStdout(){this.stdout.reset()}clearStderr(){this.stderr.reset()}static getRaw(V){return V.getValue()}static getAsArray(V){let Q=Rr.getRaw(V);return ai.decoder(Q).decode(Q)}getRawCodeHeader(){return Rr.getRaw(this.header)}getCodeHeaderAsArray(){return Rr.getAsArray(this.header)}setCodeHeader(V){this.header.setValue(V)}getRawCode(){return Rr.getRaw(this.code)}getCodeAsArray(){return Rr.getAsArray(this.code)}getCodeAsString(V="."){let Q=this.getRawCode(),ve=ai.decoder(Q);return ve.name()!=="default"&&(Q=String.fromCharCode(...ve.decode(Q))),V!==null&&(Q=Q.replace(/[\x00-\x1f\x7f-\xff]/g,V)),Q}getFullCodeAsArray(){return[...this.getCodeHeaderAsArray(),...this.getCodeAsArray(),...this.getCodeFooterAsArray()]}setCode(V){this.code.setValue(V)}onCodeChange(V){this.code.on("change",()=>V())}getRawCodeFooter(){return Rr.getRaw(this.footer)}getCodeFooterAsArray(){return Rr.getAsArray(this.footer)}setCodeFooter(V){this.footer.setValue(V)}getArgs(){return this.args.getValue()}setArgs(V){this.args.setValue(V)}argsRefresh(){this.args.refresh()}getStdin(){return this.stdin.getValue()}setStdin(V){this.stdin.setValue(V)}},Vo=Rr;var Va=class{constructor(){this.data={}}register(...V){V.forEach(Q=>{this.data[Q.getId()]=Q})}get(V){return this.data[V]}all(){return Object.keys(this.data)}run(V,Q,ve,$){return this.data[V].run(Q,ve,$)}},Or=new Va;var xu=Ei(Qa()),ku=Ei(rl()),Eu=Ei(ol());var vt=class{constructor(){this.langSelector=document.querySelector('select[name="lang"]'),this.addRegisteredLangs(),this.stdout=vt.createTerminal(),this.stderr=vt.createTerminal({theme:{foreground:"#f92672"}}),this.fit=new Zo,this.stdout.loadAddon(this.fit),this.stdout.open(document.querySelector("div.stdout")),this.stderr.open(document.querySelector("div.stderr")),this.codeHeader=vt.createEditor(document.querySelector('textarea[name="header"]'),{autoCloseBrackets:!0,autofocus:!0,matchBrackets:!0}),this.code=vt.createEditor(document.querySelector('textarea[name="code"]'),{autoCloseBrackets:!0,autofocus:!0,matchBrackets:!0}),this.codeFooter=vt.createEditor(document.querySelector('textarea[name="footer"]'),{autoCloseBrackets:!0,autofocus:!0,matchBrackets:!0}),this.stdin=vt.createEditor(document.querySelector('textarea[name="input"]')),this.args=vt.createEditor(document.querySelector('textarea[name="args"]')),this.io=new Vo(this.langSelector,this.codeHeader,this.code,this.codeFooter,this.stdin,this.stdout,this.stderr,this.args),this.expanders=document.querySelectorAll('input[name="expand"]'),this.argsWrapper=document.querySelector(".args-wrapper"),this.addArg=document.querySelector(".add-arg"),this.runButton=document.querySelector('input[name="run"]'),this.stopButton=document.querySelector('input[name="stop"]'),this.bytesCount=document.querySelector(".bytes .byte-count"),this.bytesPlural=document.querySelector(".bytes .plural"),this.encoded=document.querySelector(".encoded"),this.format=document.querySelector(".format"),this.copyLinkButton=document.querySelector('input[name="copy"]'),this.markdownButton=document.querySelector('input[name="markdown"]'),this.connectExpanders(),this.parseHashData(window.location.hash),this.populateArgs(),this.codeOnChange(),this.io.getCodeAsArray().length&&this.runCode(),this.resize(),this.io.onCodeChange(()=>this.codeOnChange()),this.runButton.addEventListener("click",()=>this.runCode()),this.langSelector.addEventListener("change",()=>this.populateArgs()),this.copyLinkButton.addEventListener("click",()=>{let V=this.buildLink();window.history.pushState(this.buildHashData(),document.title,V),navigator.clipboard.writeText(V),vt.copied(this.copyLinkButton)}),this.markdownButton.addEventListener("click",()=>{navigator.clipboard.writeText(this.buildMarkdown()),vt.copied(this.markdownButton)}),window.addEventListener("hashchange",()=>{this.parseHashData(window.location.hash),this.io.getCodeAsArray().length&&this.runCode()}),window.addEventListener("resize",()=>this.resize())}addRegisteredLangs(){Or.all().forEach(V=>{let Q=Or.get(V),ve=document.createElement("option");ve.setAttribute("value",Q.getId()),ve.append(document.createTextNode(Q.getName())),this.langSelector.append(ve)})}setLang(V){if(!Or.all().includes(V))throw new TypeError(`Unknown lang: ${V}.`);this.langSelector.value=V,this.setCodeHighlight()}getLangId(){return this.langSelector.value}setCodeHighlight(){let V=Or.get(this.getLangId());[this.codeHeader,this.code,this.codeFooter].forEach(Q=>{if(ai.decoder(Vo.getRaw(Q)).name()!=="default"){Q.getOption("mode")!==null&&Q.setOption("mode",null);return}Q.getOption("mode")!==V.getHighlighterRef()&&Q.setOption("mode",V.getHighlighterRef())})}static createTerminal(V={}){return new al.Terminal({...V,theme:{background:"#272822",cursor:"transparent",foreground:"#f8f8f2",...V.theme??{}}})}static createEditor(V,Q={}){return(0,sl.fromTextArea)(V,{mode:null,theme:"monokai",viewportMargin:1/0,extraKeys:{"Shift-Tab":!1,Tab:!1},...Q})}resize(){this.fit.fit(),this.stderr.resize(this.stdout.cols,6)}codeOnChange(){let V=this.io.getCodeAsArray();this.encoded.setAttribute("hidden",""),this.setCodeHighlight();let Q=ai.decoder(this.io.getRawCode());Q.name()!=="default"&&(this.encoded.removeAttribute("hidden"),this.format.innerText=Q.name()),this.showBytes(V.length)}runCode(){let V=Date.now(),Q=()=>{ve.terminate(),this.io.writeStderr(`Aborted execution after ${Date.now()-V}ms`),this.runButton.removeAttribute("disabled"),this.stopButton.setAttribute("disabled",""),this.stopButton.removeEventListener("click",Q)};this.io.clearStdout(),this.io.clearStderr(),this.runButton.setAttribute("disabled",""),this.stopButton.removeAttribute("disabled");let ve=Or.run(this.getLangId(),this.io.getFullCodeAsArray(),this.io.getArgs(),this.io.getStdin());this.stopButton.addEventListener("click",Q),ve.onmessage=({data:$})=>{let{type:h,output:k,error:v}=$;k&&this.io.writeStdout(k),v&&this.io.writeStderr(v??""),h==="done"&&(this.io.writeStderr(`Completed execution after ${Date.now()-V}ms`),this.runButton.removeAttribute("disabled"),this.stopButton.setAttribute("disabled",""),this.stopButton.removeEventListener("click",Q),ve.terminate())},ve.onerror=$=>{console.error($),this.runButton.removeAttribute("disabled"),this.stopButton.setAttribute("disabled","")}}populateArgs(){for(;this.addArg.firstElementChild;)this.addArg.firstElementChild.remove();let V=Or.get(this.getLangId());if(!V)throw new TypeError("Unregistered lang: "+this.getLangId());let Q=V.getArgs();Q!==null?(this.argsWrapper.removeAttribute("hidden"),Q.forEach(ve=>{let $=document.createElement("input");$.setAttribute("type","button"),$.setAttribute("value",ve),$.addEventListener("click",()=>{let h=this.io.getArgs()??"";new RegExp("(\\n|^)"+ve+"(\\n|$)").test(h)||this.io.setArgs((h+`
`+ve).trim())}),this.addArg.append($)})):this.argsWrapper.setAttribute("hidden",""),this.io.argsRefresh()}static expand(V){let Q=V.nextElementSibling,ve=document.querySelector(V.dataset.target);if(!ve){console.debug("No collapser or target for expander: ",V);return}V.setAttribute("hidden",""),ve.removeAttribute("hidden"),Q.removeAttribute("hidden")}static collapse(V){let Q=V.nextElementSibling,ve=document.querySelector(V.dataset.target);if(!ve){console.debug("No collapser or target for expander: ",V);return}V.removeAttribute("hidden"),ve.setAttribute("hidden",""),Q.setAttribute("hidden","")}connectExpanders(){this.expanders.forEach(V=>{let Q=V.nextElementSibling;if(!Q||!Q.matches('input[name="collapse"]')){console.debug("No collapser or target for expander: ",V);return}V.addEventListener("click",()=>vt.expand(V)),Q.addEventListener("click",()=>vt.collapse(V))})}static copied(V){let Q=V.value;V.setAttribute("disabled",""),V.style.width=V.offsetWidth+"px",V.value="Copied!",window.setTimeout(()=>{V.removeAttribute("disabled"),V.style.width=null,V.value=Q},1e3)}parseHashData(V){if(!V||V.length<2)return;let Q;try{let h=atob(V.slice(1));Q=JSON.parse(h)}catch(h){if(h instanceof DOMException){console.error("Bad base64 data: ",h);return}if(h instanceof SyntaxError){console.error("Bad JSON data: ",h);return}throw h}let[ve]=Array.from(this.expanders).filter(h=>h.parentElement.matches(".code-header")),[$]=Array.from(this.expanders).filter(h=>h.parentElement.matches(".code-footer"));Q.header?vt.expand(ve):vt.collapse(ve),Q.footer?vt.expand($):vt.collapse($),this.setLang(Q.lang??this.getLangId()),this.io.setCodeHeader(Q.header??""),this.io.setCode(Q.code??""),this.io.setCodeFooter(Q.footer??""),this.io.setArgs(Q.args??""),this.io.setStdin(Q.input??"")}buildHashData(){let V={},Q=this.getLangId(),ve=this.io.getRawCodeHeader(),$=this.io.getRawCode(),h=this.io.getRawCodeFooter(),k=this.io.getArgs(),v=this.io.getStdin();return Object.entries({lang:Q,header:ve,code:$,footer:h,args:k,input:v}).forEach(([y,w])=>{w&&(V[y]=w)}),btoa(JSON.stringify(V))}buildLink(){let V=this.buildHashData();return window.location.protocol+"//"+window.location.host+window.location.pathname+"#"+V}buildMarkdown(){let V=this.io.getArgs().trim().split(/\n/).join(" "),Q=Or.get(this.getLangId()),ve=Math.random().toString(36).slice(2,10),$=this.io.getCodeAsArray().length;return`# [${Q.getName()}]${V?` + \`${V}\``:""}, ${$} byte${$===1?"":"s"}

<!-- language-all: lang-${Q.getHighlighterRef()} -->

<pre><code>${this.io.getCodeAsString().replace(/[&<>]/g,h=>h==="<"?"&lt;":h===">"?"&gt;":h==="&"?"&amp;":h)}</code></pre>

[Try it online!][TIO-${ve}]

[${Q.getName()}]: ${Q.getURL()}
[TIO-${ve}]: ${this.buildLink()}`}showBytes(V){if(this.bytesCount.innerText=V.toString(),V===1){this.bytesPlural.setAttribute("hidden","");return}this.bytesPlural.removeAttribute("hidden")}},ll=vt;var cl=class{name(){return"xxd"}matches(V){return/^(\d{7,8}: (((.{2}){1,2} ){1,8}) .+(\n|$))+$/.test(V)}decode(V){return V.trim().replace(/(?<=^|\n)\d{7,8}: (((.{2}){1,2} ){1,8}).+/g,"$1").replace(/\s+/g,"").match(/../g).map(Q=>parseInt(Q,16))}},ul=cl;ai.register(new ul,new Pa,new Ia);Or.register(new Ua,new Xa);var Wu=new ll;})();
/**
 * Copyright (c) 2017 The xterm.js authors. All rights reserved.
 * @license MIT
 */
//# sourceMappingURL=app.js.map
